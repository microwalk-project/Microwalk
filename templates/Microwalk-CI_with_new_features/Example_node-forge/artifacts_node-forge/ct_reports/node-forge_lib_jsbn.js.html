<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>CQR visualizer</title>
    <meta name="viewport" content="width=device-width,initial-scale=1">
	<meta http-equiv="content-security-policy" content="script-src 'unsafe-inline'">
	<style>
		html, body, div, span, applet, object, iframe,
		h1, h2, h3, h4, h5, h6, p, blockquote, pre,
		a, abbr, acronym, address, big, cite, code,
		del, dfn, em, img, ins, kbd, q, s, samp,
		small, strike, strong, sub, sup, tt, var,
		b, u, i, center,
		dl, dt, dd, ol, ul, li,
		fieldset, form, label, legend,
		table, caption, tbody, tfoot, thead, tr, th, td,
		article, aside, canvas, details, embed,
		figure, figcaption, footer, header, hgroup,
		menu, nav, output, ruby, section, summary,
		time, mark, audio, video {
			margin: 0;
			padding: 0;
			border: 0;
			font-size: 100%;
			font: inherit;
			vertical-align: baseline;
		}
		/* HTML5 display-role reset for older browsers */
		article, aside, details, figcaption, figure,
		footer, header, hgroup, menu, nav, section {
			display: block;
		}
		header {
            position : static;
        }
		body {
			line-height: 1;
		}
		ol, ul {
			list-style: none;
		}
		blockquote, q {
			quotes: none;
		}
		blockquote:before, blockquote:after,
		q:before, q:after {
			content: '';
			content: none;
		}
		table {
			border-collapse: collapse;
			border-spacing: 0;
		}

		:root {
			--accent-color: #DC8ADD78;
            --height: 12px;
		}
		body {
			font-family: monospace;
		}
		header {
    		background-color: var(--accent-color);
    		color: black;
    		margin-bottom: 1em;
    		padding: 1em 3em;
    		font-size: 20px;
    	}
    	code {
    		white-space: break-spaces;
    	}

        .header-text {
            font-size: 0.6em;
        }

    	.line-number {
    		text-align: right;
    		display: inline-block;
    		min-width: 4em;
    		margin-right: 8px;
    		border-right: 4px solid var(--accent-color);
    		padding-right: 8px;
    	}
    	.line-number, code {
    		padding-top: 2px;
    		padding-bottom: 2px;
    	}
    	.issue-line .line-number {
    		background-color: #ff00008f;
    	}
    	.issue-inline-message {
    		background-color: #e8e3e8;
			margin: 5px 0;
    		padding: 1em 5em;
    		border-top: 1px solid #4E464E;
    		border-bottom: 1px solid #4E464E;
    	}
    	.issue-inline-message > details {
    		font-weight: bold;
    		margin-bottom: 1em;
    	}
    	.issue-inline-message.issue-critical > summary {
    		color: #C81E1E;
    	}
    	.issue-inline-message.issue-major > summary {
    		color: #AD5100;
    	}
    	.issue-inline-message.issue-minor > summary {
    		color: #615900;
    	}
    	p {
    		font-size: 0.em;
    		margin-top: 0.5em;
    	}
    	h1 {
    	    font-size: 2em;
            margin-bottom: 0.2em;

    	}
    	.In-the-target {
    	    font-size: 0.7em;
    	}
    	details {
            border-radius: 4px;
            padding: 0.5em 0.5em 0;
        }
        summary {
            font-weight: bold;
            margin: -0.5em -0.5em 0;
            padding: 0.5em;
        }
        details.header-issue-counter[open] {
            padding: 0.5em;
        }
        details.issue-inline-message[open] {
            background-color: #c5299e24;
            padding: 1em 5em;
            /*margin-bottom: 1em;*/
        }
        details.header-issue-counter[open] summary {
            border-bottom: 1px solid black;
            margin-bottom: 0.5em;
        }
        details.issue-inline-message[open] summary {
            /*background-color: #c5299e24;*/
    		margin-bottom: 1em;
        }
        i {
            color: black;
        }
        input[type="checkbox"] {
			accent-color: black;
		}
		button {
		    border: 0;
            line-height: 2.5;
            padding: 0 20px;
            font-size: 1rem;
            text-align: center;
            color: #fff;
            text-shadow: 1px 1px 1px #000;
            border-radius: 10px;
            background-color: rgba(220, 0, 0, 1);
            background-image: linear-gradient(to top left, rgba(0, 0, 0, 0.2), rgba(0, 0, 0, 0.2) 30%, rgba(0, 0, 0, 0));
            box-shadow: inset 2px 2px 3px rgba(255, 255, 255, 0.6), inset -2px -2px 3px rgba(0, 0, 0, 0.6);
		}
		.deploy-button:hover {
            background-color: rgba(255, 0, 0, 1);
        }

        .deploy-button:active {
            box-shadow: inset -2px -2px 3px rgba(255, 255, 255, 0.6), inset 2px 2px 3px rgba(0, 0, 0, 0.6);
        }

        .cstat-no {
          background: #F6C6CE;
        }
        .line-number2 {
    		text-align: right;
    		display: inline-block;
    		min-width: 4em;
    		padding-right: 8px;
            border-right: 4px solid var(--accent-color);
    	}
    	.line-number2, code {
    		padding-top: 2px;
    		padding-bottom: 2px;
    	}
    	.source-line {
        }
        .line-counter {
    		text-align: center;
    		display: inline-block;

            height: var(--height);
    		min-width: 4em;
    		margin-right: 8px;
    		border-right: 4px
    		padding-right: 8px;
    	}

        .cline-yes {
          background: rgb(230,245,208);
          padding-top: 2px;
          padding-bottom: 2px;
        }

        .cline-no {
          background: #FCE1E5;
          padding-top: 2px;
          padding-bottom: 2px;
        }

        .header-option{
          line-height: 1;
        }

        .filter-inputs {
            display: flex;
            align-items: center;
            margin-bottom: 0.5em;
        }
        
        .button-container {
            flex: 0 0 auto;
            margin-right: 20px; 
            display: flex;
            align-items: center;
        }
        
        .options-container {
            display: flex;
            flex-direction: column;
        }
        
        .severity-options, .issue-type-options {
            margin-top: 1px;
        }

    </style>
  </head>
  <body>
  <div class="grid-container">
    <div class="head">
    <header>
<h1>node-forge/lib/jsbn.js</h1>
        <div class="filter-inputs">
            <div class="button-container">
                <button onclick="change()" title="Click here to expand or collapse all leak details!" class="deploy-button" Id="button1"> Deploy leak details </button>
            </div>
            <div class="options-container">
                <div class="severity-options">
                    <span class="header-option">Severity:</span>
                    <label><input type="checkbox" name="severity-critical" > Critical</label>
                    <label><input type="checkbox" name="severity-major" > Major</label>
                    <label><input type="checkbox" name="severity-minor" > Minor</label>
                </div>
                <div class="issue-type-options">
                    <span>Issue type:</span>
                    <label><input type="checkbox" name="issue-type-memory-access" > Memory access</label>
                    <label><input type="checkbox" name="issue-type-branch" > Branch</label>
                </div>
            </div>
        </div>
        <p class="header-text">Total number of problem found: 84 out of 180</p>
        <p class="header-text">Number of critical in file: 79   ≅ 94%</p>
        <p class="header-text">Number of memory access error in file: 56   ≅ 67%</p>
        <p class="header-text">Coverage proportion (on the number of character): 11904 / 33924   ≅ 35%</p>
        <p class="header-text">Coverage proportion (on the number of line): 463 / 1264   ≅ 37%</p><details open class="header-issue-counter"><summary class="In-the-target"><name="target-RSASIGN" Id="RSASIGN" <h2>In the target-RSASIGN</h2></summary>
            <p class="header-text">Number of problem found: 84</p>
            <p class="header-text">Number of critical: 79   ≅ 94%</p>
            <p class="header-text">Number of memory access error: 56   ≅ 67%</p></details>
    </header>
    </div><div class="source-line"><span class="line-number ">1</span><span class="line-counter cline-yes">&nbsp</span><code>// Copyright (c) 2005  Tom Wu</code></div>
<div class="source-line"><span class="line-number ">2</span><span class="line-counter cline-yes">&nbsp</span><code>// All Rights Reserved.</code></div>
<div class="source-line"><span class="line-number ">3</span><span class="line-counter cline-yes">&nbsp</span><code>// See &quot;LICENSE&quot; for details.</code></div>
<div class="source-line"><span class="line-number ">4</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<div class="source-line"><span class="line-number ">5</span><span class="line-counter cline-yes">&nbsp</span><code>// Basic JavaScript BN library - subset useful for RSA encryption.</code></div>
<div class="source-line"><span class="line-number ">6</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<div class="source-line"><span class="line-number ">7</span><span class="line-counter cline-yes">&nbsp</span><code>/*</code></div>
<div class="source-line"><span class="line-number ">8</span><span class="line-counter cline-yes">&nbsp</span><code>Licensing (LICENSE)</code></div>
<div class="source-line"><span class="line-number ">9</span><span class="line-counter cline-yes">&nbsp</span><code>-------------------</code></div>
<div class="source-line"><span class="line-number ">10</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<div class="source-line"><span class="line-number ">11</span><span class="line-counter cline-yes">&nbsp</span><code>This software is covered under the following copyright:</code></div>
<div class="source-line"><span class="line-number ">12</span><span class="line-counter cline-yes">&nbsp</span><code>*/</code></div>
<div class="source-line"><span class="line-number ">13</span><span class="line-counter cline-yes">&nbsp</span><code>/*</code></div>
<div class="source-line"><span class="line-number ">14</span><span class="line-counter cline-yes">&nbsp</span><code> * Copyright (c) 2003-2005  Tom Wu</code></div>
<div class="source-line"><span class="line-number ">15</span><span class="line-counter cline-yes">&nbsp</span><code> * All Rights Reserved.</code></div>
<div class="source-line"><span class="line-number ">16</span><span class="line-counter cline-yes">&nbsp</span><code> *</code></div>
<div class="source-line"><span class="line-number ">17</span><span class="line-counter cline-yes">&nbsp</span><code> * Permission is hereby granted, free of charge, to any person obtaining</code></div>
<div class="source-line"><span class="line-number ">18</span><span class="line-counter cline-yes">&nbsp</span><code> * a copy of this software and associated documentation files (the</code></div>
<div class="source-line"><span class="line-number ">19</span><span class="line-counter cline-yes">&nbsp</span><code> * &quot;Software&quot;), to deal in the Software without restriction, including</code></div>
<div class="source-line"><span class="line-number ">20</span><span class="line-counter cline-yes">&nbsp</span><code> * without limitation the rights to use, copy, modify, merge, publish,</code></div>
<div class="source-line"><span class="line-number ">21</span><span class="line-counter cline-yes">&nbsp</span><code> * distribute, sublicense, and/or sell copies of the Software, and to</code></div>
<div class="source-line"><span class="line-number ">22</span><span class="line-counter cline-yes">&nbsp</span><code> * permit persons to whom the Software is furnished to do so, subject to</code></div>
<div class="source-line"><span class="line-number ">23</span><span class="line-counter cline-yes">&nbsp</span><code> * the following conditions:</code></div>
<div class="source-line"><span class="line-number ">24</span><span class="line-counter cline-yes">&nbsp</span><code> *</code></div>
<div class="source-line"><span class="line-number ">25</span><span class="line-counter cline-yes">&nbsp</span><code> * The above copyright notice and this permission notice shall be</code></div>
<div class="source-line"><span class="line-number ">26</span><span class="line-counter cline-yes">&nbsp</span><code> * included in all copies or substantial portions of the Software.</code></div>
<div class="source-line"><span class="line-number ">27</span><span class="line-counter cline-yes">&nbsp</span><code> *</code></div>
<div class="source-line"><span class="line-number ">28</span><span class="line-counter cline-yes">&nbsp</span><code> * THE SOFTWARE IS PROVIDED &quot;AS-IS&quot; AND WITHOUT WARRANTY OF ANY KIND,</code></div>
<div class="source-line"><span class="line-number ">29</span><span class="line-counter cline-yes">&nbsp</span><code> * EXPRESS, IMPLIED OR OTHERWISE, INCLUDING WITHOUT LIMITATION, ANY</code></div>
<div class="source-line"><span class="line-number ">30</span><span class="line-counter cline-yes">&nbsp</span><code> * WARRANTY OF MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE.</code></div>
<div class="source-line"><span class="line-number ">31</span><span class="line-counter cline-yes">&nbsp</span><code> *</code></div>
<div class="source-line"><span class="line-number ">32</span><span class="line-counter cline-yes">&nbsp</span><code> * IN NO EVENT SHALL TOM WU BE LIABLE FOR ANY SPECIAL, INCIDENTAL,</code></div>
<div class="source-line"><span class="line-number ">33</span><span class="line-counter cline-yes">&nbsp</span><code> * INDIRECT OR CONSEQUENTIAL DAMAGES OF ANY KIND, OR ANY DAMAGES WHATSOEVER</code></div>
<div class="source-line"><span class="line-number ">34</span><span class="line-counter cline-yes">&nbsp</span><code> * RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER OR NOT ADVISED OF</code></div>
<div class="source-line"><span class="line-number ">35</span><span class="line-counter cline-yes">&nbsp</span><code> * THE POSSIBILITY OF DAMAGE, AND ON ANY THEORY OF LIABILITY, ARISING OUT</code></div>
<div class="source-line"><span class="line-number ">36</span><span class="line-counter cline-yes">&nbsp</span><code> * OF OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.</code></div>
<div class="source-line"><span class="line-number ">37</span><span class="line-counter cline-yes">&nbsp</span><code> *</code></div>
<div class="source-line"><span class="line-number ">38</span><span class="line-counter cline-yes">&nbsp</span><code> * In addition, the following condition applies:</code></div>
<div class="source-line"><span class="line-number ">39</span><span class="line-counter cline-yes">&nbsp</span><code> *</code></div>
<div class="source-line"><span class="line-number ">40</span><span class="line-counter cline-yes">&nbsp</span><code> * All redistributions must retain an intact copy of this copyright notice</code></div>
<div class="source-line"><span class="line-number ">41</span><span class="line-counter cline-yes">&nbsp</span><code> * and disclaimer.</code></div>
<div class="source-line"><span class="line-number ">42</span><span class="line-counter cline-yes">&nbsp</span><code> */</code></div>
<div class="source-line"><span class="line-number ">43</span><span class="line-counter cline-yes">&nbsp</span><code>/*</code></div>
<div class="source-line"><span class="line-number ">44</span><span class="line-counter cline-yes">&nbsp</span><code>Address all questions regarding this license to:</code></div>
<div class="source-line"><span class="line-number ">45</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<div class="source-line"><span class="line-number ">46</span><span class="line-counter cline-yes">&nbsp</span><code>  Tom Wu</code></div>
<div class="source-line"><span class="line-number ">47</span><span class="line-counter cline-yes">&nbsp</span><code>  tjw@cs.Stanford.EDU</code></div>
<div class="source-line"><span class="line-number ">48</span><span class="line-counter cline-yes">&nbsp</span><code>*/</code></div>
<div class="source-line"><span class="line-number ">49</span><span class="line-counter cline-yes">&nbsp</span><code>var forge = require(&#39;./forge&#39;);</code></div>
<div class="source-line"><span class="line-number ">50</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<div class="source-line"><span class="line-number ">51</span><span class="line-counter cline-yes">&nbsp</span><code>module.exports = forge.jsbn = forge.jsbn || {};</code></div>
<div class="source-line"><span class="line-number ">52</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<div class="source-line"><span class="line-number ">53</span><span class="line-counter cline-yes">&nbsp</span><code>// Bits per digit</code></div>
<div class="source-line"><span class="line-number ">54</span><span class="line-counter cline-yes">&nbsp</span><code>var dbits;</code></div>
<div class="source-line"><span class="line-number ">55</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<div class="source-line"><span class="line-number ">56</span><span class="line-counter cline-yes">&nbsp</span><code>// JavaScript engine analysis</code></div>
<div class="source-line"><span class="line-number ">57</span><span class="line-counter cline-yes">&nbsp</span><code>var canary = 0xdeadbeefcafe;</code></div>
<div class="source-line"><span class="line-number ">58</span><span class="line-counter cline-yes">&nbsp</span><code>var j_lm = ((canary&amp;0xffffff)==0xefcafe);</code></div>
<div class="source-line"><span class="line-number ">59</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<div class="source-line"><span class="line-number ">60</span><span class="line-counter cline-yes">&nbsp</span><code>// (public) Constructor</code></div>
<div class="source-line"><span class="line-number ">61</span><span class="line-counter cline-yes">&nbsp</span><code>function BigInteger(a,b,c) {</code></div>
<div class="source-line"><span class="line-number ">62</span><span class="line-counter cline-yes">&nbsp</span><code>  this.data = [];</code></div>
<div class="source-line"><span class="line-number ">63</span><span class="line-counter cline-yes">&nbsp</span><code>  if(a != null)</code></div>
<div class="source-line"><span class="line-number ">64</span><span class="line-counter cline-no">！</span><code><span>    if(&quot;number&quot; == typeof a) </span><span class="cstat-no" title="statement not covered">this.fromNumber(a,b,c);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">65</span><span class="line-counter cline-no">！</span><code><span>    else if(b == null </span><span class="cstat-no" title="statement not covered">&amp;&amp; &quot;string&quot; != typeof a</span><span>) this.fromString(a,256);</span></code></div>
<div class="source-line"><span class="line-number ">66</span><span class="line-counter cline-yes">&nbsp</span><code>    else this.fromString(a,b);</code></div>
<div class="source-line"><span class="line-number ">67</span><span class="line-counter cline-yes">&nbsp</span><code>}</code></div>
<div class="source-line"><span class="line-number ">68</span><span class="line-counter cline-yes">&nbsp</span><code>forge.jsbn.BigInteger = BigInteger;</code></div>
<div class="source-line"><span class="line-number ">69</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<div class="source-line"><span class="line-number ">70</span><span class="line-counter cline-yes">&nbsp</span><code>// return new, unset BigInteger</code></div>
<div class="source-line"><span class="line-number ">71</span><span class="line-counter cline-yes">&nbsp</span><code>function nbi() { return new BigInteger(null); }</code></div>
<div class="source-line"><span class="line-number ">72</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<div class="source-line"><span class="line-number ">73</span><span class="line-counter cline-yes">&nbsp</span><code>// am: Compute w_j += (x*this_i), propagate carries,</code></div>
<div class="source-line"><span class="line-number ">74</span><span class="line-counter cline-yes">&nbsp</span><code>// c is initial carry, returns final carry.</code></div>
<div class="source-line"><span class="line-number ">75</span><span class="line-counter cline-yes">&nbsp</span><code>// c &lt; 3*dvalue, x &lt; 2*dvalue, this_i &lt; dvalue</code></div>
<div class="source-line"><span class="line-number ">76</span><span class="line-counter cline-yes">&nbsp</span><code>// We need to select the fastest one that works in this environment.</code></div>
<div class="source-line"><span class="line-number ">77</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<div class="source-line"><span class="line-number ">78</span><span class="line-counter cline-yes">&nbsp</span><code>// am1: use a single mult and divide to get the high bits,</code></div>
<div class="source-line"><span class="line-number ">79</span><span class="line-counter cline-yes">&nbsp</span><code>// max digit bits should be 26 because</code></div>
<div class="source-line"><span class="line-number ">80</span><span class="line-counter cline-yes">&nbsp</span><code>// max internal value = 2*dvalue^2-2*dvalue (&lt; 2^53)</code></div>
<div class="source-line"><span class="line-number ">81</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">function am1(i,x,w,j,c,n) {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">82</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  while(--n &gt;= 0) {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">83</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    var v = x*this.data[i++]+w.data[j]+c;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">84</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    c = Math.floor(v/0x4000000);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">85</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    w.data[j++] = v&amp;0x3ffffff;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">86</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  }</span><span></span></code></div>
<div class="source-line"><span class="line-number ">87</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  return c;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">88</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">}</span><span></span></code></div>
<div class="source-line"><span class="line-number ">89</span><span class="line-counter cline-yes">&nbsp</span><code>// am2 avoids a big mult-and-extract completely.</code></div>
<div class="source-line"><span class="line-number ">90</span><span class="line-counter cline-yes">&nbsp</span><code>// Max digit bits should be &lt;= 30 because we do bitwise ops</code></div>
<div class="source-line"><span class="line-number ">91</span><span class="line-counter cline-yes">&nbsp</span><code>// on values up to 2*hdvalue^2-hdvalue-1 (&lt; 2^31)</code></div>
<div class="source-line"><span class="line-number ">92</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">function am2(i,x,w,j,c,n) {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">93</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  var xl = x&amp;0x7fff, xh = x&gt;&gt;15;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">94</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  while(--n &gt;= 0) {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">95</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    var l = this.data[i]&amp;0x7fff;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">96</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    var h = this.data[i++]&gt;&gt;15;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">97</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    var m = xh*l+h*xl;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">98</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    l = xl*l+((m&amp;0x7fff)&lt;&lt;15)+w.data[j]+(c&amp;0x3fffffff);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">99</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    c = (l&gt;&gt;&gt;30)+(m&gt;&gt;&gt;15)+xh*h+(c&gt;&gt;&gt;30);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">100</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    w.data[j++] = l&amp;0x3fffffff;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">101</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  }</span><span></span></code></div>
<div class="source-line"><span class="line-number ">102</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  return c;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">103</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">}</span><span></span></code></div>
<div class="source-line"><span class="line-number ">104</span><span class="line-counter cline-yes">&nbsp</span><code>// Alternately, set max digit bits to 28 since some</code></div>
<div class="source-line"><span class="line-number ">105</span><span class="line-counter cline-yes">&nbsp</span><code>// browsers slow down when dealing with 32-bit numbers.</code></div>
<div class="source-line"><span class="line-number ">106</span><span class="line-counter cline-yes">&nbsp</span><code>function am3(i,x,w,j,c,n) {</code></div>
<div class="source-line"><span class="line-number ">107</span><span class="line-counter cline-yes">&nbsp</span><code>  var xl = x&amp;0x3fff, xh = x&gt;&gt;14;</code></div>
<div class="source-line"><span class="line-number ">108</span><span class="line-counter cline-yes">&nbsp</span><code>  while(--n &gt;= 0) {</code></div>
<div class="source-line"><span class="line-number ">109</span><span class="line-counter cline-yes">&nbsp</span><code>    var l = this.data[i]&amp;0x3fff;</code></div>
<div class="source-line"><span class="line-number ">110</span><span class="line-counter cline-yes">&nbsp</span><code>    var h = this.data[i++]&gt;&gt;14;</code></div>
<div class="source-line"><span class="line-number ">111</span><span class="line-counter cline-yes">&nbsp</span><code>    var m = xh*l+h*xl;</code></div>
<mark class="issue-line"><div class="source-line"><span class="line-number ">112</span><span class="line-counter cline-yes">&nbsp</span><code>    l = xl*l+((m&amp;0x3fff)&lt;&lt;14)+w.data[j]+c;</code></div>
</mark><details class="issue-inline-message issue-critical issue-memory-access target-RSASIGN">
                        <summary>💥&nbsp;<i>RSASIGN</i> Secret-dependent memory access</summary>
                <div class="issue-description">[RSASIGN] Found vulnerable memory access instruction, leakage score 100.00% +/- 0%.</div>
            </details><div class="source-line"><span class="line-number ">113</span><span class="line-counter cline-yes">&nbsp</span><code>    c = (l&gt;&gt;28)+(m&gt;&gt;14)+xh*h;</code></div>
<mark class="issue-line"><div class="source-line"><span class="line-number ">114</span><span class="line-counter cline-yes">&nbsp</span><code>    w.data[j++] = l&amp;0xfffffff;</code></div>
</mark><details class="issue-inline-message issue-critical issue-memory-access target-RSASIGN">
                        <summary>💥&nbsp;<i>RSASIGN</i> Secret-dependent memory access</summary>
                <div class="issue-description">[RSASIGN] Found vulnerable memory access instruction, leakage score 100.00% +/- 0%.</div>
            </details><div class="source-line"><span class="line-number ">115</span><span class="line-counter cline-yes">&nbsp</span><code>  }</code></div>
<div class="source-line"><span class="line-number ">116</span><span class="line-counter cline-yes">&nbsp</span><code>  return c;</code></div>
<div class="source-line"><span class="line-number ">117</span><span class="line-counter cline-yes">&nbsp</span><code>}</code></div>
<div class="source-line"><span class="line-number ">118</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<div class="source-line"><span class="line-number ">119</span><span class="line-counter cline-yes">&nbsp</span><code>// node.js (no browser)</code></div>
<div class="source-line"><span class="line-number ">120</span><span class="line-counter cline-yes">&nbsp</span><code>if(typeof(navigator) === &#39;undefined&#39;)</code></div>
<div class="source-line"><span class="line-number ">121</span><span class="line-counter cline-yes">&nbsp</span><code>{</code></div>
<div class="source-line"><span class="line-number ">122</span><span class="line-counter cline-yes">&nbsp</span><code>   BigInteger.prototype.am = am3;</code></div>
<div class="source-line"><span class="line-number ">123</span><span class="line-counter cline-yes">&nbsp</span><code>   dbits = 28;</code></div>
<div class="source-line"><span class="line-number ">124</span><span class="line-counter cline-no">！</span><code><span>}</span><span class="cstat-no" title="statement not covered"> else if(j_lm &amp;&amp; (navigator.appName == &quot;Microsoft Internet Explorer&quot;)) {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">125</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  BigInteger.prototype.am = am2;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">126</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  dbits = 30;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">127</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">} else if(j_lm &amp;&amp; (navigator.appName != &quot;Netscape&quot;)) {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">128</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  BigInteger.prototype.am = am1;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">129</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  dbits = 26;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">130</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">} else { // Mozilla/Netscape seems to prefer am3</span><span></span></code></div>
<div class="source-line"><span class="line-number ">131</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  BigInteger.prototype.am = am3;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">132</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  dbits = 28;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">133</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">}</span><span></span></code></div>
<div class="source-line"><span class="line-number ">134</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<div class="source-line"><span class="line-number ">135</span><span class="line-counter cline-yes">&nbsp</span><code>BigInteger.prototype.DB = dbits;</code></div>
<div class="source-line"><span class="line-number ">136</span><span class="line-counter cline-yes">&nbsp</span><code>BigInteger.prototype.DM = ((1&lt;&lt;dbits)-1);</code></div>
<div class="source-line"><span class="line-number ">137</span><span class="line-counter cline-yes">&nbsp</span><code>BigInteger.prototype.DV = (1&lt;&lt;dbits);</code></div>
<div class="source-line"><span class="line-number ">138</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<div class="source-line"><span class="line-number ">139</span><span class="line-counter cline-yes">&nbsp</span><code>var BI_FP = 52;</code></div>
<div class="source-line"><span class="line-number ">140</span><span class="line-counter cline-yes">&nbsp</span><code>BigInteger.prototype.FV = Math.pow(2,BI_FP);</code></div>
<div class="source-line"><span class="line-number ">141</span><span class="line-counter cline-yes">&nbsp</span><code>BigInteger.prototype.F1 = BI_FP-dbits;</code></div>
<div class="source-line"><span class="line-number ">142</span><span class="line-counter cline-yes">&nbsp</span><code>BigInteger.prototype.F2 = 2*dbits-BI_FP;</code></div>
<div class="source-line"><span class="line-number ">143</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<div class="source-line"><span class="line-number ">144</span><span class="line-counter cline-yes">&nbsp</span><code>// Digit conversions</code></div>
<div class="source-line"><span class="line-number ">145</span><span class="line-counter cline-yes">&nbsp</span><code>var BI_RM = &quot;0123456789abcdefghijklmnopqrstuvwxyz&quot;;</code></div>
<div class="source-line"><span class="line-number ">146</span><span class="line-counter cline-yes">&nbsp</span><code>var BI_RC = new Array();</code></div>
<div class="source-line"><span class="line-number ">147</span><span class="line-counter cline-yes">&nbsp</span><code>var rr,vv;</code></div>
<div class="source-line"><span class="line-number ">148</span><span class="line-counter cline-yes">&nbsp</span><code>rr = &quot;0&quot;.charCodeAt(0);</code></div>
<div class="source-line"><span class="line-number ">149</span><span class="line-counter cline-yes">&nbsp</span><code>for(vv = 0; vv &lt;= 9; ++vv) BI_RC[rr++] = vv;</code></div>
<div class="source-line"><span class="line-number ">150</span><span class="line-counter cline-yes">&nbsp</span><code>rr = &quot;a&quot;.charCodeAt(0);</code></div>
<div class="source-line"><span class="line-number ">151</span><span class="line-counter cline-yes">&nbsp</span><code>for(vv = 10; vv &lt; 36; ++vv) BI_RC[rr++] = vv;</code></div>
<div class="source-line"><span class="line-number ">152</span><span class="line-counter cline-yes">&nbsp</span><code>rr = &quot;A&quot;.charCodeAt(0);</code></div>
<div class="source-line"><span class="line-number ">153</span><span class="line-counter cline-yes">&nbsp</span><code>for(vv = 10; vv &lt; 36; ++vv) BI_RC[rr++] = vv;</code></div>
<div class="source-line"><span class="line-number ">154</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<div class="source-line"><span class="line-number ">155</span><span class="line-counter cline-yes">&nbsp</span><code>function int2char(n) { return BI_RM.charAt(n); }</code></div>
<div class="source-line"><span class="line-number ">156</span><span class="line-counter cline-yes">&nbsp</span><code>function intAt(s,i) {</code></div>
<mark class="issue-line"><div class="source-line"><span class="line-number ">157</span><span class="line-counter cline-yes">&nbsp</span><code>  var c = BI_RC[s.charCodeAt(i)];</code></div>
</mark><details class="issue-inline-message issue-critical issue-memory-access target-RSASIGN">
                        <summary>💥&nbsp;<i>RSASIGN</i> Secret-dependent memory access</summary>
                <div class="issue-description">[RSASIGN] Found vulnerable memory access instruction, leakage score 100.00% +/- 0%.</div>
            </details><div class="source-line"><span class="line-number ">158</span><span class="line-counter cline-no">！</span><code><span>  return (c==null)</span><span class="cstat-no" title="statement not covered">?-1</span><span>:c;</span></code></div>
<div class="source-line"><span class="line-number ">159</span><span class="line-counter cline-yes">&nbsp</span><code>}</code></div>
<div class="source-line"><span class="line-number ">160</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<div class="source-line"><span class="line-number ">161</span><span class="line-counter cline-yes">&nbsp</span><code>// (protected) copy this to r</code></div>
<div class="source-line"><span class="line-number ">162</span><span class="line-counter cline-yes">&nbsp</span><code>function bnpCopyTo(r) {</code></div>
<mark class="issue-line"><div class="source-line"><span class="line-number ">163</span><span class="line-counter cline-yes">&nbsp</span><code>  for(var i = this.t-1; i &gt;= 0; --i) r.data[i] = this.data[i];</code></div>
</mark><details class="issue-inline-message issue-critical issue-memory-access target-RSASIGN">
                        <summary>💥&nbsp;<i>RSASIGN</i> Secret-dependent memory access</summary>
                <div class="issue-description">[RSASIGN] Found vulnerable memory access instruction, leakage score 100.00% +/- 0%.</div>
            </details><mark class="issue-line"><div class="source-line"><span class="line-number ">164</span><span class="line-counter cline-yes">&nbsp</span><code>  r.t = this.t;</code></div>
</mark><details class="issue-inline-message issue-critical issue-memory-access target-RSASIGN">
                        <summary>💥&nbsp;<i>RSASIGN</i> Secret-dependent memory access</summary>
                <div class="issue-description">[RSASIGN] Found vulnerable memory access instruction, leakage score 100.00% +/- 0%.</div>
            </details><mark class="issue-line"><div class="source-line"><span class="line-number ">165</span><span class="line-counter cline-yes">&nbsp</span><code>  r.s = this.s;</code></div>
</mark><details class="issue-inline-message issue-critical issue-memory-access target-RSASIGN">
                        <summary>💥&nbsp;<i>RSASIGN</i> Secret-dependent memory access</summary>
                <div class="issue-description">[RSASIGN] Found vulnerable memory access instruction, leakage score 100.00% +/- 0%.</div>
            </details><div class="source-line"><span class="line-number ">166</span><span class="line-counter cline-yes">&nbsp</span><code>}</code></div>
<div class="source-line"><span class="line-number ">167</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<div class="source-line"><span class="line-number ">168</span><span class="line-counter cline-yes">&nbsp</span><code>// (protected) set from integer value x, -DV &lt;= x &lt; DV</code></div>
<div class="source-line"><span class="line-number ">169</span><span class="line-counter cline-yes">&nbsp</span><code>function bnpFromInt(x) {</code></div>
<div class="source-line"><span class="line-number ">170</span><span class="line-counter cline-yes">&nbsp</span><code>  this.t = 1;</code></div>
<div class="source-line"><span class="line-number ">171</span><span class="line-counter cline-no">！</span><code><span>  this.s = (x&lt;0)</span><span class="cstat-no" title="statement not covered">?-1</span><span>:0;</span></code></div>
<div class="source-line"><span class="line-number ">172</span><span class="line-counter cline-yes">&nbsp</span><code>  if(x &gt; 0) this.data[0] = x;</code></div>
<div class="source-line"><span class="line-number ">173</span><span class="line-counter cline-no">！</span><code><span>  else if(x &lt; -1) </span><span class="cstat-no" title="statement not covered">this.data[0] = x+this.DV;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">174</span><span class="line-counter cline-yes">&nbsp</span><code>  else this.t = 0;</code></div>
<div class="source-line"><span class="line-number ">175</span><span class="line-counter cline-yes">&nbsp</span><code>}</code></div>
<div class="source-line"><span class="line-number ">176</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<div class="source-line"><span class="line-number ">177</span><span class="line-counter cline-yes">&nbsp</span><code>// return bigint initialized to value</code></div>
<div class="source-line"><span class="line-number ">178</span><span class="line-counter cline-yes">&nbsp</span><code>function nbv(i) { var r = nbi(); r.fromInt(i); return r; }</code></div>
<div class="source-line"><span class="line-number ">179</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<div class="source-line"><span class="line-number ">180</span><span class="line-counter cline-yes">&nbsp</span><code>// (protected) set from string and radix</code></div>
<div class="source-line"><span class="line-number ">181</span><span class="line-counter cline-yes">&nbsp</span><code>function bnpFromString(s,b) {</code></div>
<div class="source-line"><span class="line-number ">182</span><span class="line-counter cline-yes">&nbsp</span><code>  var k;</code></div>
<div class="source-line"><span class="line-number ">183</span><span class="line-counter cline-yes">&nbsp</span><code>  if(b == 16) k = 4;</code></div>
<div class="source-line"><span class="line-number ">184</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  else if(b == 8) k = 3;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">185</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  else if(b == 256) k = 8; // byte array</span><span></span></code></div>
<div class="source-line"><span class="line-number ">186</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  else if(b == 2) k = 1;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">187</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  else if(b == 32) k = 5;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">188</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  else if(b == 4) k = 2;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">189</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  else { this.fromRadix(s,b); return; }</span><span></span></code></div>
<div class="source-line"><span class="line-number ">190</span><span class="line-counter cline-yes">&nbsp</span><code>  this.t = 0;</code></div>
<div class="source-line"><span class="line-number ">191</span><span class="line-counter cline-yes">&nbsp</span><code>  this.s = 0;</code></div>
<div class="source-line"><span class="line-number ">192</span><span class="line-counter cline-yes">&nbsp</span><code>  var i = s.length, mi = false, sh = 0;</code></div>
<mark class="issue-line"><div class="source-line"><span class="line-number ">193</span><span class="line-counter cline-yes">&nbsp</span><code>  while(--i &gt;= 0) {</code></div>
</mark><details class="issue-inline-message issue-critical issue-branch target-RSASIGN">
                        <summary>💥&nbsp;<i>RSASIGN</i> Secret-dependent branch</summary>
                <div class="issue-description">[RSASIGN] Found vulnerable jump instruction, leakage score 86.67% +/- 0%.</div>
            </details><div class="source-line"><span class="line-number ">194</span><span class="line-counter cline-no">！</span><code><span>    var x = (k==8)</span><span class="cstat-no" title="statement not covered">?s[i]&amp;0xff</span><span>:intAt(s,i);</span></code></div>
<div class="source-line"><span class="line-number ">195</span><span class="line-counter cline-no">！</span><code><span>    if(x &lt; 0) </span><span class="cstat-no" title="statement not covered">{</span><span></span></code></div>
<div class="source-line"><span class="line-number ">196</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">      if(s.charAt(i) == &quot;-&quot;) mi = true;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">197</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">      continue;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">198</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    }</span><span></span></code></div>
<div class="source-line"><span class="line-number ">199</span><span class="line-counter cline-yes">&nbsp</span><code>    mi = false;</code></div>
<div class="source-line"><span class="line-number ">200</span><span class="line-counter cline-yes">&nbsp</span><code>    if(sh == 0)</code></div>
<div class="source-line"><span class="line-number ">201</span><span class="line-counter cline-yes">&nbsp</span><code>      this.data[this.t++] = x;</code></div>
<div class="source-line"><span class="line-number ">202</span><span class="line-counter cline-no">！</span><code><span>    else if(sh+k &gt; this.DB) </span><span class="cstat-no" title="statement not covered">{</span><span></span></code></div>
<div class="source-line"><span class="line-number ">203</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">      this.data[this.t-1] |= (x&amp;((1&lt;&lt;(this.DB-sh))-1))&lt;&lt;sh;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">204</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">      this.data[this.t++] = (x&gt;&gt;(this.DB-sh));</span><span></span></code></div>
<div class="source-line"><span class="line-number ">205</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    }</span><span> else</span></code></div>
<div class="source-line"><span class="line-number ">206</span><span class="line-counter cline-yes">&nbsp</span><code>      this.data[this.t-1] |= x&lt;&lt;sh;</code></div>
<div class="source-line"><span class="line-number ">207</span><span class="line-counter cline-yes">&nbsp</span><code>    sh += k;</code></div>
<div class="source-line"><span class="line-number ">208</span><span class="line-counter cline-yes">&nbsp</span><code>    if(sh &gt;= this.DB) sh -= this.DB;</code></div>
<div class="source-line"><span class="line-number ">209</span><span class="line-counter cline-yes">&nbsp</span><code>  }</code></div>
<div class="source-line"><span class="line-number ">210</span><span class="line-counter cline-no">！</span><code><span>  if(k == 8 </span><span class="cstat-no" title="statement not covered">&amp;&amp; (s[0]&amp;0x80) != 0</span><span>) {</span></code></div>
<div class="source-line"><span class="line-number ">211</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    this.s = -1;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">212</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    if(sh &gt; 0) this.data[this.t-1] |= ((1&lt;&lt;(this.DB-sh))-1)&lt;&lt;sh;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">213</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  }</span><span></span></code></div>
<div class="source-line"><span class="line-number ">214</span><span class="line-counter cline-yes">&nbsp</span><code>  this.clamp();</code></div>
<div class="source-line"><span class="line-number ">215</span><span class="line-counter cline-no">！</span><code><span>  if(mi) </span><span class="cstat-no" title="statement not covered">BigInteger.ZERO.subTo(this,this);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">216</span><span class="line-counter cline-yes">&nbsp</span><code>}</code></div>
<div class="source-line"><span class="line-number ">217</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<div class="source-line"><span class="line-number ">218</span><span class="line-counter cline-yes">&nbsp</span><code>// (protected) clamp off excess high words</code></div>
<div class="source-line"><span class="line-number ">219</span><span class="line-counter cline-yes">&nbsp</span><code>function bnpClamp() {</code></div>
<div class="source-line"><span class="line-number ">220</span><span class="line-counter cline-yes">&nbsp</span><code>  var c = this.s&amp;this.DM;</code></div>
<div class="source-line"><span class="line-number ">221</span><span class="line-counter cline-yes">&nbsp</span><code>  while(this.t &gt; 0 &amp;&amp; this.data[this.t-1] == c) --this.t;</code></div>
<div class="source-line"><span class="line-number ">222</span><span class="line-counter cline-yes">&nbsp</span><code>}</code></div>
<div class="source-line"><span class="line-number ">223</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<div class="source-line"><span class="line-number ">224</span><span class="line-counter cline-yes">&nbsp</span><code>// (public) return string representation in given radix</code></div>
<div class="source-line"><span class="line-number ">225</span><span class="line-counter cline-yes">&nbsp</span><code>function bnToString(b) {</code></div>
<div class="source-line"><span class="line-number ">226</span><span class="line-counter cline-no">！</span><code><span>  if(this.s &lt; 0) </span><span class="cstat-no" title="statement not covered">return &quot;-&quot;+this.negate().toString(b);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">227</span><span class="line-counter cline-yes">&nbsp</span><code>  var k;</code></div>
<div class="source-line"><span class="line-number ">228</span><span class="line-counter cline-yes">&nbsp</span><code>  if(b == 16) k = 4;</code></div>
<div class="source-line"><span class="line-number ">229</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  else if(b == 8) k = 3;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">230</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  else if(b == 2) k = 1;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">231</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  else if(b == 32) k = 5;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">232</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  else if(b == 4) k = 2;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">233</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  else return this.toRadix(b);</span><span></span></code></div>
<mark class="issue-line"><div class="source-line"><span class="line-number ">234</span><span class="line-counter cline-yes">&nbsp</span><code>  var km = (1&lt;&lt;k)-1, d, m = false, r = &quot;&quot;, i = this.t;</code></div>
</mark><details class="issue-inline-message issue-major issue-memory-access target-RSASIGN">
                        <summary>🚨&nbsp;<i>RSASIGN</i> Secret-dependent memory access</summary>
                <div class="issue-description">[RSASIGN] Found vulnerable memory access instruction, leakage score 60.00% +/- 0%.</div>
            </details><mark class="issue-line"><div class="source-line"><span class="line-number ">235</span><span class="line-counter cline-yes">&nbsp</span><code>  var p = this.DB-(i*this.DB)%k;</code></div>
</mark><details class="issue-inline-message issue-major issue-memory-access target-RSASIGN">
                        <summary>🚨&nbsp;<i>RSASIGN</i> Secret-dependent memory access</summary>
                <div class="issue-description">[RSASIGN] Found vulnerable memory access instruction, leakage score 60.00% +/- 0%.</div>
            </details><div class="source-line"><span class="line-number ">236</span><span class="line-counter cline-yes">&nbsp</span><code>  if(i-- &gt; 0) {</code></div>
<div class="source-line"><span class="line-number ">237</span><span class="line-counter cline-no">！</span><code><span>    if(p &lt; this.DB </span><span class="cstat-no" title="statement not covered">&amp;&amp; (d = this.data[i]&gt;&gt;p) &gt; 0</span><span>) { m = true; r = int2char(d); }</span></code></div>
<div class="source-line"><span class="line-number ">238</span><span class="line-counter cline-yes">&nbsp</span><code>    while(i &gt;= 0) {</code></div>
<div class="source-line"><span class="line-number ">239</span><span class="line-counter cline-no">！</span><code><span>      if(p &lt; k) </span><span class="cstat-no" title="statement not covered">{</span><span></span></code></div>
<div class="source-line"><span class="line-number ">240</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">        d = (this.data[i]&amp;((1&lt;&lt;p)-1))&lt;&lt;(k-p);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">241</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">        d |= this.data[--i]&gt;&gt;(p+=this.DB-k);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">242</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">      }</span><span> else {</span></code></div>
<mark class="issue-line"><div class="source-line"><span class="line-number ">243</span><span class="line-counter cline-yes">&nbsp</span><code>        d = (this.data[i]&gt;&gt;(p-=k))&amp;km;</code></div>
</mark><details class="issue-inline-message issue-critical issue-memory-access target-RSASIGN">
                        <summary>💥&nbsp;<i>RSASIGN</i> Secret-dependent memory access</summary>
                <div class="issue-description">[RSASIGN] Found vulnerable memory access instruction, leakage score 89.59% +/- 15.52%.</div>
            </details><mark class="issue-line"><div class="source-line"><span class="line-number ">244</span><span class="line-counter cline-yes">&nbsp</span><code>        if(p &lt;= 0) { p += this.DB; --i; }</code></div>
</mark><details class="issue-inline-message issue-critical issue-memory-access target-RSASIGN">
                        <summary>💥&nbsp;<i>RSASIGN</i> Secret-dependent memory access</summary>
                <div class="issue-description">[RSASIGN] Found vulnerable memory access instruction, leakage score 92.22% +/- 14.61%.</div>
            </details><div class="source-line"><span class="line-number ">245</span><span class="line-counter cline-yes">&nbsp</span><code>      }</code></div>
<mark class="issue-line"><div class="source-line"><span class="line-number ">246</span><span class="line-counter cline-yes">&nbsp</span><code>      if(d &gt; 0) m = true;</code></div>
</mark><details class="issue-inline-message issue-critical issue-branch target-RSASIGN">
                        <summary>💥&nbsp;<i>RSASIGN</i> Secret-dependent branch</summary>
                <div class="issue-description">[RSASIGN] Found vulnerable jump instruction, leakage score 100.00% +/- 0%.</div>
            </details><div class="source-line"><span class="line-number ">247</span><span class="line-counter cline-yes">&nbsp</span><code>      if(m) r += int2char(d);</code></div>
<div class="source-line"><span class="line-number ">248</span><span class="line-counter cline-yes">&nbsp</span><code>    }</code></div>
<div class="source-line"><span class="line-number ">249</span><span class="line-counter cline-yes">&nbsp</span><code>  }</code></div>
<div class="source-line"><span class="line-number ">250</span><span class="line-counter cline-no">！</span><code><span>  return m?r</span><span class="cstat-no" title="statement not covered">:&quot;0&quot;</span><span>;</span></code></div>
<div class="source-line"><span class="line-number ">251</span><span class="line-counter cline-yes">&nbsp</span><code>}</code></div>
<div class="source-line"><span class="line-number ">252</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<div class="source-line"><span class="line-number ">253</span><span class="line-counter cline-yes">&nbsp</span><code>// (public) -this</code></div>
<div class="source-line"><span class="line-number ">254</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">function bnNegate() { var r = nbi(); BigInteger.ZERO.subTo(this,r); return r; }</span><span></span></code></div>
<div class="source-line"><span class="line-number ">255</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<div class="source-line"><span class="line-number ">256</span><span class="line-counter cline-yes">&nbsp</span><code>// (public) |this|</code></div>
<div class="source-line"><span class="line-number ">257</span><span class="line-counter cline-no">！</span><code><span>function bnAbs() { return (this.s&lt;0)</span><span class="cstat-no" title="statement not covered">?this.negate()</span><span>:this; }</span></code></div>
<div class="source-line"><span class="line-number ">258</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<div class="source-line"><span class="line-number ">259</span><span class="line-counter cline-yes">&nbsp</span><code>// (public) return + if this &gt; a, - if this &lt; a, 0 if equal</code></div>
<div class="source-line"><span class="line-number ">260</span><span class="line-counter cline-yes">&nbsp</span><code>function bnCompareTo(a) {</code></div>
<mark class="issue-line"><div class="source-line"><span class="line-number ">261</span><span class="line-counter cline-yes">&nbsp</span><code>  var r = this.s-a.s;</code></div>
</mark><details class="issue-inline-message issue-critical issue-memory-access target-RSASIGN">
                        <summary>💥&nbsp;<i>RSASIGN</i> Secret-dependent memory access</summary>
                <div class="issue-description">[RSASIGN] Found vulnerable memory access instruction, leakage score 100.00% +/- 0%.</div>
            </details><div class="source-line"><span class="line-number ">262</span><span class="line-counter cline-yes">&nbsp</span><code>  if(r != 0) return r;</code></div>
<mark class="issue-line"><div class="source-line"><span class="line-number ">263</span><span class="line-counter cline-yes">&nbsp</span><code>  var i = this.t;</code></div>
</mark><details class="issue-inline-message issue-critical issue-memory-access target-RSASIGN">
                        <summary>💥&nbsp;<i>RSASIGN</i> Secret-dependent memory access</summary>
                <div class="issue-description">[RSASIGN] Found vulnerable memory access instruction, leakage score 100.00% +/- 0%.</div>
            </details><mark class="issue-line"><div class="source-line"><span class="line-number ">264</span><span class="line-counter cline-yes">&nbsp</span><code>  r = i-a.t;</code></div>
</mark><details class="issue-inline-message issue-critical issue-memory-access target-RSASIGN">
                        <summary>💥&nbsp;<i>RSASIGN</i> Secret-dependent memory access</summary>
                <div class="issue-description">[RSASIGN] Found vulnerable memory access instruction, leakage score 100.00% +/- 0%.</div>
            </details><div class="source-line"><span class="line-number ">265</span><span class="line-counter cline-no">！</span><code><span>  if(r != 0) return (this.s&lt;0)</span><span class="cstat-no" title="statement not covered">?-r</span><span>:r;</span></code></div>
<mark class="issue-line"><div class="source-line"><span class="line-number ">266</span><span class="line-counter cline-yes">&nbsp</span><code>  while(--i &gt;= 0) if((r=this.data[i]-a.data[i]) != 0) return r;</code></div>
</mark><details class="issue-inline-message issue-critical issue-branch target-RSASIGN">
                        <summary>💥&nbsp;<i>RSASIGN</i> Secret-dependent branch</summary>
                <div class="issue-description">[RSASIGN] Found vulnerable jump instruction, leakage score 100.00% +/- 0%.</div>
            </details><div class="source-line"><span class="line-number ">267</span><span class="line-counter cline-yes">&nbsp</span><code>  return 0;</code></div>
<div class="source-line"><span class="line-number ">268</span><span class="line-counter cline-yes">&nbsp</span><code>}</code></div>
<div class="source-line"><span class="line-number ">269</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<div class="source-line"><span class="line-number ">270</span><span class="line-counter cline-yes">&nbsp</span><code>// returns bit length of the integer x</code></div>
<div class="source-line"><span class="line-number ">271</span><span class="line-counter cline-yes">&nbsp</span><code>function nbits(x) {</code></div>
<div class="source-line"><span class="line-number ">272</span><span class="line-counter cline-yes">&nbsp</span><code>  var r = 1, t;</code></div>
<mark class="issue-line"><div class="source-line"><span class="line-number ">273</span><span class="line-counter cline-yes">&nbsp</span><code>  if((t=x&gt;&gt;&gt;16) != 0) { x = t; r += 16; }</code></div>
</mark><details class="issue-inline-message issue-critical issue-branch target-RSASIGN">
                        <summary>💥&nbsp;<i>RSASIGN</i> Secret-dependent branch</summary>
                <div class="issue-description">[RSASIGN] Found vulnerable jump instruction, leakage score 100.00% +/- 0%.</div>
            </details><mark class="issue-line"><div class="source-line"><span class="line-number ">274</span><span class="line-counter cline-yes">&nbsp</span><code>  if((t=x&gt;&gt;8) != 0) { x = t; r += 8; }</code></div>
</mark><details class="issue-inline-message issue-critical issue-branch target-RSASIGN">
                        <summary>💥&nbsp;<i>RSASIGN</i> Secret-dependent branch</summary>
                <div class="issue-description">[RSASIGN] Found vulnerable jump instruction, leakage score 100.00% +/- 0%.</div>
            </details><div class="source-line"><span class="line-number ">275</span><span class="line-counter cline-yes">&nbsp</span><code>  if((t=x&gt;&gt;4) != 0) { x = t; r += 4; }</code></div>
<mark class="issue-line"><div class="source-line"><span class="line-number ">276</span><span class="line-counter cline-yes">&nbsp</span><code>  if((t=x&gt;&gt;2) != 0) { x = t; r += 2; }</code></div>
</mark><details class="issue-inline-message issue-critical issue-branch target-RSASIGN">
                        <summary>💥&nbsp;<i>RSASIGN</i> Secret-dependent branch</summary>
                <div class="issue-description">[RSASIGN] Found vulnerable jump instruction, leakage score 96.67% +/- 3.33%.</div>
            </details><mark class="issue-line"><div class="source-line"><span class="line-number ">277</span><span class="line-counter cline-yes">&nbsp</span><code>  if((t=x&gt;&gt;1) != 0) { x = t; r += 1; }</code></div>
</mark><details class="issue-inline-message issue-critical issue-branch target-RSASIGN">
                        <summary>💥&nbsp;<i>RSASIGN</i> Secret-dependent branch</summary>
                <div class="issue-description">[RSASIGN] Found vulnerable jump instruction, leakage score 93.33% +/- 0%.</div>
            </details><div class="source-line"><span class="line-number ">278</span><span class="line-counter cline-yes">&nbsp</span><code>  return r;</code></div>
<div class="source-line"><span class="line-number ">279</span><span class="line-counter cline-yes">&nbsp</span><code>}</code></div>
<div class="source-line"><span class="line-number ">280</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<div class="source-line"><span class="line-number ">281</span><span class="line-counter cline-yes">&nbsp</span><code>// (public) return the number of bits in &quot;this&quot;</code></div>
<div class="source-line"><span class="line-number ">282</span><span class="line-counter cline-yes">&nbsp</span><code>function bnBitLength() {</code></div>
<div class="source-line"><span class="line-number ">283</span><span class="line-counter cline-no">！</span><code><span>  if(this.t &lt;= 0) </span><span class="cstat-no" title="statement not covered">return 0;</span><span></span></code></div>
<mark class="issue-line"><div class="source-line"><span class="line-number ">284</span><span class="line-counter cline-yes">&nbsp</span><code>  return this.DB*(this.t-1)+nbits(this.data[this.t-1]^(this.s&amp;this.DM));</code></div>
</mark><details class="issue-inline-message issue-critical issue-memory-access target-RSASIGN">
                        <summary>💥&nbsp;<i>RSASIGN</i> Secret-dependent memory access</summary>
                <div class="issue-description">[RSASIGN] Found vulnerable memory access instruction, leakage score 100.00% +/- 0%.</div>
            </details><div class="source-line"><span class="line-number ">285</span><span class="line-counter cline-yes">&nbsp</span><code>}</code></div>
<div class="source-line"><span class="line-number ">286</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<div class="source-line"><span class="line-number ">287</span><span class="line-counter cline-yes">&nbsp</span><code>// (protected) r = this &lt;&lt; n*DB</code></div>
<div class="source-line"><span class="line-number ">288</span><span class="line-counter cline-yes">&nbsp</span><code>function bnpDLShiftTo(n,r) {</code></div>
<div class="source-line"><span class="line-number ">289</span><span class="line-counter cline-yes">&nbsp</span><code>  var i;</code></div>
<mark class="issue-line"><div class="source-line"><span class="line-number ">290</span><span class="line-counter cline-yes">&nbsp</span><code>  for(i = this.t-1; i &gt;= 0; --i) r.data[i+n] = this.data[i];</code></div>
</mark><details class="issue-inline-message issue-critical issue-branch target-RSASIGN">
                        <summary>💥&nbsp;<i>RSASIGN</i> Secret-dependent branch</summary>
                <div class="issue-description">[RSASIGN] Found vulnerable jump instruction, leakage score 100.00% +/- 0%.</div>
            </details><mark class="issue-line"><div class="source-line"><span class="line-number ">291</span><span class="line-counter cline-yes">&nbsp</span><code>  for(i = n-1; i &gt;= 0; --i) r.data[i] = 0;</code></div>
</mark><details class="issue-inline-message issue-critical issue-branch target-RSASIGN">
                        <summary>💥&nbsp;<i>RSASIGN</i> Secret-dependent branch</summary>
                <div class="issue-description">[RSASIGN] Found vulnerable jump instruction, leakage score 100.00% +/- 0%.</div>
            </details><div class="source-line"><span class="line-number ">292</span><span class="line-counter cline-yes">&nbsp</span><code>  r.t = this.t+n;</code></div>
<div class="source-line"><span class="line-number ">293</span><span class="line-counter cline-yes">&nbsp</span><code>  r.s = this.s;</code></div>
<div class="source-line"><span class="line-number ">294</span><span class="line-counter cline-yes">&nbsp</span><code>}</code></div>
<div class="source-line"><span class="line-number ">295</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<div class="source-line"><span class="line-number ">296</span><span class="line-counter cline-yes">&nbsp</span><code>// (protected) r = this &gt;&gt; n*DB</code></div>
<div class="source-line"><span class="line-number ">297</span><span class="line-counter cline-yes">&nbsp</span><code>function bnpDRShiftTo(n,r) {</code></div>
<mark class="issue-line"><div class="source-line"><span class="line-number ">298</span><span class="line-counter cline-yes">&nbsp</span><code>  for(var i = n; i &lt; this.t; ++i) r.data[i-n] = this.data[i];</code></div>
</mark><details class="issue-inline-message issue-critical issue-branch target-RSASIGN">
                        <summary>💥&nbsp;<i>RSASIGN</i> Secret-dependent branch</summary>
                <div class="issue-description">[RSASIGN] Found vulnerable jump instruction, leakage score 100.00% +/- 0%.</div>
            </details><div class="source-line"><span class="line-number ">299</span><span class="line-counter cline-yes">&nbsp</span><code>  r.t = Math.max(this.t-n,0);</code></div>
<div class="source-line"><span class="line-number ">300</span><span class="line-counter cline-yes">&nbsp</span><code>  r.s = this.s;</code></div>
<div class="source-line"><span class="line-number ">301</span><span class="line-counter cline-yes">&nbsp</span><code>}</code></div>
<div class="source-line"><span class="line-number ">302</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<div class="source-line"><span class="line-number ">303</span><span class="line-counter cline-yes">&nbsp</span><code>// (protected) r = this &lt;&lt; n</code></div>
<div class="source-line"><span class="line-number ">304</span><span class="line-counter cline-yes">&nbsp</span><code>function bnpLShiftTo(n,r) {</code></div>
<div class="source-line"><span class="line-number ">305</span><span class="line-counter cline-yes">&nbsp</span><code>  var bs = n%this.DB;</code></div>
<div class="source-line"><span class="line-number ">306</span><span class="line-counter cline-yes">&nbsp</span><code>  var cbs = this.DB-bs;</code></div>
<div class="source-line"><span class="line-number ">307</span><span class="line-counter cline-yes">&nbsp</span><code>  var bm = (1&lt;&lt;cbs)-1;</code></div>
<div class="source-line"><span class="line-number ">308</span><span class="line-counter cline-yes">&nbsp</span><code>  var ds = Math.floor(n/this.DB), c = (this.s&lt;&lt;bs)&amp;this.DM, i;</code></div>
<mark class="issue-line"><div class="source-line"><span class="line-number ">309</span><span class="line-counter cline-yes">&nbsp</span><code>  for(i = this.t-1; i &gt;= 0; --i) {</code></div>
</mark><details class="issue-inline-message issue-critical issue-branch target-RSASIGN">
                        <summary>💥&nbsp;<i>RSASIGN</i> Secret-dependent branch</summary>
                <div class="issue-description">[RSASIGN] Found vulnerable jump instruction, leakage score 100.00% +/- 0%.</div>
            </details><mark class="issue-line"><div class="source-line"><span class="line-number ">310</span><span class="line-counter cline-yes">&nbsp</span><code>    r.data[i+ds+1] = (this.data[i]&gt;&gt;cbs)|c;</code></div>
</mark><details class="issue-inline-message issue-critical issue-memory-access target-RSASIGN">
                        <summary>💥&nbsp;<i>RSASIGN</i> Secret-dependent memory access</summary>
                <div class="issue-description">[RSASIGN] Found vulnerable memory access instruction, leakage score 100.00% +/- 0%.</div>
            </details><mark class="issue-line"><div class="source-line"><span class="line-number ">311</span><span class="line-counter cline-yes">&nbsp</span><code>    c = (this.data[i]&amp;bm)&lt;&lt;bs;</code></div>
</mark><details class="issue-inline-message issue-critical issue-memory-access target-RSASIGN">
                        <summary>💥&nbsp;<i>RSASIGN</i> Secret-dependent memory access</summary>
                <div class="issue-description">[RSASIGN] Found vulnerable memory access instruction, leakage score 100.00% +/- 0%.</div>
            </details><div class="source-line"><span class="line-number ">312</span><span class="line-counter cline-yes">&nbsp</span><code>  }</code></div>
<div class="source-line"><span class="line-number ">313</span><span class="line-counter cline-no">！</span><code><span>  for(i = ds-1; i &gt;= 0; --i) </span><span class="cstat-no" title="statement not covered">r.data[i] = 0;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">314</span><span class="line-counter cline-yes">&nbsp</span><code>  r.data[ds] = c;</code></div>
<div class="source-line"><span class="line-number ">315</span><span class="line-counter cline-yes">&nbsp</span><code>  r.t = this.t+ds+1;</code></div>
<div class="source-line"><span class="line-number ">316</span><span class="line-counter cline-yes">&nbsp</span><code>  r.s = this.s;</code></div>
<div class="source-line"><span class="line-number ">317</span><span class="line-counter cline-yes">&nbsp</span><code>  r.clamp();</code></div>
<div class="source-line"><span class="line-number ">318</span><span class="line-counter cline-yes">&nbsp</span><code>}</code></div>
<div class="source-line"><span class="line-number ">319</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<div class="source-line"><span class="line-number ">320</span><span class="line-counter cline-yes">&nbsp</span><code>// (protected) r = this &gt;&gt; n</code></div>
<div class="source-line"><span class="line-number ">321</span><span class="line-counter cline-yes">&nbsp</span><code>function bnpRShiftTo(n,r) {</code></div>
<div class="source-line"><span class="line-number ">322</span><span class="line-counter cline-yes">&nbsp</span><code>  r.s = this.s;</code></div>
<div class="source-line"><span class="line-number ">323</span><span class="line-counter cline-yes">&nbsp</span><code>  var ds = Math.floor(n/this.DB);</code></div>
<div class="source-line"><span class="line-number ">324</span><span class="line-counter cline-yes">&nbsp</span><code>  if(ds &gt;= this.t) { r.t = 0; return; }</code></div>
<div class="source-line"><span class="line-number ">325</span><span class="line-counter cline-yes">&nbsp</span><code>  var bs = n%this.DB;</code></div>
<div class="source-line"><span class="line-number ">326</span><span class="line-counter cline-yes">&nbsp</span><code>  var cbs = this.DB-bs;</code></div>
<div class="source-line"><span class="line-number ">327</span><span class="line-counter cline-yes">&nbsp</span><code>  var bm = (1&lt;&lt;bs)-1;</code></div>
<div class="source-line"><span class="line-number ">328</span><span class="line-counter cline-yes">&nbsp</span><code>  r.data[0] = this.data[ds]&gt;&gt;bs;</code></div>
<mark class="issue-line"><div class="source-line"><span class="line-number ">329</span><span class="line-counter cline-yes">&nbsp</span><code>  for(var i = ds+1; i &lt; this.t; ++i) {</code></div>
</mark><details class="issue-inline-message issue-critical issue-branch target-RSASIGN">
                        <summary>💥&nbsp;<i>RSASIGN</i> Secret-dependent branch</summary>
                <div class="issue-description">[RSASIGN] Found vulnerable jump instruction, leakage score 100.00% +/- 0%.</div>
            </details><div class="source-line"><span class="line-number ">330</span><span class="line-counter cline-yes">&nbsp</span><code>    r.data[i-ds-1] |= (this.data[i]&amp;bm)&lt;&lt;cbs;</code></div>
<div class="source-line"><span class="line-number ">331</span><span class="line-counter cline-yes">&nbsp</span><code>    r.data[i-ds] = this.data[i]&gt;&gt;bs;</code></div>
<div class="source-line"><span class="line-number ">332</span><span class="line-counter cline-yes">&nbsp</span><code>  }</code></div>
<div class="source-line"><span class="line-number ">333</span><span class="line-counter cline-yes">&nbsp</span><code>  if(bs &gt; 0) r.data[this.t-ds-1] |= (this.s&amp;bm)&lt;&lt;cbs;</code></div>
<div class="source-line"><span class="line-number ">334</span><span class="line-counter cline-yes">&nbsp</span><code>  r.t = this.t-ds;</code></div>
<div class="source-line"><span class="line-number ">335</span><span class="line-counter cline-yes">&nbsp</span><code>  r.clamp();</code></div>
<div class="source-line"><span class="line-number ">336</span><span class="line-counter cline-yes">&nbsp</span><code>}</code></div>
<div class="source-line"><span class="line-number ">337</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<div class="source-line"><span class="line-number ">338</span><span class="line-counter cline-yes">&nbsp</span><code>// (protected) r = this - a</code></div>
<div class="source-line"><span class="line-number ">339</span><span class="line-counter cline-yes">&nbsp</span><code>function bnpSubTo(a,r) {</code></div>
<mark class="issue-line"><div class="source-line"><span class="line-number ">340</span><span class="line-counter cline-yes">&nbsp</span><code>  var i = 0, c = 0, m = Math.min(a.t,this.t);</code></div>
</mark><details class="issue-inline-message issue-critical issue-memory-access target-RSASIGN">
                        <summary>💥&nbsp;<i>RSASIGN</i> Secret-dependent memory access</summary>
                <div class="issue-description">[RSASIGN] Found vulnerable memory access instruction, leakage score 100.00% +/- 0%.</div>
            </details><mark class="issue-line"><div class="source-line"><span class="line-number ">341</span><span class="line-counter cline-yes">&nbsp</span><code>  while(i &lt; m) {</code></div>
</mark><details class="issue-inline-message issue-critical issue-branch target-RSASIGN">
                        <summary>💥&nbsp;<i>RSASIGN</i> Secret-dependent branch</summary>
                <div class="issue-description">[RSASIGN] Found vulnerable jump instruction, leakage score 100.00% +/- 0%.</div>
            </details><mark class="issue-line"><div class="source-line"><span class="line-number ">342</span><span class="line-counter cline-yes">&nbsp</span><code>    c += this.data[i]-a.data[i];</code></div>
</mark><details class="issue-inline-message issue-critical issue-memory-access target-RSASIGN">
                        <summary>💥&nbsp;<i>RSASIGN</i> Secret-dependent memory access</summary>
                <div class="issue-description">[RSASIGN] Found vulnerable memory access instruction, leakage score 100.00% +/- 0%.</div>
            </details><mark class="issue-line"><div class="source-line"><span class="line-number ">343</span><span class="line-counter cline-yes">&nbsp</span><code>    r.data[i++] = c&amp;this.DM;</code></div>
</mark><details class="issue-inline-message issue-critical issue-memory-access target-RSASIGN">
                        <summary>💥&nbsp;<i>RSASIGN</i> Secret-dependent memory access</summary>
                <div class="issue-description">[RSASIGN] Found vulnerable memory access instruction, leakage score 100.00% +/- 0%.</div>
            </details><mark class="issue-line"><div class="source-line"><span class="line-number ">344</span><span class="line-counter cline-yes">&nbsp</span><code>    c &gt;&gt;= this.DB;</code></div>
</mark><details class="issue-inline-message issue-critical issue-memory-access target-RSASIGN">
                        <summary>💥&nbsp;<i>RSASIGN</i> Secret-dependent memory access</summary>
                <div class="issue-description">[RSASIGN] Found vulnerable memory access instruction, leakage score 100.00% +/- 0%.</div>
            </details><div class="source-line"><span class="line-number ">345</span><span class="line-counter cline-yes">&nbsp</span><code>  }</code></div>
<mark class="issue-line"><div class="source-line"><span class="line-number ">346</span><span class="line-counter cline-yes">&nbsp</span><code>  if(a.t &lt; this.t) {</code></div>
</mark><details class="issue-inline-message issue-critical issue-memory-access target-RSASIGN">
                        <summary>💥&nbsp;<i>RSASIGN</i> Secret-dependent memory access</summary>
                <div class="issue-description">[RSASIGN] Found vulnerable memory access instruction, leakage score 100.00% +/- 0%.</div>
            </details><mark class="issue-line"><div class="source-line"><span class="line-number ">347</span><span class="line-counter cline-yes">&nbsp</span><code>    c -= a.s;</code></div>
</mark><details class="issue-inline-message issue-critical issue-memory-access target-RSASIGN">
                        <summary>💥&nbsp;<i>RSASIGN</i> Secret-dependent memory access</summary>
                <div class="issue-description">[RSASIGN] Found vulnerable memory access instruction, leakage score 100.00% +/- 0%.</div>
            </details><mark class="issue-line"><div class="source-line"><span class="line-number ">348</span><span class="line-counter cline-yes">&nbsp</span><code>    while(i &lt; this.t) {</code></div>
</mark><details class="issue-inline-message issue-critical issue-memory-access target-RSASIGN">
                        <summary>💥&nbsp;<i>RSASIGN</i> Secret-dependent memory access</summary>
                <div class="issue-description">[RSASIGN] Found vulnerable memory access instruction, leakage score 100.00% +/- 0%.</div>
            </details><mark class="issue-line"><div class="source-line"><span class="line-number ">349</span><span class="line-counter cline-yes">&nbsp</span><code>      c += this.data[i];</code></div>
</mark><details class="issue-inline-message issue-critical issue-memory-access target-RSASIGN">
                        <summary>💥&nbsp;<i>RSASIGN</i> Secret-dependent memory access</summary>
                <div class="issue-description">[RSASIGN] Found vulnerable memory access instruction, leakage score 100.00% +/- 0%.</div>
            </details><mark class="issue-line"><div class="source-line"><span class="line-number ">350</span><span class="line-counter cline-yes">&nbsp</span><code>      r.data[i++] = c&amp;this.DM;</code></div>
</mark><details class="issue-inline-message issue-critical issue-memory-access target-RSASIGN">
                        <summary>💥&nbsp;<i>RSASIGN</i> Secret-dependent memory access</summary>
                <div class="issue-description">[RSASIGN] Found vulnerable memory access instruction, leakage score 100.00% +/- 0%.</div>
            </details><mark class="issue-line"><div class="source-line"><span class="line-number ">351</span><span class="line-counter cline-yes">&nbsp</span><code>      c &gt;&gt;= this.DB;</code></div>
</mark><details class="issue-inline-message issue-critical issue-memory-access target-RSASIGN">
                        <summary>💥&nbsp;<i>RSASIGN</i> Secret-dependent memory access</summary>
                <div class="issue-description">[RSASIGN] Found vulnerable memory access instruction, leakage score 100.00% +/- 0%.</div>
            </details><div class="source-line"><span class="line-number ">352</span><span class="line-counter cline-yes">&nbsp</span><code>    }</code></div>
<mark class="issue-line"><div class="source-line"><span class="line-number ">353</span><span class="line-counter cline-yes">&nbsp</span><code>    c += this.s;</code></div>
</mark><details class="issue-inline-message issue-critical issue-memory-access target-RSASIGN">
                        <summary>💥&nbsp;<i>RSASIGN</i> Secret-dependent memory access</summary>
                <div class="issue-description">[RSASIGN] Found vulnerable memory access instruction, leakage score 100.00% +/- 0%.</div>
            </details><div class="source-line"><span class="line-number ">354</span><span class="line-counter cline-yes">&nbsp</span><code>  } else {</code></div>
<mark class="issue-line"><div class="source-line"><span class="line-number ">355</span><span class="line-counter cline-yes">&nbsp</span><code>    c += this.s;</code></div>
</mark><details class="issue-inline-message issue-critical issue-memory-access target-RSASIGN">
                        <summary>💥&nbsp;<i>RSASIGN</i> Secret-dependent memory access</summary>
                <div class="issue-description">[RSASIGN] Found vulnerable memory access instruction, leakage score 100.00% +/- 0%.</div>
            </details><mark class="issue-line"><div class="source-line"><span class="line-number ">356</span><span class="line-counter cline-yes">&nbsp</span><code>    while(i &lt; a.t) {</code></div>
</mark><details class="issue-inline-message issue-critical issue-memory-access target-RSASIGN">
                        <summary>💥&nbsp;<i>RSASIGN</i> Secret-dependent memory access</summary>
                <div class="issue-description">[RSASIGN] Found vulnerable memory access instruction, leakage score 100.00% +/- 0%.</div>
            </details><div class="source-line"><span class="line-number ">357</span><span class="line-counter cline-yes">&nbsp</span><code>      c -= a.data[i];</code></div>
<div class="source-line"><span class="line-number ">358</span><span class="line-counter cline-yes">&nbsp</span><code>      r.data[i++] = c&amp;this.DM;</code></div>
<div class="source-line"><span class="line-number ">359</span><span class="line-counter cline-yes">&nbsp</span><code>      c &gt;&gt;= this.DB;</code></div>
<div class="source-line"><span class="line-number ">360</span><span class="line-counter cline-yes">&nbsp</span><code>    }</code></div>
<mark class="issue-line"><div class="source-line"><span class="line-number ">361</span><span class="line-counter cline-yes">&nbsp</span><code>    c -= a.s;</code></div>
</mark><details class="issue-inline-message issue-critical issue-memory-access target-RSASIGN">
                        <summary>💥&nbsp;<i>RSASIGN</i> Secret-dependent memory access</summary>
                <div class="issue-description">[RSASIGN] Found vulnerable memory access instruction, leakage score 100.00% +/- 0%.</div>
            </details><div class="source-line"><span class="line-number ">362</span><span class="line-counter cline-yes">&nbsp</span><code>  }</code></div>
<div class="source-line"><span class="line-number ">363</span><span class="line-counter cline-yes">&nbsp</span><code>  r.s = (c&lt;0)?-1:0;</code></div>
<div class="source-line"><span class="line-number ">364</span><span class="line-counter cline-no">！</span><code><span>  if(c &lt; -1) </span><span class="cstat-no" title="statement not covered">r.data[i++] = this.DV+c;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">365</span><span class="line-counter cline-no">！</span><code><span>  else if(c &gt; 0) </span><span class="cstat-no" title="statement not covered">r.data[i++] = c;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">366</span><span class="line-counter cline-yes">&nbsp</span><code>  r.t = i;</code></div>
<div class="source-line"><span class="line-number ">367</span><span class="line-counter cline-yes">&nbsp</span><code>  r.clamp();</code></div>
<div class="source-line"><span class="line-number ">368</span><span class="line-counter cline-yes">&nbsp</span><code>}</code></div>
<div class="source-line"><span class="line-number ">369</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<div class="source-line"><span class="line-number ">370</span><span class="line-counter cline-yes">&nbsp</span><code>// (protected) r = this * a, r != this,a (HAC 14.12)</code></div>
<div class="source-line"><span class="line-number ">371</span><span class="line-counter cline-yes">&nbsp</span><code>// &quot;this&quot; should be the larger one if appropriate.</code></div>
<div class="source-line"><span class="line-number ">372</span><span class="line-counter cline-yes">&nbsp</span><code>function bnpMultiplyTo(a,r) {</code></div>
<mark class="issue-line"><div class="source-line"><span class="line-number ">373</span><span class="line-counter cline-yes">&nbsp</span><code>  var x = this.abs(), y = a.abs();</code></div>
</mark><details class="issue-inline-message issue-critical issue-memory-access target-RSASIGN">
                        <summary>💥&nbsp;<i>RSASIGN</i> Secret-dependent memory access</summary>
                <div class="issue-description">[RSASIGN] Found vulnerable memory access instruction, leakage score 100.00% +/- 0%.</div>
            </details><div class="source-line"><span class="line-number ">374</span><span class="line-counter cline-yes">&nbsp</span><code>  var i = x.t;</code></div>
<mark class="issue-line"><div class="source-line"><span class="line-number ">375</span><span class="line-counter cline-yes">&nbsp</span><code>  r.t = i+y.t;</code></div>
</mark><details class="issue-inline-message issue-critical issue-memory-access target-RSASIGN">
                        <summary>💥&nbsp;<i>RSASIGN</i> Secret-dependent memory access</summary>
                <div class="issue-description">[RSASIGN] Found vulnerable memory access instruction, leakage score 100.00% +/- 0%.</div>
            </details><mark class="issue-line"><div class="source-line"><span class="line-number ">376</span><span class="line-counter cline-yes">&nbsp</span><code>  while(--i &gt;= 0) r.data[i] = 0;</code></div>
</mark><details class="issue-inline-message issue-critical issue-branch target-RSASIGN">
                        <summary>💥&nbsp;<i>RSASIGN</i> Secret-dependent branch</summary>
                <div class="issue-description">[RSASIGN] Found vulnerable jump instruction, leakage score 100.00% +/- 0%.</div>
            </details><mark class="issue-line"><div class="source-line"><span class="line-number ">377</span><span class="line-counter cline-yes">&nbsp</span><code>  for(i = 0; i &lt; y.t; ++i) r.data[i+x.t] = x.am(0,y.data[i],r,i,0,x.t);</code></div>
</mark><details class="issue-inline-message issue-critical issue-memory-access target-RSASIGN">
                        <summary>💥&nbsp;<i>RSASIGN</i> Secret-dependent memory access</summary>
                <div class="issue-description">[RSASIGN] Found vulnerable memory access instruction, leakage score 100.00% +/- 0%.</div>
            </details><div class="source-line"><span class="line-number ">378</span><span class="line-counter cline-yes">&nbsp</span><code>  r.s = 0;</code></div>
<div class="source-line"><span class="line-number ">379</span><span class="line-counter cline-yes">&nbsp</span><code>  r.clamp();</code></div>
<div class="source-line"><span class="line-number ">380</span><span class="line-counter cline-no">！</span><code><span>  if(this.s != a.s) </span><span class="cstat-no" title="statement not covered">BigInteger.ZERO.subTo(r,r);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">381</span><span class="line-counter cline-yes">&nbsp</span><code>}</code></div>
<div class="source-line"><span class="line-number ">382</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<div class="source-line"><span class="line-number ">383</span><span class="line-counter cline-yes">&nbsp</span><code>// (protected) r = this^2, r != this (HAC 14.16)</code></div>
<div class="source-line"><span class="line-number ">384</span><span class="line-counter cline-yes">&nbsp</span><code>function bnpSquareTo(r) {</code></div>
<div class="source-line"><span class="line-number ">385</span><span class="line-counter cline-yes">&nbsp</span><code>  var x = this.abs();</code></div>
<div class="source-line"><span class="line-number ">386</span><span class="line-counter cline-yes">&nbsp</span><code>  var i = r.t = 2*x.t;</code></div>
<mark class="issue-line"><div class="source-line"><span class="line-number ">387</span><span class="line-counter cline-yes">&nbsp</span><code>  while(--i &gt;= 0) r.data[i] = 0;</code></div>
</mark><details class="issue-inline-message issue-critical issue-branch target-RSASIGN">
                        <summary>💥&nbsp;<i>RSASIGN</i> Secret-dependent branch</summary>
                <div class="issue-description">[RSASIGN] Found vulnerable jump instruction, leakage score 100.00% +/- 0%.</div>
            </details><div class="source-line"><span class="line-number ">388</span><span class="line-counter cline-yes">&nbsp</span><code>  for(i = 0; i &lt; x.t-1; ++i) {</code></div>
<div class="source-line"><span class="line-number ">389</span><span class="line-counter cline-yes">&nbsp</span><code>    var c = x.am(i,x.data[i],r,2*i,0,1);</code></div>
<mark class="issue-line"><div class="source-line"><span class="line-number ">390</span><span class="line-counter cline-yes">&nbsp</span><code>    if((r.data[i+x.t]+=x.am(i+1,2*x.data[i],r,2*i+1,c,x.t-i-1)) &gt;= x.DV) {</code></div>
</mark><details class="issue-inline-message issue-critical issue-branch target-RSASIGN">
                        <summary>💥&nbsp;<i>RSASIGN</i> Secret-dependent branch</summary>
                <div class="issue-description">[RSASIGN] Found vulnerable jump instruction, leakage score 100.00% +/- 0%.</div>
            </details><div class="source-line"><span class="line-number ">391</span><span class="line-counter cline-yes">&nbsp</span><code>      r.data[i+x.t] -= x.DV;</code></div>
<div class="source-line"><span class="line-number ">392</span><span class="line-counter cline-yes">&nbsp</span><code>      r.data[i+x.t+1] = 1;</code></div>
<div class="source-line"><span class="line-number ">393</span><span class="line-counter cline-yes">&nbsp</span><code>    }</code></div>
<div class="source-line"><span class="line-number ">394</span><span class="line-counter cline-yes">&nbsp</span><code>  }</code></div>
<div class="source-line"><span class="line-number ">395</span><span class="line-counter cline-yes">&nbsp</span><code>  if(r.t &gt; 0) r.data[r.t-1] += x.am(i,x.data[i],r,2*i,0,1);</code></div>
<div class="source-line"><span class="line-number ">396</span><span class="line-counter cline-yes">&nbsp</span><code>  r.s = 0;</code></div>
<div class="source-line"><span class="line-number ">397</span><span class="line-counter cline-yes">&nbsp</span><code>  r.clamp();</code></div>
<div class="source-line"><span class="line-number ">398</span><span class="line-counter cline-yes">&nbsp</span><code>}</code></div>
<div class="source-line"><span class="line-number ">399</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<div class="source-line"><span class="line-number ">400</span><span class="line-counter cline-yes">&nbsp</span><code>// (protected) divide this by m, quotient and remainder to q, r (HAC 14.20)</code></div>
<div class="source-line"><span class="line-number ">401</span><span class="line-counter cline-yes">&nbsp</span><code>// r != q, this != m.  q or r may be null.</code></div>
<div class="source-line"><span class="line-number ">402</span><span class="line-counter cline-yes">&nbsp</span><code>function bnpDivRemTo(m,q,r) {</code></div>
<div class="source-line"><span class="line-number ">403</span><span class="line-counter cline-yes">&nbsp</span><code>  var pm = m.abs();</code></div>
<div class="source-line"><span class="line-number ">404</span><span class="line-counter cline-no">！</span><code><span>  if(pm.t &lt;= 0) </span><span class="cstat-no" title="statement not covered">return;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">405</span><span class="line-counter cline-yes">&nbsp</span><code>  var pt = this.abs();</code></div>
<div class="source-line"><span class="line-number ">406</span><span class="line-counter cline-no">！</span><code><span>  if(pt.t &lt; pm.t) </span><span class="cstat-no" title="statement not covered">{</span><span></span></code></div>
<div class="source-line"><span class="line-number ">407</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    if(q != null) q.fromInt(0);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">408</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    if(r != null) this.copyTo(r);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">409</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    return;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">410</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  }</span><span></span></code></div>
<div class="source-line"><span class="line-number ">411</span><span class="line-counter cline-no">！</span><code><span>  if(r == null) </span><span class="cstat-no" title="statement not covered">r = nbi();</span><span></span></code></div>
<div class="source-line"><span class="line-number ">412</span><span class="line-counter cline-yes">&nbsp</span><code>  var y = nbi(), ts = this.s, ms = m.s;</code></div>
<div class="source-line"><span class="line-number ">413</span><span class="line-counter cline-yes">&nbsp</span><code>  var nsh = this.DB-nbits(pm.data[pm.t-1]);	// normalize modulus</code></div>
<div class="source-line"><span class="line-number ">414</span><span class="line-counter cline-no">！</span><code><span>  if(nsh &gt; 0) { pm.lShiftTo(nsh,y); pt.lShiftTo(nsh,r); }</span><span class="cstat-no" title="statement not covered"> else { pm.copyTo(y); pt.copyTo(r); }</span><span></span></code></div>
<div class="source-line"><span class="line-number ">415</span><span class="line-counter cline-yes">&nbsp</span><code>  var ys = y.t;</code></div>
<div class="source-line"><span class="line-number ">416</span><span class="line-counter cline-yes">&nbsp</span><code>  var y0 = y.data[ys-1];</code></div>
<div class="source-line"><span class="line-number ">417</span><span class="line-counter cline-no">！</span><code><span>  if(y0 == 0) </span><span class="cstat-no" title="statement not covered">return;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">418</span><span class="line-counter cline-no">！</span><code><span>  var yt = y0*(1&lt;&lt;this.F1)+((ys&gt;1)?y.data[ys-2]&gt;&gt;this.F2</span><span class="cstat-no" title="statement not covered">:0</span><span>);</span></code></div>
<div class="source-line"><span class="line-number ">419</span><span class="line-counter cline-yes">&nbsp</span><code>  var d1 = this.FV/yt, d2 = (1&lt;&lt;this.F1)/yt, e = 1&lt;&lt;this.F2;</code></div>
<div class="source-line"><span class="line-number ">420</span><span class="line-counter cline-no">！</span><code><span>  var i = r.t, j = i-ys, t = (q==null)?nbi()</span><span class="cstat-no" title="statement not covered">:q</span><span>;</span></code></div>
<div class="source-line"><span class="line-number ">421</span><span class="line-counter cline-yes">&nbsp</span><code>  y.dlShiftTo(j,t);</code></div>
<div class="source-line"><span class="line-number ">422</span><span class="line-counter cline-no">！</span><code><span>  if(r.compareTo(t) &gt;= 0) </span><span class="cstat-no" title="statement not covered">{</span><span></span></code></div>
<div class="source-line"><span class="line-number ">423</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    r.data[r.t++] = 1;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">424</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    r.subTo(t,r);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">425</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  }</span><span></span></code></div>
<div class="source-line"><span class="line-number ">426</span><span class="line-counter cline-yes">&nbsp</span><code>  BigInteger.ONE.dlShiftTo(ys,t);</code></div>
<div class="source-line"><span class="line-number ">427</span><span class="line-counter cline-yes">&nbsp</span><code>  t.subTo(y,y);	// &quot;negative&quot; y so we can replace sub with am later</code></div>
<div class="source-line"><span class="line-number ">428</span><span class="line-counter cline-no">！</span><code><span>  while(y.t &lt; ys) </span><span class="cstat-no" title="statement not covered">y.data[y.t++] = 0;</span><span></span></code></div>
<mark class="issue-line"><div class="source-line"><span class="line-number ">429</span><span class="line-counter cline-yes">&nbsp</span><code>  while(--j &gt;= 0) {</code></div>
</mark><details class="issue-inline-message issue-critical issue-branch target-RSASIGN">
                        <summary>💥&nbsp;<i>RSASIGN</i> Secret-dependent branch</summary>
                <div class="issue-description">[RSASIGN] Found vulnerable jump instruction, leakage score 100.00% +/- 0%.</div>
            </details><div class="source-line"><span class="line-number ">430</span><span class="line-counter cline-yes">&nbsp</span><code>    // Estimate quotient digit</code></div>
<div class="source-line"><span class="line-number ">431</span><span class="line-counter cline-no">！</span><code><span>    var qd = (r.data[--i]==y0)</span><span class="cstat-no" title="statement not covered">?this.DM</span><span>:Math.floor(r.data[i]*d1+(r.data[i-1]+e)*d2);</span></code></div>
<div class="source-line"><span class="line-number ">432</span><span class="line-counter cline-no">！</span><code><span>    if((r.data[i]+=y.am(0,qd,r,j,0,ys)) &lt; qd) </span><span class="cstat-no" title="statement not covered">{	// Try it out</span><span></span></code></div>
<div class="source-line"><span class="line-number ">433</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">      y.dlShiftTo(j,t);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">434</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">      r.subTo(t,r);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">435</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">      while(r.data[i] &lt; --qd) r.subTo(t,r);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">436</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    }</span><span></span></code></div>
<div class="source-line"><span class="line-number ">437</span><span class="line-counter cline-yes">&nbsp</span><code>  }</code></div>
<div class="source-line"><span class="line-number ">438</span><span class="line-counter cline-no">！</span><code><span>  if(q != null) </span><span class="cstat-no" title="statement not covered">{</span><span></span></code></div>
<div class="source-line"><span class="line-number ">439</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    r.drShiftTo(ys,q);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">440</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    if(ts != ms) BigInteger.ZERO.subTo(q,q);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">441</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  }</span><span></span></code></div>
<div class="source-line"><span class="line-number ">442</span><span class="line-counter cline-yes">&nbsp</span><code>  r.t = ys;</code></div>
<div class="source-line"><span class="line-number ">443</span><span class="line-counter cline-yes">&nbsp</span><code>  r.clamp();</code></div>
<div class="source-line"><span class="line-number ">444</span><span class="line-counter cline-yes">&nbsp</span><code>  if(nsh &gt; 0) r.rShiftTo(nsh,r);	// Denormalize remainder</code></div>
<div class="source-line"><span class="line-number ">445</span><span class="line-counter cline-no">！</span><code><span>  if(ts &lt; 0) </span><span class="cstat-no" title="statement not covered">BigInteger.ZERO.subTo(r,r);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">446</span><span class="line-counter cline-yes">&nbsp</span><code>}</code></div>
<div class="source-line"><span class="line-number ">447</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<div class="source-line"><span class="line-number ">448</span><span class="line-counter cline-yes">&nbsp</span><code>// (public) this mod a</code></div>
<div class="source-line"><span class="line-number ">449</span><span class="line-counter cline-yes">&nbsp</span><code>function bnMod(a) {</code></div>
<div class="source-line"><span class="line-number ">450</span><span class="line-counter cline-yes">&nbsp</span><code>  var r = nbi();</code></div>
<div class="source-line"><span class="line-number ">451</span><span class="line-counter cline-yes">&nbsp</span><code>  this.abs().divRemTo(a,null,r);</code></div>
<div class="source-line"><span class="line-number ">452</span><span class="line-counter cline-no">！</span><code><span>  if(this.s &lt; 0 </span><span class="cstat-no" title="statement not covered">&amp;&amp; r.compareTo(BigInteger.ZERO) &gt; 0</span><span>) a.subTo(r,r);</span></code></div>
<div class="source-line"><span class="line-number ">453</span><span class="line-counter cline-yes">&nbsp</span><code>  return r;</code></div>
<div class="source-line"><span class="line-number ">454</span><span class="line-counter cline-yes">&nbsp</span><code>}</code></div>
<div class="source-line"><span class="line-number ">455</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<div class="source-line"><span class="line-number ">456</span><span class="line-counter cline-yes">&nbsp</span><code>// Modular reduction using &quot;classic&quot; algorithm</code></div>
<div class="source-line"><span class="line-number ">457</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">function Classic(m) { this.m = m; }</span><span></span></code></div>
<div class="source-line"><span class="line-number ">458</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">function cConvert(x) {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">459</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  if(x.s &lt; 0 || x.compareTo(this.m) &gt;= 0) return x.mod(this.m);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">460</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  else return x;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">461</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">}</span><span></span></code></div>
<div class="source-line"><span class="line-number ">462</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">function cRevert(x) { return x; }</span><span></span></code></div>
<div class="source-line"><span class="line-number ">463</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">function cReduce(x) { x.divRemTo(this.m,null,x); }</span><span></span></code></div>
<div class="source-line"><span class="line-number ">464</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">function cMulTo(x,y,r) { x.multiplyTo(y,r); this.reduce(r); }</span><span></span></code></div>
<div class="source-line"><span class="line-number ">465</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">function cSqrTo(x,r) { x.squareTo(r); this.reduce(r); }</span><span></span></code></div>
<div class="source-line"><span class="line-number ">466</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<div class="source-line"><span class="line-number ">467</span><span class="line-counter cline-yes">&nbsp</span><code>Classic.prototype.convert = cConvert;</code></div>
<div class="source-line"><span class="line-number ">468</span><span class="line-counter cline-yes">&nbsp</span><code>Classic.prototype.revert = cRevert;</code></div>
<div class="source-line"><span class="line-number ">469</span><span class="line-counter cline-yes">&nbsp</span><code>Classic.prototype.reduce = cReduce;</code></div>
<div class="source-line"><span class="line-number ">470</span><span class="line-counter cline-yes">&nbsp</span><code>Classic.prototype.mulTo = cMulTo;</code></div>
<div class="source-line"><span class="line-number ">471</span><span class="line-counter cline-yes">&nbsp</span><code>Classic.prototype.sqrTo = cSqrTo;</code></div>
<div class="source-line"><span class="line-number ">472</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<div class="source-line"><span class="line-number ">473</span><span class="line-counter cline-yes">&nbsp</span><code>// (protected) return &quot;-1/this % 2^DB&quot;; useful for Mont. reduction</code></div>
<div class="source-line"><span class="line-number ">474</span><span class="line-counter cline-yes">&nbsp</span><code>// justification:</code></div>
<div class="source-line"><span class="line-number ">475</span><span class="line-counter cline-yes">&nbsp</span><code>//         xy == 1 (mod m)</code></div>
<div class="source-line"><span class="line-number ">476</span><span class="line-counter cline-yes">&nbsp</span><code>//         xy =  1+km</code></div>
<div class="source-line"><span class="line-number ">477</span><span class="line-counter cline-yes">&nbsp</span><code>//   xy(2-xy) = (1+km)(1-km)</code></div>
<div class="source-line"><span class="line-number ">478</span><span class="line-counter cline-yes">&nbsp</span><code>// x[y(2-xy)] = 1-k^2m^2</code></div>
<div class="source-line"><span class="line-number ">479</span><span class="line-counter cline-yes">&nbsp</span><code>// x[y(2-xy)] == 1 (mod m^2)</code></div>
<div class="source-line"><span class="line-number ">480</span><span class="line-counter cline-yes">&nbsp</span><code>// if y is 1/x mod m, then y(2-xy) is 1/x mod m^2</code></div>
<div class="source-line"><span class="line-number ">481</span><span class="line-counter cline-yes">&nbsp</span><code>// should reduce x and y(2-xy) by m^2 at each step to keep size bounded.</code></div>
<div class="source-line"><span class="line-number ">482</span><span class="line-counter cline-yes">&nbsp</span><code>// JS multiply &quot;overflows&quot; differently from C/C++, so care is needed here.</code></div>
<div class="source-line"><span class="line-number ">483</span><span class="line-counter cline-yes">&nbsp</span><code>function bnpInvDigit() {</code></div>
<div class="source-line"><span class="line-number ">484</span><span class="line-counter cline-no">！</span><code><span>  if(this.t &lt; 1) </span><span class="cstat-no" title="statement not covered">return 0;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">485</span><span class="line-counter cline-yes">&nbsp</span><code>  var x = this.data[0];</code></div>
<div class="source-line"><span class="line-number ">486</span><span class="line-counter cline-no">！</span><code><span>  if((x&amp;1) == 0) </span><span class="cstat-no" title="statement not covered">return 0;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">487</span><span class="line-counter cline-yes">&nbsp</span><code>  var y = x&amp;3;		// y == 1/x mod 2^2</code></div>
<div class="source-line"><span class="line-number ">488</span><span class="line-counter cline-yes">&nbsp</span><code>  y = (y*(2-(x&amp;0xf)*y))&amp;0xf;	// y == 1/x mod 2^4</code></div>
<div class="source-line"><span class="line-number ">489</span><span class="line-counter cline-yes">&nbsp</span><code>  y = (y*(2-(x&amp;0xff)*y))&amp;0xff;	// y == 1/x mod 2^8</code></div>
<div class="source-line"><span class="line-number ">490</span><span class="line-counter cline-yes">&nbsp</span><code>  y = (y*(2-(((x&amp;0xffff)*y)&amp;0xffff)))&amp;0xffff;	// y == 1/x mod 2^16</code></div>
<div class="source-line"><span class="line-number ">491</span><span class="line-counter cline-yes">&nbsp</span><code>  // last step - calculate inverse mod DV directly;</code></div>
<div class="source-line"><span class="line-number ">492</span><span class="line-counter cline-yes">&nbsp</span><code>  // assumes 16 &lt; DB &lt;= 32 and assumes ability to handle 48-bit ints</code></div>
<div class="source-line"><span class="line-number ">493</span><span class="line-counter cline-yes">&nbsp</span><code>  y = (y*(2-x*y%this.DV))%this.DV;		// y == 1/x mod 2^dbits</code></div>
<div class="source-line"><span class="line-number ">494</span><span class="line-counter cline-yes">&nbsp</span><code>  // we really want the negative inverse, and -DV &lt; y &lt; DV</code></div>
<div class="source-line"><span class="line-number ">495</span><span class="line-counter cline-no">！</span><code><span>  return (y&gt;0)</span><span class="cstat-no" title="statement not covered">?this.DV-y</span><span>:-y;</span></code></div>
<div class="source-line"><span class="line-number ">496</span><span class="line-counter cline-yes">&nbsp</span><code>}</code></div>
<div class="source-line"><span class="line-number ">497</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<div class="source-line"><span class="line-number ">498</span><span class="line-counter cline-yes">&nbsp</span><code>// Montgomery reduction</code></div>
<div class="source-line"><span class="line-number ">499</span><span class="line-counter cline-yes">&nbsp</span><code>function Montgomery(m) {</code></div>
<div class="source-line"><span class="line-number ">500</span><span class="line-counter cline-yes">&nbsp</span><code>  this.m = m;</code></div>
<div class="source-line"><span class="line-number ">501</span><span class="line-counter cline-yes">&nbsp</span><code>  this.mp = m.invDigit();</code></div>
<div class="source-line"><span class="line-number ">502</span><span class="line-counter cline-yes">&nbsp</span><code>  this.mpl = this.mp&amp;0x7fff;</code></div>
<div class="source-line"><span class="line-number ">503</span><span class="line-counter cline-yes">&nbsp</span><code>  this.mph = this.mp&gt;&gt;15;</code></div>
<div class="source-line"><span class="line-number ">504</span><span class="line-counter cline-yes">&nbsp</span><code>  this.um = (1&lt;&lt;(m.DB-15))-1;</code></div>
<div class="source-line"><span class="line-number ">505</span><span class="line-counter cline-yes">&nbsp</span><code>  this.mt2 = 2*m.t;</code></div>
<div class="source-line"><span class="line-number ">506</span><span class="line-counter cline-yes">&nbsp</span><code>}</code></div>
<div class="source-line"><span class="line-number ">507</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<div class="source-line"><span class="line-number ">508</span><span class="line-counter cline-yes">&nbsp</span><code>// xR mod m</code></div>
<div class="source-line"><span class="line-number ">509</span><span class="line-counter cline-yes">&nbsp</span><code>function montConvert(x) {</code></div>
<div class="source-line"><span class="line-number ">510</span><span class="line-counter cline-yes">&nbsp</span><code>  var r = nbi();</code></div>
<div class="source-line"><span class="line-number ">511</span><span class="line-counter cline-yes">&nbsp</span><code>  x.abs().dlShiftTo(this.m.t,r);</code></div>
<div class="source-line"><span class="line-number ">512</span><span class="line-counter cline-yes">&nbsp</span><code>  r.divRemTo(this.m,null,r);</code></div>
<div class="source-line"><span class="line-number ">513</span><span class="line-counter cline-no">！</span><code><span>  if(x.s &lt; 0 </span><span class="cstat-no" title="statement not covered">&amp;&amp; r.compareTo(BigInteger.ZERO) &gt; 0</span><span>) this.m.subTo(r,r);</span></code></div>
<div class="source-line"><span class="line-number ">514</span><span class="line-counter cline-yes">&nbsp</span><code>  return r;</code></div>
<div class="source-line"><span class="line-number ">515</span><span class="line-counter cline-yes">&nbsp</span><code>}</code></div>
<div class="source-line"><span class="line-number ">516</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<div class="source-line"><span class="line-number ">517</span><span class="line-counter cline-yes">&nbsp</span><code>// x/R mod m</code></div>
<div class="source-line"><span class="line-number ">518</span><span class="line-counter cline-yes">&nbsp</span><code>function montRevert(x) {</code></div>
<div class="source-line"><span class="line-number ">519</span><span class="line-counter cline-yes">&nbsp</span><code>  var r = nbi();</code></div>
<div class="source-line"><span class="line-number ">520</span><span class="line-counter cline-yes">&nbsp</span><code>  x.copyTo(r);</code></div>
<div class="source-line"><span class="line-number ">521</span><span class="line-counter cline-yes">&nbsp</span><code>  this.reduce(r);</code></div>
<div class="source-line"><span class="line-number ">522</span><span class="line-counter cline-yes">&nbsp</span><code>  return r;</code></div>
<div class="source-line"><span class="line-number ">523</span><span class="line-counter cline-yes">&nbsp</span><code>}</code></div>
<div class="source-line"><span class="line-number ">524</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<div class="source-line"><span class="line-number ">525</span><span class="line-counter cline-yes">&nbsp</span><code>// x = x/R mod m (HAC 14.32)</code></div>
<div class="source-line"><span class="line-number ">526</span><span class="line-counter cline-yes">&nbsp</span><code>function montReduce(x) {</code></div>
<mark class="issue-line"><div class="source-line"><span class="line-number ">527</span><span class="line-counter cline-yes">&nbsp</span><code>  while(x.t &lt;= this.mt2)	// pad x so am has enough room later</code></div>
</mark><details class="issue-inline-message issue-critical issue-branch target-RSASIGN">
                        <summary>💥&nbsp;<i>RSASIGN</i> Secret-dependent branch</summary>
                <div class="issue-description">[RSASIGN] Found vulnerable jump instruction, leakage score 100.00% +/- 0%.</div>
            </details><mark class="issue-line"><div class="source-line"><span class="line-number ">528</span><span class="line-counter cline-yes">&nbsp</span><code>    x.data[x.t++] = 0;</code></div>
</mark><details class="issue-inline-message issue-critical issue-memory-access target-RSASIGN">
                        <summary>💥&nbsp;<i>RSASIGN</i> Secret-dependent memory access</summary>
                <div class="issue-description">[RSASIGN] Found vulnerable memory access instruction, leakage score 100.00% +/- 0%.</div>
            </details><div class="source-line"><span class="line-number ">529</span><span class="line-counter cline-yes">&nbsp</span><code>  for(var i = 0; i &lt; this.m.t; ++i) {</code></div>
<div class="source-line"><span class="line-number ">530</span><span class="line-counter cline-yes">&nbsp</span><code>    // faster way of calculating u0 = x.data[i]*mp mod DV</code></div>
<div class="source-line"><span class="line-number ">531</span><span class="line-counter cline-yes">&nbsp</span><code>    var j = x.data[i]&amp;0x7fff;</code></div>
<div class="source-line"><span class="line-number ">532</span><span class="line-counter cline-yes">&nbsp</span><code>    var u0 = (j*this.mpl+(((j*this.mph+(x.data[i]&gt;&gt;15)*this.mpl)&amp;this.um)&lt;&lt;15))&amp;x.DM;</code></div>
<div class="source-line"><span class="line-number ">533</span><span class="line-counter cline-yes">&nbsp</span><code>    // use am to combine the multiply-shift-add into one call</code></div>
<div class="source-line"><span class="line-number ">534</span><span class="line-counter cline-yes">&nbsp</span><code>    j = i+this.m.t;</code></div>
<div class="source-line"><span class="line-number ">535</span><span class="line-counter cline-yes">&nbsp</span><code>    x.data[j] += this.m.am(0,u0,x,i,0,this.m.t);</code></div>
<div class="source-line"><span class="line-number ">536</span><span class="line-counter cline-yes">&nbsp</span><code>    // propagate carry</code></div>
<div class="source-line"><span class="line-number ">537</span><span class="line-counter cline-no">！</span><code><span>    while(x.data[j] &gt;= x.DV) </span><span class="cstat-no" title="statement not covered">{ x.data[j] -= x.DV; x.data[++j]++; }</span><span></span></code></div>
<div class="source-line"><span class="line-number ">538</span><span class="line-counter cline-yes">&nbsp</span><code>  }</code></div>
<div class="source-line"><span class="line-number ">539</span><span class="line-counter cline-yes">&nbsp</span><code>  x.clamp();</code></div>
<div class="source-line"><span class="line-number ">540</span><span class="line-counter cline-yes">&nbsp</span><code>  x.drShiftTo(this.m.t,x);</code></div>
<div class="source-line"><span class="line-number ">541</span><span class="line-counter cline-no">！</span><code><span>  if(x.compareTo(this.m) &gt;= 0) </span><span class="cstat-no" title="statement not covered">x.subTo(this.m,x);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">542</span><span class="line-counter cline-yes">&nbsp</span><code>}</code></div>
<div class="source-line"><span class="line-number ">543</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<div class="source-line"><span class="line-number ">544</span><span class="line-counter cline-yes">&nbsp</span><code>// r = &quot;x^2/R mod m&quot;; x != r</code></div>
<div class="source-line"><span class="line-number ">545</span><span class="line-counter cline-yes">&nbsp</span><code>function montSqrTo(x,r) { x.squareTo(r); this.reduce(r); }</code></div>
<div class="source-line"><span class="line-number ">546</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<div class="source-line"><span class="line-number ">547</span><span class="line-counter cline-yes">&nbsp</span><code>// r = &quot;xy/R mod m&quot;; x,y != r</code></div>
<div class="source-line"><span class="line-number ">548</span><span class="line-counter cline-yes">&nbsp</span><code>function montMulTo(x,y,r) { x.multiplyTo(y,r); this.reduce(r); }</code></div>
<div class="source-line"><span class="line-number ">549</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<div class="source-line"><span class="line-number ">550</span><span class="line-counter cline-yes">&nbsp</span><code>Montgomery.prototype.convert = montConvert;</code></div>
<div class="source-line"><span class="line-number ">551</span><span class="line-counter cline-yes">&nbsp</span><code>Montgomery.prototype.revert = montRevert;</code></div>
<div class="source-line"><span class="line-number ">552</span><span class="line-counter cline-yes">&nbsp</span><code>Montgomery.prototype.reduce = montReduce;</code></div>
<div class="source-line"><span class="line-number ">553</span><span class="line-counter cline-yes">&nbsp</span><code>Montgomery.prototype.mulTo = montMulTo;</code></div>
<div class="source-line"><span class="line-number ">554</span><span class="line-counter cline-yes">&nbsp</span><code>Montgomery.prototype.sqrTo = montSqrTo;</code></div>
<div class="source-line"><span class="line-number ">555</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<div class="source-line"><span class="line-number ">556</span><span class="line-counter cline-yes">&nbsp</span><code>// (protected) true iff this is even</code></div>
<div class="source-line"><span class="line-number ">557</span><span class="line-counter cline-no">！</span><code><span>function bnpIsEven() { return ((this.t&gt;0)?(this.data[0]&amp;1)</span><span class="cstat-no" title="statement not covered">:this.s</span><span>) == 0; }</span></code></div>
<div class="source-line"><span class="line-number ">558</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<div class="source-line"><span class="line-number ">559</span><span class="line-counter cline-yes">&nbsp</span><code>// (protected) this^e, e &lt; 2^32, doing sqr and mul with &quot;r&quot; (HAC 14.79)</code></div>
<div class="source-line"><span class="line-number ">560</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">function bnpExp(e,z) {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">561</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  if(e &gt; 0xffffffff || e &lt; 1) return BigInteger.ONE;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">562</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  var r = nbi(), r2 = nbi(), g = z.convert(this), i = nbits(e)-1;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">563</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  g.copyTo(r);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">564</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  while(--i &gt;= 0) {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">565</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    z.sqrTo(r,r2);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">566</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    if((e&amp;(1&lt;&lt;i)) &gt; 0) z.mulTo(r2,g,r);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">567</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    else { var t = r; r = r2; r2 = t; }</span><span></span></code></div>
<div class="source-line"><span class="line-number ">568</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  }</span><span></span></code></div>
<div class="source-line"><span class="line-number ">569</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  return z.revert(r);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">570</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">}</span><span></span></code></div>
<div class="source-line"><span class="line-number ">571</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<div class="source-line"><span class="line-number ">572</span><span class="line-counter cline-yes">&nbsp</span><code>// (public) this^e % m, 0 &lt;= e &lt; 2^32</code></div>
<div class="source-line"><span class="line-number ">573</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">function bnModPowInt(e,m) {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">574</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  var z;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">575</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  if(e &lt; 256 || m.isEven()) z = new Classic(m); else z = new Montgomery(m);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">576</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  return this.exp(e,z);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">577</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">}</span><span></span></code></div>
<div class="source-line"><span class="line-number ">578</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<div class="source-line"><span class="line-number ">579</span><span class="line-counter cline-yes">&nbsp</span><code>// protected</code></div>
<div class="source-line"><span class="line-number ">580</span><span class="line-counter cline-yes">&nbsp</span><code>BigInteger.prototype.copyTo = bnpCopyTo;</code></div>
<div class="source-line"><span class="line-number ">581</span><span class="line-counter cline-yes">&nbsp</span><code>BigInteger.prototype.fromInt = bnpFromInt;</code></div>
<div class="source-line"><span class="line-number ">582</span><span class="line-counter cline-yes">&nbsp</span><code>BigInteger.prototype.fromString = bnpFromString;</code></div>
<div class="source-line"><span class="line-number ">583</span><span class="line-counter cline-yes">&nbsp</span><code>BigInteger.prototype.clamp = bnpClamp;</code></div>
<div class="source-line"><span class="line-number ">584</span><span class="line-counter cline-yes">&nbsp</span><code>BigInteger.prototype.dlShiftTo = bnpDLShiftTo;</code></div>
<div class="source-line"><span class="line-number ">585</span><span class="line-counter cline-yes">&nbsp</span><code>BigInteger.prototype.drShiftTo = bnpDRShiftTo;</code></div>
<div class="source-line"><span class="line-number ">586</span><span class="line-counter cline-yes">&nbsp</span><code>BigInteger.prototype.lShiftTo = bnpLShiftTo;</code></div>
<div class="source-line"><span class="line-number ">587</span><span class="line-counter cline-yes">&nbsp</span><code>BigInteger.prototype.rShiftTo = bnpRShiftTo;</code></div>
<div class="source-line"><span class="line-number ">588</span><span class="line-counter cline-yes">&nbsp</span><code>BigInteger.prototype.subTo = bnpSubTo;</code></div>
<div class="source-line"><span class="line-number ">589</span><span class="line-counter cline-yes">&nbsp</span><code>BigInteger.prototype.multiplyTo = bnpMultiplyTo;</code></div>
<div class="source-line"><span class="line-number ">590</span><span class="line-counter cline-yes">&nbsp</span><code>BigInteger.prototype.squareTo = bnpSquareTo;</code></div>
<div class="source-line"><span class="line-number ">591</span><span class="line-counter cline-yes">&nbsp</span><code>BigInteger.prototype.divRemTo = bnpDivRemTo;</code></div>
<div class="source-line"><span class="line-number ">592</span><span class="line-counter cline-yes">&nbsp</span><code>BigInteger.prototype.invDigit = bnpInvDigit;</code></div>
<div class="source-line"><span class="line-number ">593</span><span class="line-counter cline-yes">&nbsp</span><code>BigInteger.prototype.isEven = bnpIsEven;</code></div>
<div class="source-line"><span class="line-number ">594</span><span class="line-counter cline-yes">&nbsp</span><code>BigInteger.prototype.exp = bnpExp;</code></div>
<div class="source-line"><span class="line-number ">595</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<div class="source-line"><span class="line-number ">596</span><span class="line-counter cline-yes">&nbsp</span><code>// public</code></div>
<div class="source-line"><span class="line-number ">597</span><span class="line-counter cline-yes">&nbsp</span><code>BigInteger.prototype.toString = bnToString;</code></div>
<div class="source-line"><span class="line-number ">598</span><span class="line-counter cline-yes">&nbsp</span><code>BigInteger.prototype.negate = bnNegate;</code></div>
<div class="source-line"><span class="line-number ">599</span><span class="line-counter cline-yes">&nbsp</span><code>BigInteger.prototype.abs = bnAbs;</code></div>
<div class="source-line"><span class="line-number ">600</span><span class="line-counter cline-yes">&nbsp</span><code>BigInteger.prototype.compareTo = bnCompareTo;</code></div>
<div class="source-line"><span class="line-number ">601</span><span class="line-counter cline-yes">&nbsp</span><code>BigInteger.prototype.bitLength = bnBitLength;</code></div>
<div class="source-line"><span class="line-number ">602</span><span class="line-counter cline-yes">&nbsp</span><code>BigInteger.prototype.mod = bnMod;</code></div>
<div class="source-line"><span class="line-number ">603</span><span class="line-counter cline-yes">&nbsp</span><code>BigInteger.prototype.modPowInt = bnModPowInt;</code></div>
<div class="source-line"><span class="line-number ">604</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<div class="source-line"><span class="line-number ">605</span><span class="line-counter cline-yes">&nbsp</span><code>// &quot;constants&quot;</code></div>
<div class="source-line"><span class="line-number ">606</span><span class="line-counter cline-yes">&nbsp</span><code>BigInteger.ZERO = nbv(0);</code></div>
<div class="source-line"><span class="line-number ">607</span><span class="line-counter cline-yes">&nbsp</span><code>BigInteger.ONE = nbv(1);</code></div>
<div class="source-line"><span class="line-number ">608</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<div class="source-line"><span class="line-number ">609</span><span class="line-counter cline-yes">&nbsp</span><code>// jsbn2 lib</code></div>
<div class="source-line"><span class="line-number ">610</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<div class="source-line"><span class="line-number ">611</span><span class="line-counter cline-yes">&nbsp</span><code>//Copyright (c) 2005-2009  Tom Wu</code></div>
<div class="source-line"><span class="line-number ">612</span><span class="line-counter cline-yes">&nbsp</span><code>//All Rights Reserved.</code></div>
<div class="source-line"><span class="line-number ">613</span><span class="line-counter cline-yes">&nbsp</span><code>//See &quot;LICENSE&quot; for details (See jsbn.js for LICENSE).</code></div>
<div class="source-line"><span class="line-number ">614</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<div class="source-line"><span class="line-number ">615</span><span class="line-counter cline-yes">&nbsp</span><code>//Extended JavaScript BN functions, required for RSA private ops.</code></div>
<div class="source-line"><span class="line-number ">616</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<div class="source-line"><span class="line-number ">617</span><span class="line-counter cline-yes">&nbsp</span><code>//Version 1.1: new BigInteger(&quot;0&quot;, 10) returns &quot;proper&quot; zero</code></div>
<div class="source-line"><span class="line-number ">618</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<div class="source-line"><span class="line-number ">619</span><span class="line-counter cline-yes">&nbsp</span><code>//(public)</code></div>
<div class="source-line"><span class="line-number ">620</span><span class="line-counter cline-yes">&nbsp</span><code>function bnClone() { var r = nbi(); this.copyTo(r); return r; }</code></div>
<div class="source-line"><span class="line-number ">621</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<div class="source-line"><span class="line-number ">622</span><span class="line-counter cline-yes">&nbsp</span><code>//(public) return value as integer</code></div>
<div class="source-line"><span class="line-number ">623</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">function bnIntValue() {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">624</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">if(this.s &lt; 0) {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">625</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered"> if(this.t == 1) return this.data[0]-this.DV;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">626</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered"> else if(this.t == 0) return -1;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">627</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">} else if(this.t == 1) return this.data[0];</span><span></span></code></div>
<div class="source-line"><span class="line-number ">628</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">else if(this.t == 0) return 0;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">629</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">// assumes 16 &lt; DB &lt; 32</span><span></span></code></div>
<div class="source-line"><span class="line-number ">630</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">return ((this.data[1]&amp;((1&lt;&lt;(32-this.DB))-1))&lt;&lt;this.DB)|this.data[0];</span><span></span></code></div>
<div class="source-line"><span class="line-number ">631</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">}</span><span></span></code></div>
<div class="source-line"><span class="line-number ">632</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<div class="source-line"><span class="line-number ">633</span><span class="line-counter cline-yes">&nbsp</span><code>//(public) return value as byte</code></div>
<div class="source-line"><span class="line-number ">634</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">function bnByteValue() { return (this.t==0)?this.s:(this.data[0]&lt;&lt;24)&gt;&gt;24; }</span><span></span></code></div>
<div class="source-line"><span class="line-number ">635</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<div class="source-line"><span class="line-number ">636</span><span class="line-counter cline-yes">&nbsp</span><code>//(public) return value as short (assumes DB&gt;=16)</code></div>
<div class="source-line"><span class="line-number ">637</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">function bnShortValue() { return (this.t==0)?this.s:(this.data[0]&lt;&lt;16)&gt;&gt;16; }</span><span></span></code></div>
<div class="source-line"><span class="line-number ">638</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<div class="source-line"><span class="line-number ">639</span><span class="line-counter cline-yes">&nbsp</span><code>//(protected) return x s.t. r^x &lt; DV</code></div>
<div class="source-line"><span class="line-number ">640</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">function bnpChunkSize(r) { return Math.floor(Math.LN2*this.DB/Math.log(r)); }</span><span></span></code></div>
<div class="source-line"><span class="line-number ">641</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<div class="source-line"><span class="line-number ">642</span><span class="line-counter cline-yes">&nbsp</span><code>//(public) 0 if this == 0, 1 if this &gt; 0</code></div>
<div class="source-line"><span class="line-number ">643</span><span class="line-counter cline-yes">&nbsp</span><code>function bnSigNum() {</code></div>
<div class="source-line"><span class="line-number ">644</span><span class="line-counter cline-yes">&nbsp</span><code>if(this.s &lt; 0) return -1;</code></div>
<div class="source-line"><span class="line-number ">645</span><span class="line-counter cline-yes">&nbsp</span><code>else if(this.t &lt;= 0 || (this.t == 1 &amp;&amp; this.data[0] &lt;= 0)) return 0;</code></div>
<div class="source-line"><span class="line-number ">646</span><span class="line-counter cline-yes">&nbsp</span><code>else return 1;</code></div>
<div class="source-line"><span class="line-number ">647</span><span class="line-counter cline-yes">&nbsp</span><code>}</code></div>
<div class="source-line"><span class="line-number ">648</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<div class="source-line"><span class="line-number ">649</span><span class="line-counter cline-yes">&nbsp</span><code>//(protected) convert to radix string</code></div>
<div class="source-line"><span class="line-number ">650</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">function bnpToRadix(b) {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">651</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">if(b == null) b = 10;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">652</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">if(this.signum() == 0 || b &lt; 2 || b &gt; 36) return &quot;0&quot;;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">653</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">var cs = this.chunkSize(b);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">654</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">var a = Math.pow(b,cs);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">655</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">var d = nbv(a), y = nbi(), z = nbi(), r = &quot;&quot;;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">656</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">this.divRemTo(d,y,z);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">657</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">while(y.signum() &gt; 0) {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">658</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered"> r = (a+z.intValue()).toString(b).substr(1) + r;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">659</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered"> y.divRemTo(d,y,z);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">660</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">}</span><span></span></code></div>
<div class="source-line"><span class="line-number ">661</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">return z.intValue().toString(b) + r;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">662</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">}</span><span></span></code></div>
<div class="source-line"><span class="line-number ">663</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<div class="source-line"><span class="line-number ">664</span><span class="line-counter cline-yes">&nbsp</span><code>//(protected) convert from radix string</code></div>
<div class="source-line"><span class="line-number ">665</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">function bnpFromRadix(s,b) {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">666</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">this.fromInt(0);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">667</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">if(b == null) b = 10;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">668</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">var cs = this.chunkSize(b);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">669</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">var d = Math.pow(b,cs), mi = false, j = 0, w = 0;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">670</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">for(var i = 0; i &lt; s.length; ++i) {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">671</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered"> var x = intAt(s,i);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">672</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered"> if(x &lt; 0) {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">673</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">   if(s.charAt(i) == &quot;-&quot; &amp;&amp; this.signum() == 0) mi = true;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">674</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">   continue;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">675</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered"> }</span><span></span></code></div>
<div class="source-line"><span class="line-number ">676</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered"> w = b*w+x;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">677</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered"> if(++j &gt;= cs) {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">678</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">   this.dMultiply(d);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">679</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">   this.dAddOffset(w,0);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">680</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">   j = 0;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">681</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">   w = 0;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">682</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered"> }</span><span></span></code></div>
<div class="source-line"><span class="line-number ">683</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">}</span><span></span></code></div>
<div class="source-line"><span class="line-number ">684</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">if(j &gt; 0) {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">685</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered"> this.dMultiply(Math.pow(b,j));</span><span></span></code></div>
<div class="source-line"><span class="line-number ">686</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered"> this.dAddOffset(w,0);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">687</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">}</span><span></span></code></div>
<div class="source-line"><span class="line-number ">688</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">if(mi) BigInteger.ZERO.subTo(this,this);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">689</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">}</span><span></span></code></div>
<div class="source-line"><span class="line-number ">690</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<div class="source-line"><span class="line-number ">691</span><span class="line-counter cline-yes">&nbsp</span><code>//(protected) alternate constructor</code></div>
<div class="source-line"><span class="line-number ">692</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">function bnpFromNumber(a,b,c) {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">693</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">if(&quot;number&quot; == typeof b) {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">694</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered"> // new BigInteger(int,int,RNG)</span><span></span></code></div>
<div class="source-line"><span class="line-number ">695</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered"> if(a &lt; 2) this.fromInt(1);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">696</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered"> else {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">697</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">   this.fromNumber(a,c);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">698</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">   if(!this.testBit(a-1))  // force MSB set</span><span></span></code></div>
<div class="source-line"><span class="line-number ">699</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">     this.bitwiseTo(BigInteger.ONE.shiftLeft(a-1),op_or,this);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">700</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">   if(this.isEven()) this.dAddOffset(1,0); // force odd</span><span></span></code></div>
<div class="source-line"><span class="line-number ">701</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">   while(!this.isProbablePrime(b)) {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">702</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">     this.dAddOffset(2,0);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">703</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">     if(this.bitLength() &gt; a) this.subTo(BigInteger.ONE.shiftLeft(a-1),this);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">704</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">   }</span><span></span></code></div>
<div class="source-line"><span class="line-number ">705</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered"> }</span><span></span></code></div>
<div class="source-line"><span class="line-number ">706</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">} else {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">707</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered"> // new BigInteger(int,RNG)</span><span></span></code></div>
<div class="source-line"><span class="line-number ">708</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered"> var x = new Array(), t = a&amp;7;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">709</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered"> x.length = (a&gt;&gt;3)+1;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">710</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered"> b.nextBytes(x);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">711</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered"> if(t &gt; 0) x[0] &amp;= ((1&lt;&lt;t)-1); else x[0] = 0;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">712</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered"> this.fromString(x,256);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">713</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">}</span><span></span></code></div>
<div class="source-line"><span class="line-number ">714</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">}</span><span></span></code></div>
<div class="source-line"><span class="line-number ">715</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<div class="source-line"><span class="line-number ">716</span><span class="line-counter cline-yes">&nbsp</span><code>//(public) convert to bigendian byte array</code></div>
<div class="source-line"><span class="line-number ">717</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">function bnToByteArray() {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">718</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">var i = this.t, r = new Array();</span><span></span></code></div>
<div class="source-line"><span class="line-number ">719</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">r[0] = this.s;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">720</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">var p = this.DB-(i*this.DB)%8, d, k = 0;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">721</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">if(i-- &gt; 0) {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">722</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered"> if(p &lt; this.DB &amp;&amp; (d = this.data[i]&gt;&gt;p) != (this.s&amp;this.DM)&gt;&gt;p)</span><span></span></code></div>
<div class="source-line"><span class="line-number ">723</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">   r[k++] = d|(this.s&lt;&lt;(this.DB-p));</span><span></span></code></div>
<div class="source-line"><span class="line-number ">724</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered"> while(i &gt;= 0) {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">725</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">   if(p &lt; 8) {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">726</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">     d = (this.data[i]&amp;((1&lt;&lt;p)-1))&lt;&lt;(8-p);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">727</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">     d |= this.data[--i]&gt;&gt;(p+=this.DB-8);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">728</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">   } else {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">729</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">     d = (this.data[i]&gt;&gt;(p-=8))&amp;0xff;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">730</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">     if(p &lt;= 0) { p += this.DB; --i; }</span><span></span></code></div>
<div class="source-line"><span class="line-number ">731</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">   }</span><span></span></code></div>
<div class="source-line"><span class="line-number ">732</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">   if((d&amp;0x80) != 0) d |= -256;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">733</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">   if(k == 0 &amp;&amp; (this.s&amp;0x80) != (d&amp;0x80)) ++k;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">734</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">   if(k &gt; 0 || d != this.s) r[k++] = d;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">735</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered"> }</span><span></span></code></div>
<div class="source-line"><span class="line-number ">736</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">}</span><span></span></code></div>
<div class="source-line"><span class="line-number ">737</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">return r;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">738</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">}</span><span></span></code></div>
<div class="source-line"><span class="line-number ">739</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<div class="source-line"><span class="line-number ">740</span><span class="line-counter cline-yes">&nbsp</span><code>function bnEquals(a) { return(this.compareTo(a)==0); }</code></div>
<div class="source-line"><span class="line-number ">741</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">function bnMin(a) { return(this.compareTo(a)&lt;0)?this:a; }</span><span></span></code></div>
<div class="source-line"><span class="line-number ">742</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">function bnMax(a) { return(this.compareTo(a)&gt;0)?this:a; }</span><span></span></code></div>
<div class="source-line"><span class="line-number ">743</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<div class="source-line"><span class="line-number ">744</span><span class="line-counter cline-yes">&nbsp</span><code>//(protected) r = this op a (bitwise)</code></div>
<div class="source-line"><span class="line-number ">745</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">function bnpBitwiseTo(a,op,r) {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">746</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">var i, f, m = Math.min(a.t,this.t);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">747</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">for(i = 0; i &lt; m; ++i) r.data[i] = op(this.data[i],a.data[i]);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">748</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">if(a.t &lt; this.t) {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">749</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered"> f = a.s&amp;this.DM;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">750</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered"> for(i = m; i &lt; this.t; ++i) r.data[i] = op(this.data[i],f);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">751</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered"> r.t = this.t;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">752</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">} else {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">753</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered"> f = this.s&amp;this.DM;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">754</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered"> for(i = m; i &lt; a.t; ++i) r.data[i] = op(f,a.data[i]);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">755</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered"> r.t = a.t;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">756</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">}</span><span></span></code></div>
<div class="source-line"><span class="line-number ">757</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">r.s = op(this.s,a.s);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">758</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">r.clamp();</span><span></span></code></div>
<div class="source-line"><span class="line-number ">759</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">}</span><span></span></code></div>
<div class="source-line"><span class="line-number ">760</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<div class="source-line"><span class="line-number ">761</span><span class="line-counter cline-yes">&nbsp</span><code>//(public) this &amp; a</code></div>
<div class="source-line"><span class="line-number ">762</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">function op_and(x,y) { return x&amp;y; }</span><span></span></code></div>
<div class="source-line"><span class="line-number ">763</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">function bnAnd(a) { var r = nbi(); this.bitwiseTo(a,op_and,r); return r; }</span><span></span></code></div>
<div class="source-line"><span class="line-number ">764</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<div class="source-line"><span class="line-number ">765</span><span class="line-counter cline-yes">&nbsp</span><code>//(public) this | a</code></div>
<div class="source-line"><span class="line-number ">766</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">function op_or(x,y) { return x|y; }</span><span></span></code></div>
<div class="source-line"><span class="line-number ">767</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">function bnOr(a) { var r = nbi(); this.bitwiseTo(a,op_or,r); return r; }</span><span></span></code></div>
<div class="source-line"><span class="line-number ">768</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<div class="source-line"><span class="line-number ">769</span><span class="line-counter cline-yes">&nbsp</span><code>//(public) this ^ a</code></div>
<div class="source-line"><span class="line-number ">770</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">function op_xor(x,y) { return x^y; }</span><span></span></code></div>
<div class="source-line"><span class="line-number ">771</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">function bnXor(a) { var r = nbi(); this.bitwiseTo(a,op_xor,r); return r; }</span><span></span></code></div>
<div class="source-line"><span class="line-number ">772</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<div class="source-line"><span class="line-number ">773</span><span class="line-counter cline-yes">&nbsp</span><code>//(public) this &amp; ~a</code></div>
<div class="source-line"><span class="line-number ">774</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">function op_andnot(x,y) { return x&amp;~y; }</span><span></span></code></div>
<div class="source-line"><span class="line-number ">775</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">function bnAndNot(a) { var r = nbi(); this.bitwiseTo(a,op_andnot,r); return r; }</span><span></span></code></div>
<div class="source-line"><span class="line-number ">776</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<div class="source-line"><span class="line-number ">777</span><span class="line-counter cline-yes">&nbsp</span><code>//(public) ~this</code></div>
<div class="source-line"><span class="line-number ">778</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">function bnNot() {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">779</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">var r = nbi();</span><span></span></code></div>
<div class="source-line"><span class="line-number ">780</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">for(var i = 0; i &lt; this.t; ++i) r.data[i] = this.DM&amp;~this.data[i];</span><span></span></code></div>
<div class="source-line"><span class="line-number ">781</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">r.t = this.t;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">782</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">r.s = ~this.s;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">783</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">return r;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">784</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">}</span><span></span></code></div>
<div class="source-line"><span class="line-number ">785</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<div class="source-line"><span class="line-number ">786</span><span class="line-counter cline-yes">&nbsp</span><code>//(public) this &lt;&lt; n</code></div>
<div class="source-line"><span class="line-number ">787</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">function bnShiftLeft(n) {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">788</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">var r = nbi();</span><span></span></code></div>
<div class="source-line"><span class="line-number ">789</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">if(n &lt; 0) this.rShiftTo(-n,r); else this.lShiftTo(n,r);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">790</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">return r;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">791</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">}</span><span></span></code></div>
<div class="source-line"><span class="line-number ">792</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<div class="source-line"><span class="line-number ">793</span><span class="line-counter cline-yes">&nbsp</span><code>//(public) this &gt;&gt; n</code></div>
<div class="source-line"><span class="line-number ">794</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">function bnShiftRight(n) {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">795</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">var r = nbi();</span><span></span></code></div>
<div class="source-line"><span class="line-number ">796</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">if(n &lt; 0) this.lShiftTo(-n,r); else this.rShiftTo(n,r);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">797</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">return r;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">798</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">}</span><span></span></code></div>
<div class="source-line"><span class="line-number ">799</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<div class="source-line"><span class="line-number ">800</span><span class="line-counter cline-yes">&nbsp</span><code>//return index of lowest 1-bit in x, x &lt; 2^31</code></div>
<div class="source-line"><span class="line-number ">801</span><span class="line-counter cline-yes">&nbsp</span><code>function lbit(x) {</code></div>
<div class="source-line"><span class="line-number ">802</span><span class="line-counter cline-no">！</span><code><span>if(x == 0) </span><span class="cstat-no" title="statement not covered">return -1;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">803</span><span class="line-counter cline-yes">&nbsp</span><code>var r = 0;</code></div>
<div class="source-line"><span class="line-number ">804</span><span class="line-counter cline-no">！</span><code><span>if((x&amp;0xffff) == 0) </span><span class="cstat-no" title="statement not covered">{ x &gt;&gt;= 16; r += 16; }</span><span></span></code></div>
<div class="source-line"><span class="line-number ">805</span><span class="line-counter cline-yes">&nbsp</span><code>if((x&amp;0xff) == 0) { x &gt;&gt;= 8; r += 8; }</code></div>
<mark class="issue-line"><div class="source-line"><span class="line-number ">806</span><span class="line-counter cline-yes">&nbsp</span><code>if((x&amp;0xf) == 0) { x &gt;&gt;= 4; r += 4; }</code></div>
</mark><details class="issue-inline-message issue-critical issue-branch target-RSASIGN">
                        <summary>💥&nbsp;<i>RSASIGN</i> Secret-dependent branch</summary>
                <div class="issue-description">[RSASIGN] Found vulnerable jump instruction, leakage score 100.00% +/- 0%.</div>
            </details><mark class="issue-line"><div class="source-line"><span class="line-number ">807</span><span class="line-counter cline-yes">&nbsp</span><code>if((x&amp;3) == 0) { x &gt;&gt;= 2; r += 2; }</code></div>
</mark><details class="issue-inline-message issue-critical issue-branch target-RSASIGN">
                        <summary>💥&nbsp;<i>RSASIGN</i> Secret-dependent branch</summary>
                <div class="issue-description">[RSASIGN] Found vulnerable jump instruction, leakage score 98.67% +/- 2.67%.</div>
            </details><mark class="issue-line"><div class="source-line"><span class="line-number ">808</span><span class="line-counter cline-yes">&nbsp</span><code>if((x&amp;1) == 0) ++r;</code></div>
</mark><details class="issue-inline-message issue-critical issue-branch target-RSASIGN">
                        <summary>💥&nbsp;<i>RSASIGN</i> Secret-dependent branch</summary>
                <div class="issue-description">[RSASIGN] Found vulnerable jump instruction, leakage score 100.00% +/- 0%.</div>
            </details><div class="source-line"><span class="line-number ">809</span><span class="line-counter cline-yes">&nbsp</span><code>return r;</code></div>
<div class="source-line"><span class="line-number ">810</span><span class="line-counter cline-yes">&nbsp</span><code>}</code></div>
<div class="source-line"><span class="line-number ">811</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<div class="source-line"><span class="line-number ">812</span><span class="line-counter cline-yes">&nbsp</span><code>//(public) returns index of lowest 1-bit (or -1 if none)</code></div>
<div class="source-line"><span class="line-number ">813</span><span class="line-counter cline-yes">&nbsp</span><code>function bnGetLowestSetBit() {</code></div>
<div class="source-line"><span class="line-number ">814</span><span class="line-counter cline-yes">&nbsp</span><code>for(var i = 0; i &lt; this.t; ++i)</code></div>
<div class="source-line"><span class="line-number ">815</span><span class="line-counter cline-yes">&nbsp</span><code> if(this.data[i] != 0) return i*this.DB+lbit(this.data[i]);</code></div>
<div class="source-line"><span class="line-number ">816</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">if(this.s &lt; 0) return this.t*this.DB;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">817</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">return -1;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">818</span><span class="line-counter cline-yes">&nbsp</span><code>}</code></div>
<div class="source-line"><span class="line-number ">819</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<div class="source-line"><span class="line-number ">820</span><span class="line-counter cline-yes">&nbsp</span><code>//return number of 1 bits in x</code></div>
<div class="source-line"><span class="line-number ">821</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">function cbit(x) {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">822</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">var r = 0;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">823</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">while(x != 0) { x &amp;= x-1; ++r; }</span><span></span></code></div>
<div class="source-line"><span class="line-number ">824</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">return r;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">825</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">}</span><span></span></code></div>
<div class="source-line"><span class="line-number ">826</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<div class="source-line"><span class="line-number ">827</span><span class="line-counter cline-yes">&nbsp</span><code>//(public) return number of set bits</code></div>
<div class="source-line"><span class="line-number ">828</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">function bnBitCount() {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">829</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">var r = 0, x = this.s&amp;this.DM;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">830</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">for(var i = 0; i &lt; this.t; ++i) r += cbit(this.data[i]^x);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">831</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">return r;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">832</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">}</span><span></span></code></div>
<div class="source-line"><span class="line-number ">833</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<div class="source-line"><span class="line-number ">834</span><span class="line-counter cline-yes">&nbsp</span><code>//(public) true iff nth bit is set</code></div>
<div class="source-line"><span class="line-number ">835</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">function bnTestBit(n) {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">836</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">var j = Math.floor(n/this.DB);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">837</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">if(j &gt;= this.t) return(this.s!=0);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">838</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">return((this.data[j]&amp;(1&lt;&lt;(n%this.DB)))!=0);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">839</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">}</span><span></span></code></div>
<div class="source-line"><span class="line-number ">840</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<div class="source-line"><span class="line-number ">841</span><span class="line-counter cline-yes">&nbsp</span><code>//(protected) this op (1&lt;&lt;n)</code></div>
<div class="source-line"><span class="line-number ">842</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">function bnpChangeBit(n,op) {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">843</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">var r = BigInteger.ONE.shiftLeft(n);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">844</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">this.bitwiseTo(r,op,r);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">845</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">return r;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">846</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">}</span><span></span></code></div>
<div class="source-line"><span class="line-number ">847</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<div class="source-line"><span class="line-number ">848</span><span class="line-counter cline-yes">&nbsp</span><code>//(public) this | (1&lt;&lt;n)</code></div>
<div class="source-line"><span class="line-number ">849</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">function bnSetBit(n) { return this.changeBit(n,op_or); }</span><span></span></code></div>
<div class="source-line"><span class="line-number ">850</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<div class="source-line"><span class="line-number ">851</span><span class="line-counter cline-yes">&nbsp</span><code>//(public) this &amp; ~(1&lt;&lt;n)</code></div>
<div class="source-line"><span class="line-number ">852</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">function bnClearBit(n) { return this.changeBit(n,op_andnot); }</span><span></span></code></div>
<div class="source-line"><span class="line-number ">853</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<div class="source-line"><span class="line-number ">854</span><span class="line-counter cline-yes">&nbsp</span><code>//(public) this ^ (1&lt;&lt;n)</code></div>
<div class="source-line"><span class="line-number ">855</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">function bnFlipBit(n) { return this.changeBit(n,op_xor); }</span><span></span></code></div>
<div class="source-line"><span class="line-number ">856</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<div class="source-line"><span class="line-number ">857</span><span class="line-counter cline-yes">&nbsp</span><code>//(protected) r = this + a</code></div>
<div class="source-line"><span class="line-number ">858</span><span class="line-counter cline-yes">&nbsp</span><code>function bnpAddTo(a,r) {</code></div>
<mark class="issue-line"><div class="source-line"><span class="line-number ">859</span><span class="line-counter cline-yes">&nbsp</span><code>var i = 0, c = 0, m = Math.min(a.t,this.t);</code></div>
</mark><details class="issue-inline-message issue-critical issue-memory-access target-RSASIGN">
                        <summary>💥&nbsp;<i>RSASIGN</i> Secret-dependent memory access</summary>
                <div class="issue-description">[RSASIGN] Found vulnerable memory access instruction, leakage score 100.00% +/- 0%.</div>
            </details><mark class="issue-line"><div class="source-line"><span class="line-number ">860</span><span class="line-counter cline-yes">&nbsp</span><code>while(i &lt; m) {</code></div>
</mark><details class="issue-inline-message issue-critical issue-branch target-RSASIGN">
                        <summary>💥&nbsp;<i>RSASIGN</i> Secret-dependent branch</summary>
                <div class="issue-description">[RSASIGN] Found vulnerable jump instruction, leakage score 100.00% +/- 0%.</div>
            </details><mark class="issue-line"><div class="source-line"><span class="line-number ">861</span><span class="line-counter cline-yes">&nbsp</span><code> c += this.data[i]+a.data[i];</code></div>
</mark><details class="issue-inline-message issue-critical issue-memory-access target-RSASIGN">
                        <summary>💥&nbsp;<i>RSASIGN</i> Secret-dependent memory access</summary>
                <div class="issue-description">[RSASIGN] Found vulnerable memory access instruction, leakage score 100.00% +/- 0%.</div>
            </details><mark class="issue-line"><div class="source-line"><span class="line-number ">862</span><span class="line-counter cline-yes">&nbsp</span><code> r.data[i++] = c&amp;this.DM;</code></div>
</mark><details class="issue-inline-message issue-critical issue-memory-access target-RSASIGN">
                        <summary>💥&nbsp;<i>RSASIGN</i> Secret-dependent memory access</summary>
                <div class="issue-description">[RSASIGN] Found vulnerable memory access instruction, leakage score 100.00% +/- 0%.</div>
            </details><mark class="issue-line"><div class="source-line"><span class="line-number ">863</span><span class="line-counter cline-yes">&nbsp</span><code> c &gt;&gt;= this.DB;</code></div>
</mark><details class="issue-inline-message issue-critical issue-memory-access target-RSASIGN">
                        <summary>💥&nbsp;<i>RSASIGN</i> Secret-dependent memory access</summary>
                <div class="issue-description">[RSASIGN] Found vulnerable memory access instruction, leakage score 100.00% +/- 0%.</div>
            </details><div class="source-line"><span class="line-number ">864</span><span class="line-counter cline-yes">&nbsp</span><code>}</code></div>
<mark class="issue-line"><div class="source-line"><span class="line-number ">865</span><span class="line-counter cline-yes">&nbsp</span><code>if(a.t &lt; this.t) {</code></div>
</mark><details class="issue-inline-message issue-critical issue-memory-access target-RSASIGN">
                        <summary>💥&nbsp;<i>RSASIGN</i> Secret-dependent memory access</summary>
                <div class="issue-description">[RSASIGN] Found vulnerable memory access instruction, leakage score 100.00% +/- 0%.</div>
            </details><mark class="issue-line"><div class="source-line"><span class="line-number ">866</span><span class="line-counter cline-yes">&nbsp</span><code> c += a.s;</code></div>
</mark><details class="issue-inline-message issue-critical issue-memory-access target-RSASIGN">
                        <summary>💥&nbsp;<i>RSASIGN</i> Secret-dependent memory access</summary>
                <div class="issue-description">[RSASIGN] Found vulnerable memory access instruction, leakage score 100.00% +/- 0%.</div>
            </details><div class="source-line"><span class="line-number ">867</span><span class="line-counter cline-yes">&nbsp</span><code> while(i &lt; this.t) {</code></div>
<div class="source-line"><span class="line-number ">868</span><span class="line-counter cline-yes">&nbsp</span><code>   c += this.data[i];</code></div>
<div class="source-line"><span class="line-number ">869</span><span class="line-counter cline-yes">&nbsp</span><code>   r.data[i++] = c&amp;this.DM;</code></div>
<div class="source-line"><span class="line-number ">870</span><span class="line-counter cline-yes">&nbsp</span><code>   c &gt;&gt;= this.DB;</code></div>
<div class="source-line"><span class="line-number ">871</span><span class="line-counter cline-yes">&nbsp</span><code> }</code></div>
<div class="source-line"><span class="line-number ">872</span><span class="line-counter cline-yes">&nbsp</span><code> c += this.s;</code></div>
<div class="source-line"><span class="line-number ">873</span><span class="line-counter cline-yes">&nbsp</span><code>} else {</code></div>
<mark class="issue-line"><div class="source-line"><span class="line-number ">874</span><span class="line-counter cline-yes">&nbsp</span><code> c += this.s;</code></div>
</mark><details class="issue-inline-message issue-critical issue-memory-access target-RSASIGN">
                        <summary>💥&nbsp;<i>RSASIGN</i> Secret-dependent memory access</summary>
                <div class="issue-description">[RSASIGN] Found vulnerable memory access instruction, leakage score 100.00% +/- 0%.</div>
            </details><div class="source-line"><span class="line-number ">875</span><span class="line-counter cline-yes">&nbsp</span><code> while(i &lt; a.t) {</code></div>
<div class="source-line"><span class="line-number ">876</span><span class="line-counter cline-yes">&nbsp</span><code>   c += a.data[i];</code></div>
<div class="source-line"><span class="line-number ">877</span><span class="line-counter cline-yes">&nbsp</span><code>   r.data[i++] = c&amp;this.DM;</code></div>
<div class="source-line"><span class="line-number ">878</span><span class="line-counter cline-yes">&nbsp</span><code>   c &gt;&gt;= this.DB;</code></div>
<div class="source-line"><span class="line-number ">879</span><span class="line-counter cline-yes">&nbsp</span><code> }</code></div>
<div class="source-line"><span class="line-number ">880</span><span class="line-counter cline-yes">&nbsp</span><code> c += a.s;</code></div>
<div class="source-line"><span class="line-number ">881</span><span class="line-counter cline-yes">&nbsp</span><code>}</code></div>
<div class="source-line"><span class="line-number ">882</span><span class="line-counter cline-no">！</span><code><span>r.s = (c&lt;0)</span><span class="cstat-no" title="statement not covered">?-1</span><span>:0;</span></code></div>
<div class="source-line"><span class="line-number ">883</span><span class="line-counter cline-no">！</span><code><span>if(c &gt; 0) </span><span class="cstat-no" title="statement not covered">r.data[i++] = c;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">884</span><span class="line-counter cline-no">！</span><code><span>else if(c &lt; -1) </span><span class="cstat-no" title="statement not covered">r.data[i++] = this.DV+c;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">885</span><span class="line-counter cline-yes">&nbsp</span><code>r.t = i;</code></div>
<div class="source-line"><span class="line-number ">886</span><span class="line-counter cline-yes">&nbsp</span><code>r.clamp();</code></div>
<div class="source-line"><span class="line-number ">887</span><span class="line-counter cline-yes">&nbsp</span><code>}</code></div>
<div class="source-line"><span class="line-number ">888</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<div class="source-line"><span class="line-number ">889</span><span class="line-counter cline-yes">&nbsp</span><code>//(public) this + a</code></div>
<mark class="issue-line"><div class="source-line"><span class="line-number ">890</span><span class="line-counter cline-yes">&nbsp</span><code>function bnAdd(a) { var r = nbi(); this.addTo(a,r); return r; }</code></div>
</mark><details class="issue-inline-message issue-critical issue-memory-access target-RSASIGN">
                        <summary>💥&nbsp;<i>RSASIGN</i> Secret-dependent memory access</summary>
                <div class="issue-description">[RSASIGN] Found vulnerable memory access instruction, leakage score 100.00% +/- 0%.</div>
            </details><div class="source-line"><span class="line-number ">891</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<div class="source-line"><span class="line-number ">892</span><span class="line-counter cline-yes">&nbsp</span><code>//(public) this - a</code></div>
<mark class="issue-line"><div class="source-line"><span class="line-number ">893</span><span class="line-counter cline-yes">&nbsp</span><code>function bnSubtract(a) { var r = nbi(); this.subTo(a,r); return r; }</code></div>
</mark><details class="issue-inline-message issue-critical issue-memory-access target-RSASIGN">
                        <summary>💥&nbsp;<i>RSASIGN</i> Secret-dependent memory access</summary>
                <div class="issue-description">[RSASIGN] Found vulnerable memory access instruction, leakage score 100.00% +/- 0%.</div>
            </details><div class="source-line"><span class="line-number ">894</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<div class="source-line"><span class="line-number ">895</span><span class="line-counter cline-yes">&nbsp</span><code>//(public) this * a</code></div>
<div class="source-line"><span class="line-number ">896</span><span class="line-counter cline-yes">&nbsp</span><code>function bnMultiply(a) { var r = nbi(); this.multiplyTo(a,r); return r; }</code></div>
<div class="source-line"><span class="line-number ">897</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<div class="source-line"><span class="line-number ">898</span><span class="line-counter cline-yes">&nbsp</span><code>//(public) this / a</code></div>
<div class="source-line"><span class="line-number ">899</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">function bnDivide(a) { var r = nbi(); this.divRemTo(a,r,null); return r; }</span><span></span></code></div>
<div class="source-line"><span class="line-number ">900</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<div class="source-line"><span class="line-number ">901</span><span class="line-counter cline-yes">&nbsp</span><code>//(public) this % a</code></div>
<div class="source-line"><span class="line-number ">902</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">function bnRemainder(a) { var r = nbi(); this.divRemTo(a,null,r); return r; }</span><span></span></code></div>
<div class="source-line"><span class="line-number ">903</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<div class="source-line"><span class="line-number ">904</span><span class="line-counter cline-yes">&nbsp</span><code>//(public) [this/a,this%a]</code></div>
<div class="source-line"><span class="line-number ">905</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">function bnDivideAndRemainder(a) {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">906</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">var q = nbi(), r = nbi();</span><span></span></code></div>
<div class="source-line"><span class="line-number ">907</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">this.divRemTo(a,q,r);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">908</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">return new Array(q,r);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">909</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">}</span><span></span></code></div>
<div class="source-line"><span class="line-number ">910</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<div class="source-line"><span class="line-number ">911</span><span class="line-counter cline-yes">&nbsp</span><code>//(protected) this *= n, this &gt;= 0, 1 &lt; n &lt; DV</code></div>
<div class="source-line"><span class="line-number ">912</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">function bnpDMultiply(n) {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">913</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">this.data[this.t] = this.am(0,n-1,this,0,0,this.t);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">914</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">++this.t;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">915</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">this.clamp();</span><span></span></code></div>
<div class="source-line"><span class="line-number ">916</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">}</span><span></span></code></div>
<div class="source-line"><span class="line-number ">917</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<div class="source-line"><span class="line-number ">918</span><span class="line-counter cline-yes">&nbsp</span><code>//(protected) this += n &lt;&lt; w words, this &gt;= 0</code></div>
<div class="source-line"><span class="line-number ">919</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">function bnpDAddOffset(n,w) {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">920</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">if(n == 0) return;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">921</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">while(this.t &lt;= w) this.data[this.t++] = 0;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">922</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">this.data[w] += n;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">923</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">while(this.data[w] &gt;= this.DV) {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">924</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered"> this.data[w] -= this.DV;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">925</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered"> if(++w &gt;= this.t) this.data[this.t++] = 0;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">926</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered"> ++this.data[w];</span><span></span></code></div>
<div class="source-line"><span class="line-number ">927</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">}</span><span></span></code></div>
<div class="source-line"><span class="line-number ">928</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">}</span><span></span></code></div>
<div class="source-line"><span class="line-number ">929</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<div class="source-line"><span class="line-number ">930</span><span class="line-counter cline-yes">&nbsp</span><code>//A &quot;null&quot; reducer</code></div>
<div class="source-line"><span class="line-number ">931</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">function NullExp() {}</span><span></span></code></div>
<div class="source-line"><span class="line-number ">932</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">function nNop(x) { return x; }</span><span></span></code></div>
<div class="source-line"><span class="line-number ">933</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">function nMulTo(x,y,r) { x.multiplyTo(y,r); }</span><span></span></code></div>
<div class="source-line"><span class="line-number ">934</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">function nSqrTo(x,r) { x.squareTo(r); }</span><span></span></code></div>
<div class="source-line"><span class="line-number ">935</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<div class="source-line"><span class="line-number ">936</span><span class="line-counter cline-yes">&nbsp</span><code>NullExp.prototype.convert = nNop;</code></div>
<div class="source-line"><span class="line-number ">937</span><span class="line-counter cline-yes">&nbsp</span><code>NullExp.prototype.revert = nNop;</code></div>
<div class="source-line"><span class="line-number ">938</span><span class="line-counter cline-yes">&nbsp</span><code>NullExp.prototype.mulTo = nMulTo;</code></div>
<div class="source-line"><span class="line-number ">939</span><span class="line-counter cline-yes">&nbsp</span><code>NullExp.prototype.sqrTo = nSqrTo;</code></div>
<div class="source-line"><span class="line-number ">940</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<div class="source-line"><span class="line-number ">941</span><span class="line-counter cline-yes">&nbsp</span><code>//(public) this^e</code></div>
<div class="source-line"><span class="line-number ">942</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">function bnPow(e) { return this.exp(e,new NullExp()); }</span><span></span></code></div>
<div class="source-line"><span class="line-number ">943</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<div class="source-line"><span class="line-number ">944</span><span class="line-counter cline-yes">&nbsp</span><code>//(protected) r = lower n words of &quot;this * a&quot;, a.t &lt;= n</code></div>
<div class="source-line"><span class="line-number ">945</span><span class="line-counter cline-yes">&nbsp</span><code>//&quot;this&quot; should be the larger one if appropriate.</code></div>
<div class="source-line"><span class="line-number ">946</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">function bnpMultiplyLowerTo(a,n,r) {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">947</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">var i = Math.min(this.t+a.t,n);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">948</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">r.s = 0; // assumes a,this &gt;= 0</span><span></span></code></div>
<div class="source-line"><span class="line-number ">949</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">r.t = i;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">950</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">while(i &gt; 0) r.data[--i] = 0;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">951</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">var j;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">952</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">for(j = r.t-this.t; i &lt; j; ++i) r.data[i+this.t] = this.am(0,a.data[i],r,i,0,this.t);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">953</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">for(j = Math.min(a.t,n); i &lt; j; ++i) this.am(0,a.data[i],r,i,0,n-i);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">954</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">r.clamp();</span><span></span></code></div>
<div class="source-line"><span class="line-number ">955</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">}</span><span></span></code></div>
<div class="source-line"><span class="line-number ">956</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<div class="source-line"><span class="line-number ">957</span><span class="line-counter cline-yes">&nbsp</span><code>//(protected) r = &quot;this * a&quot; without lower n words, n &gt; 0</code></div>
<div class="source-line"><span class="line-number ">958</span><span class="line-counter cline-yes">&nbsp</span><code>//&quot;this&quot; should be the larger one if appropriate.</code></div>
<div class="source-line"><span class="line-number ">959</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">function bnpMultiplyUpperTo(a,n,r) {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">960</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">--n;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">961</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">var i = r.t = this.t+a.t-n;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">962</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">r.s = 0; // assumes a,this &gt;= 0</span><span></span></code></div>
<div class="source-line"><span class="line-number ">963</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">while(--i &gt;= 0) r.data[i] = 0;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">964</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">for(i = Math.max(n-this.t,0); i &lt; a.t; ++i)</span><span></span></code></div>
<div class="source-line"><span class="line-number ">965</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered"> r.data[this.t+i-n] = this.am(n-i,a.data[i],r,0,0,this.t+i-n);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">966</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">r.clamp();</span><span></span></code></div>
<div class="source-line"><span class="line-number ">967</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">r.drShiftTo(1,r);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">968</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">}</span><span></span></code></div>
<div class="source-line"><span class="line-number ">969</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<div class="source-line"><span class="line-number ">970</span><span class="line-counter cline-yes">&nbsp</span><code>//Barrett modular reduction</code></div>
<div class="source-line"><span class="line-number ">971</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">function Barrett(m) {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">972</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">// setup Barrett</span><span></span></code></div>
<div class="source-line"><span class="line-number ">973</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">this.r2 = nbi();</span><span></span></code></div>
<div class="source-line"><span class="line-number ">974</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">this.q3 = nbi();</span><span></span></code></div>
<div class="source-line"><span class="line-number ">975</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">BigInteger.ONE.dlShiftTo(2*m.t,this.r2);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">976</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">this.mu = this.r2.divide(m);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">977</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">this.m = m;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">978</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">}</span><span></span></code></div>
<div class="source-line"><span class="line-number ">979</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<div class="source-line"><span class="line-number ">980</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">function barrettConvert(x) {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">981</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">if(x.s &lt; 0 || x.t &gt; 2*this.m.t) return x.mod(this.m);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">982</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">else if(x.compareTo(this.m) &lt; 0) return x;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">983</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">else { var r = nbi(); x.copyTo(r); this.reduce(r); return r; }</span><span></span></code></div>
<div class="source-line"><span class="line-number ">984</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">}</span><span></span></code></div>
<div class="source-line"><span class="line-number ">985</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<div class="source-line"><span class="line-number ">986</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">function barrettRevert(x) { return x; }</span><span></span></code></div>
<div class="source-line"><span class="line-number ">987</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<div class="source-line"><span class="line-number ">988</span><span class="line-counter cline-yes">&nbsp</span><code>//x = x mod m (HAC 14.42)</code></div>
<div class="source-line"><span class="line-number ">989</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">function barrettReduce(x) {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">990</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">x.drShiftTo(this.m.t-1,this.r2);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">991</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">if(x.t &gt; this.m.t+1) { x.t = this.m.t+1; x.clamp(); }</span><span></span></code></div>
<div class="source-line"><span class="line-number ">992</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">993</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">994</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">while(x.compareTo(this.r2) &lt; 0) x.dAddOffset(1,this.m.t+1);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">995</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">x.subTo(this.r2,x);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">996</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">while(x.compareTo(this.m) &gt;= 0) x.subTo(this.m,x);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">997</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">}</span><span></span></code></div>
<div class="source-line"><span class="line-number ">998</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<div class="source-line"><span class="line-number ">999</span><span class="line-counter cline-yes">&nbsp</span><code>//r = x^2 mod m; x != r</code></div>
<div class="source-line"><span class="line-number ">1000</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">function barrettSqrTo(x,r) { x.squareTo(r); this.reduce(r); }</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1001</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<div class="source-line"><span class="line-number ">1002</span><span class="line-counter cline-yes">&nbsp</span><code>//r = x*y mod m; x,y != r</code></div>
<div class="source-line"><span class="line-number ">1003</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">function barrettMulTo(x,y,r) { x.multiplyTo(y,r); this.reduce(r); }</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1004</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<div class="source-line"><span class="line-number ">1005</span><span class="line-counter cline-yes">&nbsp</span><code>Barrett.prototype.convert = barrettConvert;</code></div>
<div class="source-line"><span class="line-number ">1006</span><span class="line-counter cline-yes">&nbsp</span><code>Barrett.prototype.revert = barrettRevert;</code></div>
<div class="source-line"><span class="line-number ">1007</span><span class="line-counter cline-yes">&nbsp</span><code>Barrett.prototype.reduce = barrettReduce;</code></div>
<div class="source-line"><span class="line-number ">1008</span><span class="line-counter cline-yes">&nbsp</span><code>Barrett.prototype.mulTo = barrettMulTo;</code></div>
<div class="source-line"><span class="line-number ">1009</span><span class="line-counter cline-yes">&nbsp</span><code>Barrett.prototype.sqrTo = barrettSqrTo;</code></div>
<div class="source-line"><span class="line-number ">1010</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<div class="source-line"><span class="line-number ">1011</span><span class="line-counter cline-yes">&nbsp</span><code>//(public) this^e % m (HAC 14.85)</code></div>
<div class="source-line"><span class="line-number ">1012</span><span class="line-counter cline-yes">&nbsp</span><code>function bnModPow(e,m) {</code></div>
<div class="source-line"><span class="line-number ">1013</span><span class="line-counter cline-yes">&nbsp</span><code>var i = e.bitLength(), k, r = nbv(1), z;</code></div>
<div class="source-line"><span class="line-number ">1014</span><span class="line-counter cline-no">！</span><code><span>if(i &lt;= 0) </span><span class="cstat-no" title="statement not covered">return r;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1015</span><span class="line-counter cline-yes">&nbsp</span><code>else if(i &lt; 18) k = 1;</code></div>
<div class="source-line"><span class="line-number ">1016</span><span class="line-counter cline-no">！</span><code><span>else if(i &lt; 48) </span><span class="cstat-no" title="statement not covered">k = 3;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1017</span><span class="line-counter cline-no">！</span><code><span>else if(i &lt; 144) </span><span class="cstat-no" title="statement not covered">k = 4;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1018</span><span class="line-counter cline-yes">&nbsp</span><code>else if(i &lt; 768) k = 5;</code></div>
<div class="source-line"><span class="line-number ">1019</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">else k = 6;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1020</span><span class="line-counter cline-yes">&nbsp</span><code>if(i &lt; 8)</code></div>
<div class="source-line"><span class="line-number ">1021</span><span class="line-counter cline-no">！</span><code><span> </span><span class="cstat-no" title="statement not covered">z = new Classic(m);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1022</span><span class="line-counter cline-yes">&nbsp</span><code>else if(m.isEven())</code></div>
<div class="source-line"><span class="line-number ">1023</span><span class="line-counter cline-no">！</span><code><span> </span><span class="cstat-no" title="statement not covered">z = new Barrett(m);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1024</span><span class="line-counter cline-yes">&nbsp</span><code>else</code></div>
<div class="source-line"><span class="line-number ">1025</span><span class="line-counter cline-yes">&nbsp</span><code> z = new Montgomery(m);</code></div>
<div class="source-line"><span class="line-number ">1026</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<div class="source-line"><span class="line-number ">1027</span><span class="line-counter cline-yes">&nbsp</span><code>// precomputation</code></div>
<div class="source-line"><span class="line-number ">1028</span><span class="line-counter cline-yes">&nbsp</span><code>var g = new Array(), n = 3, k1 = k-1, km = (1&lt;&lt;k)-1;</code></div>
<div class="source-line"><span class="line-number ">1029</span><span class="line-counter cline-yes">&nbsp</span><code>g[1] = z.convert(this);</code></div>
<div class="source-line"><span class="line-number ">1030</span><span class="line-counter cline-yes">&nbsp</span><code>if(k &gt; 1) {</code></div>
<div class="source-line"><span class="line-number ">1031</span><span class="line-counter cline-yes">&nbsp</span><code> var g2 = nbi();</code></div>
<div class="source-line"><span class="line-number ">1032</span><span class="line-counter cline-yes">&nbsp</span><code> z.sqrTo(g[1],g2);</code></div>
<div class="source-line"><span class="line-number ">1033</span><span class="line-counter cline-yes">&nbsp</span><code> while(n &lt;= km) {</code></div>
<div class="source-line"><span class="line-number ">1034</span><span class="line-counter cline-yes">&nbsp</span><code>   g[n] = nbi();</code></div>
<div class="source-line"><span class="line-number ">1035</span><span class="line-counter cline-yes">&nbsp</span><code>   z.mulTo(g2,g[n-2],g[n]);</code></div>
<div class="source-line"><span class="line-number ">1036</span><span class="line-counter cline-yes">&nbsp</span><code>   n += 2;</code></div>
<div class="source-line"><span class="line-number ">1037</span><span class="line-counter cline-yes">&nbsp</span><code> }</code></div>
<div class="source-line"><span class="line-number ">1038</span><span class="line-counter cline-yes">&nbsp</span><code>}</code></div>
<div class="source-line"><span class="line-number ">1039</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<div class="source-line"><span class="line-number ">1040</span><span class="line-counter cline-yes">&nbsp</span><code>var j = e.t-1, w, is1 = true, r2 = nbi(), t;</code></div>
<mark class="issue-line"><div class="source-line"><span class="line-number ">1041</span><span class="line-counter cline-yes">&nbsp</span><code>i = nbits(e.data[j])-1;</code></div>
</mark><details class="issue-inline-message issue-critical issue-memory-access target-RSASIGN">
                        <summary>💥&nbsp;<i>RSASIGN</i> Secret-dependent memory access</summary>
                <div class="issue-description">[RSASIGN] Found vulnerable memory access instruction, leakage score 100.00% +/- 0%.</div>
            </details><div class="source-line"><span class="line-number ">1042</span><span class="line-counter cline-yes">&nbsp</span><code>while(j &gt;= 0) {</code></div>
<mark class="issue-line"><div class="source-line"><span class="line-number ">1043</span><span class="line-counter cline-yes">&nbsp</span><code> if(i &gt;= k1) w = (e.data[j]&gt;&gt;(i-k1))&amp;km;</code></div>
</mark><details class="issue-inline-message issue-critical issue-branch target-RSASIGN">
                        <summary>💥&nbsp;<i>RSASIGN</i> Secret-dependent branch</summary>
                <div class="issue-description">[RSASIGN] Found vulnerable jump instruction, leakage score 100.00% +/- 0%.</div>
            </details><div class="source-line"><span class="line-number ">1044</span><span class="line-counter cline-yes">&nbsp</span><code> else {</code></div>
<div class="source-line"><span class="line-number ">1045</span><span class="line-counter cline-yes">&nbsp</span><code>   w = (e.data[j]&amp;((1&lt;&lt;(i+1))-1))&lt;&lt;(k1-i);</code></div>
<div class="source-line"><span class="line-number ">1046</span><span class="line-counter cline-yes">&nbsp</span><code>   if(j &gt; 0) w |= e.data[j-1]&gt;&gt;(this.DB+i-k1);</code></div>
<div class="source-line"><span class="line-number ">1047</span><span class="line-counter cline-yes">&nbsp</span><code> }</code></div>
<div class="source-line"><span class="line-number ">1048</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<div class="source-line"><span class="line-number ">1049</span><span class="line-counter cline-yes">&nbsp</span><code> n = k;</code></div>
<mark class="issue-line"><div class="source-line"><span class="line-number ">1050</span><span class="line-counter cline-yes">&nbsp</span><code> while((w&amp;1) == 0) { w &gt;&gt;= 1; --n; }</code></div>
</mark><details class="issue-inline-message issue-critical issue-branch target-RSASIGN">
                        <summary>💥&nbsp;<i>RSASIGN</i> Secret-dependent branch</summary>
                <div class="issue-description">[RSASIGN] Found vulnerable jump instruction, leakage score 100.00% +/- 0%.</div>
            </details><mark class="issue-line"><div class="source-line"><span class="line-number ">1051</span><span class="line-counter cline-yes">&nbsp</span><code> if((i -= n) &lt; 0) { i += this.DB; --j; }</code></div>
</mark><details class="issue-inline-message issue-critical issue-branch target-RSASIGN">
                        <summary>💥&nbsp;<i>RSASIGN</i> Secret-dependent branch</summary>
                <div class="issue-description">[RSASIGN] Found vulnerable jump instruction, leakage score 100.00% +/- 0%.</div>
            </details><div class="source-line"><span class="line-number ">1052</span><span class="line-counter cline-yes">&nbsp</span><code> if(is1) {  // ret == 1, don&#39;t bother squaring or multiplying it</code></div>
<mark class="issue-line"><div class="source-line"><span class="line-number ">1053</span><span class="line-counter cline-yes">&nbsp</span><code>   g[w].copyTo(r);</code></div>
</mark><details class="issue-inline-message issue-critical issue-memory-access target-RSASIGN">
                        <summary>💥&nbsp;<i>RSASIGN</i> Secret-dependent memory access</summary>
                <div class="issue-description">[RSASIGN] Found vulnerable memory access instruction, leakage score 100.00% +/- 0%.</div>
            </details><div class="source-line"><span class="line-number ">1054</span><span class="line-counter cline-yes">&nbsp</span><code>   is1 = false;</code></div>
<div class="source-line"><span class="line-number ">1055</span><span class="line-counter cline-yes">&nbsp</span><code> } else {</code></div>
<div class="source-line"><span class="line-number ">1056</span><span class="line-counter cline-yes">&nbsp</span><code>   while(n &gt; 1) { z.sqrTo(r,r2); z.sqrTo(r2,r); n -= 2; }</code></div>
<div class="source-line"><span class="line-number ">1057</span><span class="line-counter cline-yes">&nbsp</span><code>   if(n &gt; 0) z.sqrTo(r,r2); else { t = r; r = r2; r2 = t; }</code></div>
<mark class="issue-line"><div class="source-line"><span class="line-number ">1058</span><span class="line-counter cline-yes">&nbsp</span><code>   z.mulTo(r2,g[w],r);</code></div>
</mark><details class="issue-inline-message issue-critical issue-memory-access target-RSASIGN">
                        <summary>💥&nbsp;<i>RSASIGN</i> Secret-dependent memory access</summary>
                <div class="issue-description">[RSASIGN] Found vulnerable memory access instruction, leakage score 100.00% +/- 0%.</div>
            </details><div class="source-line"><span class="line-number ">1059</span><span class="line-counter cline-yes">&nbsp</span><code> }</code></div>
<div class="source-line"><span class="line-number ">1060</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<mark class="issue-line"><div class="source-line"><span class="line-number ">1061</span><span class="line-counter cline-yes">&nbsp</span><code> while(j &gt;= 0 &amp;&amp; (e.data[j]&amp;(1&lt;&lt;i)) == 0) {</code></div>
</mark><details class="issue-inline-message issue-critical issue-branch target-RSASIGN">
                        <summary>💥&nbsp;<i>RSASIGN</i> Secret-dependent branch</summary>
                <div class="issue-description">[RSASIGN] Found vulnerable jump instruction, leakage score 100.00% +/- 0%.</div>
            </details><div class="source-line"><span class="line-number ">1062</span><span class="line-counter cline-yes">&nbsp</span><code>   z.sqrTo(r,r2); t = r; r = r2; r2 = t;</code></div>
<div class="source-line"><span class="line-number ">1063</span><span class="line-counter cline-yes">&nbsp</span><code>   if(--i &lt; 0) { i = this.DB-1; --j; }</code></div>
<div class="source-line"><span class="line-number ">1064</span><span class="line-counter cline-yes">&nbsp</span><code> }</code></div>
<div class="source-line"><span class="line-number ">1065</span><span class="line-counter cline-yes">&nbsp</span><code>}</code></div>
<div class="source-line"><span class="line-number ">1066</span><span class="line-counter cline-yes">&nbsp</span><code>return z.revert(r);</code></div>
<div class="source-line"><span class="line-number ">1067</span><span class="line-counter cline-yes">&nbsp</span><code>}</code></div>
<div class="source-line"><span class="line-number ">1068</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<div class="source-line"><span class="line-number ">1069</span><span class="line-counter cline-yes">&nbsp</span><code>//(public) gcd(this,a) (HAC 14.54)</code></div>
<div class="source-line"><span class="line-number ">1070</span><span class="line-counter cline-yes">&nbsp</span><code>function bnGCD(a) {</code></div>
<div class="source-line"><span class="line-number ">1071</span><span class="line-counter cline-no">！</span><code><span>var x = (this.s&lt;0)</span><span class="cstat-no" title="statement not covered">?this.negate()</span><span>:this.clone();</span></code></div>
<div class="source-line"><span class="line-number ">1072</span><span class="line-counter cline-no">！</span><code><span>var y = (a.s&lt;0)</span><span class="cstat-no" title="statement not covered">?a.negate()</span><span>:a.clone();</span></code></div>
<div class="source-line"><span class="line-number ">1073</span><span class="line-counter cline-yes">&nbsp</span><code>if(x.compareTo(y) &lt; 0) { var t = x; x = y; y = t; }</code></div>
<div class="source-line"><span class="line-number ">1074</span><span class="line-counter cline-yes">&nbsp</span><code>var i = x.getLowestSetBit(), g = y.getLowestSetBit();</code></div>
<div class="source-line"><span class="line-number ">1075</span><span class="line-counter cline-no">！</span><code><span>if(g &lt; 0) </span><span class="cstat-no" title="statement not covered">return x;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1076</span><span class="line-counter cline-yes">&nbsp</span><code>if(i &lt; g) g = i;</code></div>
<div class="source-line"><span class="line-number ">1077</span><span class="line-counter cline-no">！</span><code><span>if(g &gt; 0) </span><span class="cstat-no" title="statement not covered">{</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1078</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered"> x.rShiftTo(g,x);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1079</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered"> y.rShiftTo(g,y);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1080</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">}</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1081</span><span class="line-counter cline-yes">&nbsp</span><code>while(x.signum() &gt; 0) {</code></div>
<mark class="issue-line"><div class="source-line"><span class="line-number ">1082</span><span class="line-counter cline-yes">&nbsp</span><code> if((i = x.getLowestSetBit()) &gt; 0) x.rShiftTo(i,x);</code></div>
</mark><details class="issue-inline-message issue-critical issue-branch target-RSASIGN">
                        <summary>💥&nbsp;<i>RSASIGN</i> Secret-dependent branch</summary>
                <div class="issue-description">[RSASIGN] Found vulnerable jump instruction, leakage score 100.00% +/- 0%.</div>
            </details><mark class="issue-line"><div class="source-line"><span class="line-number ">1083</span><span class="line-counter cline-yes">&nbsp</span><code> if((i = y.getLowestSetBit()) &gt; 0) y.rShiftTo(i,y);</code></div>
</mark><details class="issue-inline-message issue-critical issue-branch target-RSASIGN">
                        <summary>💥&nbsp;<i>RSASIGN</i> Secret-dependent branch</summary>
                <div class="issue-description">[RSASIGN] Found vulnerable jump instruction, leakage score 100.00% +/- 0%.</div>
            </details><mark class="issue-line"><div class="source-line"><span class="line-number ">1084</span><span class="line-counter cline-yes">&nbsp</span><code> if(x.compareTo(y) &gt;= 0) {</code></div>
</mark><details class="issue-inline-message issue-critical issue-branch target-RSASIGN">
                        <summary>💥&nbsp;<i>RSASIGN</i> Secret-dependent branch</summary>
                <div class="issue-description">[RSASIGN] Found vulnerable jump instruction, leakage score 100.00% +/- 0%.</div>
            </details><div class="source-line"><span class="line-number ">1085</span><span class="line-counter cline-yes">&nbsp</span><code>   x.subTo(y,x);</code></div>
<div class="source-line"><span class="line-number ">1086</span><span class="line-counter cline-yes">&nbsp</span><code>   x.rShiftTo(1,x);</code></div>
<div class="source-line"><span class="line-number ">1087</span><span class="line-counter cline-yes">&nbsp</span><code> } else {</code></div>
<div class="source-line"><span class="line-number ">1088</span><span class="line-counter cline-yes">&nbsp</span><code>   y.subTo(x,y);</code></div>
<div class="source-line"><span class="line-number ">1089</span><span class="line-counter cline-yes">&nbsp</span><code>   y.rShiftTo(1,y);</code></div>
<div class="source-line"><span class="line-number ">1090</span><span class="line-counter cline-yes">&nbsp</span><code> }</code></div>
<div class="source-line"><span class="line-number ">1091</span><span class="line-counter cline-yes">&nbsp</span><code>}</code></div>
<div class="source-line"><span class="line-number ">1092</span><span class="line-counter cline-no">！</span><code><span>if(g &gt; 0) </span><span class="cstat-no" title="statement not covered">y.lShiftTo(g,y);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1093</span><span class="line-counter cline-yes">&nbsp</span><code>return y;</code></div>
<div class="source-line"><span class="line-number ">1094</span><span class="line-counter cline-yes">&nbsp</span><code>}</code></div>
<div class="source-line"><span class="line-number ">1095</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<div class="source-line"><span class="line-number ">1096</span><span class="line-counter cline-yes">&nbsp</span><code>//(protected) this % n, n &lt; 2^26</code></div>
<div class="source-line"><span class="line-number ">1097</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">function bnpModInt(n) {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1098</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">if(n &lt;= 0) return 0;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1099</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">var d = this.DV%n, r = (this.s&lt;0)?n-1:0;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1100</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">if(this.t &gt; 0)</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1101</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered"> if(d == 0) r = this.data[0]%n;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1102</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered"> else for(var i = this.t-1; i &gt;= 0; --i) r = (d*r+this.data[i])%n;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1103</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">return r;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1104</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">}</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1105</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<div class="source-line"><span class="line-number ">1106</span><span class="line-counter cline-yes">&nbsp</span><code>//(public) 1/this % m (HAC 14.61)</code></div>
<div class="source-line"><span class="line-number ">1107</span><span class="line-counter cline-yes">&nbsp</span><code>function bnModInverse(m) {</code></div>
<div class="source-line"><span class="line-number ">1108</span><span class="line-counter cline-yes">&nbsp</span><code>var ac = m.isEven();</code></div>
<div class="source-line"><span class="line-number ">1109</span><span class="line-counter cline-no">！</span><code><span>if((this.isEven() &amp;&amp; ac) || m.signum() == 0) </span><span class="cstat-no" title="statement not covered">return BigInteger.ZERO;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1110</span><span class="line-counter cline-yes">&nbsp</span><code>var u = m.clone(), v = this.clone();</code></div>
<div class="source-line"><span class="line-number ">1111</span><span class="line-counter cline-yes">&nbsp</span><code>var a = nbv(1), b = nbv(0), c = nbv(0), d = nbv(1);</code></div>
<div class="source-line"><span class="line-number ">1112</span><span class="line-counter cline-yes">&nbsp</span><code>while(u.signum() != 0) {</code></div>
<div class="source-line"><span class="line-number ">1113</span><span class="line-counter cline-yes">&nbsp</span><code> while(u.isEven()) {</code></div>
<div class="source-line"><span class="line-number ">1114</span><span class="line-counter cline-yes">&nbsp</span><code>   u.rShiftTo(1,u);</code></div>
<div class="source-line"><span class="line-number ">1115</span><span class="line-counter cline-no">！</span><code><span>   if(ac) </span><span class="cstat-no" title="statement not covered">{</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1116</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">     if(!a.isEven() || !b.isEven()) { a.addTo(this,a); b.subTo(m,b); }</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1117</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">     a.rShiftTo(1,a);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1118</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">   }</span><span> else if(!b.isEven()) b.subTo(m,b);</span></code></div>
<div class="source-line"><span class="line-number ">1119</span><span class="line-counter cline-yes">&nbsp</span><code>   b.rShiftTo(1,b);</code></div>
<div class="source-line"><span class="line-number ">1120</span><span class="line-counter cline-yes">&nbsp</span><code> }</code></div>
<div class="source-line"><span class="line-number ">1121</span><span class="line-counter cline-yes">&nbsp</span><code> while(v.isEven()) {</code></div>
<div class="source-line"><span class="line-number ">1122</span><span class="line-counter cline-yes">&nbsp</span><code>   v.rShiftTo(1,v);</code></div>
<div class="source-line"><span class="line-number ">1123</span><span class="line-counter cline-no">！</span><code><span>   if(ac) </span><span class="cstat-no" title="statement not covered">{</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1124</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">     if(!c.isEven() || !d.isEven()) { c.addTo(this,c); d.subTo(m,d); }</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1125</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">     c.rShiftTo(1,c);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1126</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">   }</span><span> else if(!d.isEven()) d.subTo(m,d);</span></code></div>
<div class="source-line"><span class="line-number ">1127</span><span class="line-counter cline-yes">&nbsp</span><code>   d.rShiftTo(1,d);</code></div>
<div class="source-line"><span class="line-number ">1128</span><span class="line-counter cline-yes">&nbsp</span><code> }</code></div>
<div class="source-line"><span class="line-number ">1129</span><span class="line-counter cline-yes">&nbsp</span><code> if(u.compareTo(v) &gt;= 0) {</code></div>
<div class="source-line"><span class="line-number ">1130</span><span class="line-counter cline-yes">&nbsp</span><code>   u.subTo(v,u);</code></div>
<div class="source-line"><span class="line-number ">1131</span><span class="line-counter cline-no">！</span><code><span>   if(ac) </span><span class="cstat-no" title="statement not covered">a.subTo(c,a);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1132</span><span class="line-counter cline-yes">&nbsp</span><code>   b.subTo(d,b);</code></div>
<div class="source-line"><span class="line-number ">1133</span><span class="line-counter cline-yes">&nbsp</span><code> } else {</code></div>
<div class="source-line"><span class="line-number ">1134</span><span class="line-counter cline-yes">&nbsp</span><code>   v.subTo(u,v);</code></div>
<div class="source-line"><span class="line-number ">1135</span><span class="line-counter cline-no">！</span><code><span>   if(ac) </span><span class="cstat-no" title="statement not covered">c.subTo(a,c);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1136</span><span class="line-counter cline-yes">&nbsp</span><code>   d.subTo(b,d);</code></div>
<div class="source-line"><span class="line-number ">1137</span><span class="line-counter cline-yes">&nbsp</span><code> }</code></div>
<div class="source-line"><span class="line-number ">1138</span><span class="line-counter cline-yes">&nbsp</span><code>}</code></div>
<div class="source-line"><span class="line-number ">1139</span><span class="line-counter cline-no">！</span><code><span>if(v.compareTo(BigInteger.ONE) != 0) </span><span class="cstat-no" title="statement not covered">return BigInteger.ZERO;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1140</span><span class="line-counter cline-no">！</span><code><span>if(d.compareTo(m) &gt;= 0) </span><span class="cstat-no" title="statement not covered">return d.subtract(m);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1141</span><span class="line-counter cline-yes">&nbsp</span><code>if(d.signum() &lt; 0) d.addTo(m,d); else return d;</code></div>
<div class="source-line"><span class="line-number ">1142</span><span class="line-counter cline-no">！</span><code><span>if(d.signum() &lt; 0) </span><span class="cstat-no" title="statement not covered">return d.add(m);</span><span> else return d;</span></code></div>
<div class="source-line"><span class="line-number ">1143</span><span class="line-counter cline-yes">&nbsp</span><code>}</code></div>
<div class="source-line"><span class="line-number ">1144</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<div class="source-line"><span class="line-number ">1145</span><span class="line-counter cline-yes">&nbsp</span><code>var lowprimes = [2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509];</code></div>
<div class="source-line"><span class="line-number ">1146</span><span class="line-counter cline-yes">&nbsp</span><code>var lplim = (1&lt;&lt;26)/lowprimes[lowprimes.length-1];</code></div>
<div class="source-line"><span class="line-number ">1147</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<div class="source-line"><span class="line-number ">1148</span><span class="line-counter cline-yes">&nbsp</span><code>//(public) test primality with certainty &gt;= 1-.5^t</code></div>
<div class="source-line"><span class="line-number ">1149</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">function bnIsProbablePrime(t) {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1150</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">var i, x = this.abs();</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1151</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">if(x.t == 1 &amp;&amp; x.data[0] &lt;= lowprimes[lowprimes.length-1]) {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1152</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered"> for(i = 0; i &lt; lowprimes.length; ++i)</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1153</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">   if(x.data[0] == lowprimes[i]) return true;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1154</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered"> return false;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1155</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">}</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1156</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">if(x.isEven()) return false;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1157</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">i = 1;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1158</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">while(i &lt; lowprimes.length) {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1159</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered"> var m = lowprimes[i], j = i+1;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1160</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered"> while(j &lt; lowprimes.length &amp;&amp; m &lt; lplim) m *= lowprimes[j++];</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1161</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered"> m = x.modInt(m);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1162</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered"> while(i &lt; j) if(m%lowprimes[i++] == 0) return false;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1163</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">}</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1164</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">return x.millerRabin(t);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1165</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">}</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1166</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<div class="source-line"><span class="line-number ">1167</span><span class="line-counter cline-yes">&nbsp</span><code>//(protected) true if probably prime (HAC 4.24, Miller-Rabin)</code></div>
<div class="source-line"><span class="line-number ">1168</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">function bnpMillerRabin(t) {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1169</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">var n1 = this.subtract(BigInteger.ONE);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1170</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">var k = n1.getLowestSetBit();</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1171</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">if(k &lt;= 0) return false;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1172</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">var r = n1.shiftRight(k);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1173</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">var prng = bnGetPrng();</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1174</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">var a;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1175</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">for(var i = 0; i &lt; t; ++i) {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1176</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered"> // select witness &#39;a&#39; at random from between 1 and n1</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1177</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered"> do {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1178</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">   a = new BigInteger(this.bitLength(), prng);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1179</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered"> }</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1180</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered"> while(a.compareTo(BigInteger.ONE) &lt;= 0 || a.compareTo(n1) &gt;= 0);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1181</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered"> var y = a.modPow(r,this);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1182</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered"> if(y.compareTo(BigInteger.ONE) != 0 &amp;&amp; y.compareTo(n1) != 0) {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1183</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">   var j = 1;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1184</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">   while(j++ &lt; k &amp;&amp; y.compareTo(n1) != 0) {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1185</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">     y = y.modPowInt(2,this);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1186</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">     if(y.compareTo(BigInteger.ONE) == 0) return false;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1187</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">   }</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1188</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">   if(y.compareTo(n1) != 0) return false;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1189</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered"> }</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1190</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">}</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1191</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">return true;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1192</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">}</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1193</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<div class="source-line"><span class="line-number ">1194</span><span class="line-counter cline-yes">&nbsp</span><code>// get pseudo random number generator</code></div>
<div class="source-line"><span class="line-number ">1195</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">function bnGetPrng() {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1196</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  // create prng with api that matches BigInteger secure random</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1197</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  return {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1198</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    // x is an array to fill with bytes</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1199</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    nextBytes: function(x) {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1200</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">      for(var i = 0; i &lt; x.length; ++i) {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1201</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">        x[i] = Math.floor(Math.random() * 0x0100);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1202</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">      }</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1203</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    }</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1204</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  };</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1205</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">}</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1206</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<div class="source-line"><span class="line-number ">1207</span><span class="line-counter cline-yes">&nbsp</span><code>//protected</code></div>
<div class="source-line"><span class="line-number ">1208</span><span class="line-counter cline-yes">&nbsp</span><code>BigInteger.prototype.chunkSize = bnpChunkSize;</code></div>
<div class="source-line"><span class="line-number ">1209</span><span class="line-counter cline-yes">&nbsp</span><code>BigInteger.prototype.toRadix = bnpToRadix;</code></div>
<div class="source-line"><span class="line-number ">1210</span><span class="line-counter cline-yes">&nbsp</span><code>BigInteger.prototype.fromRadix = bnpFromRadix;</code></div>
<div class="source-line"><span class="line-number ">1211</span><span class="line-counter cline-yes">&nbsp</span><code>BigInteger.prototype.fromNumber = bnpFromNumber;</code></div>
<div class="source-line"><span class="line-number ">1212</span><span class="line-counter cline-yes">&nbsp</span><code>BigInteger.prototype.bitwiseTo = bnpBitwiseTo;</code></div>
<div class="source-line"><span class="line-number ">1213</span><span class="line-counter cline-yes">&nbsp</span><code>BigInteger.prototype.changeBit = bnpChangeBit;</code></div>
<div class="source-line"><span class="line-number ">1214</span><span class="line-counter cline-yes">&nbsp</span><code>BigInteger.prototype.addTo = bnpAddTo;</code></div>
<div class="source-line"><span class="line-number ">1215</span><span class="line-counter cline-yes">&nbsp</span><code>BigInteger.prototype.dMultiply = bnpDMultiply;</code></div>
<div class="source-line"><span class="line-number ">1216</span><span class="line-counter cline-yes">&nbsp</span><code>BigInteger.prototype.dAddOffset = bnpDAddOffset;</code></div>
<div class="source-line"><span class="line-number ">1217</span><span class="line-counter cline-yes">&nbsp</span><code>BigInteger.prototype.multiplyLowerTo = bnpMultiplyLowerTo;</code></div>
<div class="source-line"><span class="line-number ">1218</span><span class="line-counter cline-yes">&nbsp</span><code>BigInteger.prototype.multiplyUpperTo = bnpMultiplyUpperTo;</code></div>
<div class="source-line"><span class="line-number ">1219</span><span class="line-counter cline-yes">&nbsp</span><code>BigInteger.prototype.modInt = bnpModInt;</code></div>
<div class="source-line"><span class="line-number ">1220</span><span class="line-counter cline-yes">&nbsp</span><code>BigInteger.prototype.millerRabin = bnpMillerRabin;</code></div>
<div class="source-line"><span class="line-number ">1221</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<div class="source-line"><span class="line-number ">1222</span><span class="line-counter cline-yes">&nbsp</span><code>//public</code></div>
<div class="source-line"><span class="line-number ">1223</span><span class="line-counter cline-yes">&nbsp</span><code>BigInteger.prototype.clone = bnClone;</code></div>
<div class="source-line"><span class="line-number ">1224</span><span class="line-counter cline-yes">&nbsp</span><code>BigInteger.prototype.intValue = bnIntValue;</code></div>
<div class="source-line"><span class="line-number ">1225</span><span class="line-counter cline-yes">&nbsp</span><code>BigInteger.prototype.byteValue = bnByteValue;</code></div>
<div class="source-line"><span class="line-number ">1226</span><span class="line-counter cline-yes">&nbsp</span><code>BigInteger.prototype.shortValue = bnShortValue;</code></div>
<div class="source-line"><span class="line-number ">1227</span><span class="line-counter cline-yes">&nbsp</span><code>BigInteger.prototype.signum = bnSigNum;</code></div>
<div class="source-line"><span class="line-number ">1228</span><span class="line-counter cline-yes">&nbsp</span><code>BigInteger.prototype.toByteArray = bnToByteArray;</code></div>
<div class="source-line"><span class="line-number ">1229</span><span class="line-counter cline-yes">&nbsp</span><code>BigInteger.prototype.equals = bnEquals;</code></div>
<div class="source-line"><span class="line-number ">1230</span><span class="line-counter cline-yes">&nbsp</span><code>BigInteger.prototype.min = bnMin;</code></div>
<div class="source-line"><span class="line-number ">1231</span><span class="line-counter cline-yes">&nbsp</span><code>BigInteger.prototype.max = bnMax;</code></div>
<div class="source-line"><span class="line-number ">1232</span><span class="line-counter cline-yes">&nbsp</span><code>BigInteger.prototype.and = bnAnd;</code></div>
<div class="source-line"><span class="line-number ">1233</span><span class="line-counter cline-yes">&nbsp</span><code>BigInteger.prototype.or = bnOr;</code></div>
<div class="source-line"><span class="line-number ">1234</span><span class="line-counter cline-yes">&nbsp</span><code>BigInteger.prototype.xor = bnXor;</code></div>
<div class="source-line"><span class="line-number ">1235</span><span class="line-counter cline-yes">&nbsp</span><code>BigInteger.prototype.andNot = bnAndNot;</code></div>
<div class="source-line"><span class="line-number ">1236</span><span class="line-counter cline-yes">&nbsp</span><code>BigInteger.prototype.not = bnNot;</code></div>
<div class="source-line"><span class="line-number ">1237</span><span class="line-counter cline-yes">&nbsp</span><code>BigInteger.prototype.shiftLeft = bnShiftLeft;</code></div>
<div class="source-line"><span class="line-number ">1238</span><span class="line-counter cline-yes">&nbsp</span><code>BigInteger.prototype.shiftRight = bnShiftRight;</code></div>
<div class="source-line"><span class="line-number ">1239</span><span class="line-counter cline-yes">&nbsp</span><code>BigInteger.prototype.getLowestSetBit = bnGetLowestSetBit;</code></div>
<div class="source-line"><span class="line-number ">1240</span><span class="line-counter cline-yes">&nbsp</span><code>BigInteger.prototype.bitCount = bnBitCount;</code></div>
<div class="source-line"><span class="line-number ">1241</span><span class="line-counter cline-yes">&nbsp</span><code>BigInteger.prototype.testBit = bnTestBit;</code></div>
<div class="source-line"><span class="line-number ">1242</span><span class="line-counter cline-yes">&nbsp</span><code>BigInteger.prototype.setBit = bnSetBit;</code></div>
<div class="source-line"><span class="line-number ">1243</span><span class="line-counter cline-yes">&nbsp</span><code>BigInteger.prototype.clearBit = bnClearBit;</code></div>
<div class="source-line"><span class="line-number ">1244</span><span class="line-counter cline-yes">&nbsp</span><code>BigInteger.prototype.flipBit = bnFlipBit;</code></div>
<div class="source-line"><span class="line-number ">1245</span><span class="line-counter cline-yes">&nbsp</span><code>BigInteger.prototype.add = bnAdd;</code></div>
<div class="source-line"><span class="line-number ">1246</span><span class="line-counter cline-yes">&nbsp</span><code>BigInteger.prototype.subtract = bnSubtract;</code></div>
<div class="source-line"><span class="line-number ">1247</span><span class="line-counter cline-yes">&nbsp</span><code>BigInteger.prototype.multiply = bnMultiply;</code></div>
<div class="source-line"><span class="line-number ">1248</span><span class="line-counter cline-yes">&nbsp</span><code>BigInteger.prototype.divide = bnDivide;</code></div>
<div class="source-line"><span class="line-number ">1249</span><span class="line-counter cline-yes">&nbsp</span><code>BigInteger.prototype.remainder = bnRemainder;</code></div>
<div class="source-line"><span class="line-number ">1250</span><span class="line-counter cline-yes">&nbsp</span><code>BigInteger.prototype.divideAndRemainder = bnDivideAndRemainder;</code></div>
<div class="source-line"><span class="line-number ">1251</span><span class="line-counter cline-yes">&nbsp</span><code>BigInteger.prototype.modPow = bnModPow;</code></div>
<div class="source-line"><span class="line-number ">1252</span><span class="line-counter cline-yes">&nbsp</span><code>BigInteger.prototype.modInverse = bnModInverse;</code></div>
<div class="source-line"><span class="line-number ">1253</span><span class="line-counter cline-yes">&nbsp</span><code>BigInteger.prototype.pow = bnPow;</code></div>
<div class="source-line"><span class="line-number ">1254</span><span class="line-counter cline-yes">&nbsp</span><code>BigInteger.prototype.gcd = bnGCD;</code></div>
<div class="source-line"><span class="line-number ">1255</span><span class="line-counter cline-yes">&nbsp</span><code>BigInteger.prototype.isProbablePrime = bnIsProbablePrime;</code></div>
<div class="source-line"><span class="line-number ">1256</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<div class="source-line"><span class="line-number ">1257</span><span class="line-counter cline-yes">&nbsp</span><code>//BigInteger interfaces not implemented in jsbn:</code></div>
<div class="source-line"><span class="line-number ">1258</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<div class="source-line"><span class="line-number ">1259</span><span class="line-counter cline-yes">&nbsp</span><code>//BigInteger(int signum, byte[] magnitude)</code></div>
<div class="source-line"><span class="line-number ">1260</span><span class="line-counter cline-yes">&nbsp</span><code>//double doubleValue()</code></div>
<div class="source-line"><span class="line-number ">1261</span><span class="line-counter cline-yes">&nbsp</span><code>//float floatValue()</code></div>
<div class="source-line"><span class="line-number ">1262</span><span class="line-counter cline-yes">&nbsp</span><code>//int hashCode()</code></div>
<div class="source-line"><span class="line-number ">1263</span><span class="line-counter cline-yes">&nbsp</span><code>//long longValue()</code></div>
<div class="source-line"><span class="line-number ">1264</span><span class="line-counter cline-yes">&nbsp</span><code>//static BigInteger valueOf(long val)</code></div>

    </div>
    <script>

        const ISSUE_TYPE_CLASSES_OR_NAME = {
			'severity-critical': 'issue-critical',
			'severity-major': 'issue-major',
			'severity-minor': 'issue-minor',
			'issue-type-memory-access': 'issue-memory-access',
			'issue-type-branch': 'issue-branch',
		};
            ISSUE_TYPE_CLASSES_OR_NAME['target-RSASIGN'] = 'target-RSASIGN';
            ISSUE_TYPE_CLASSES_OR_NAME['target-DECODE'] = 'target-DECODE';
            ISSUE_TYPE_CLASSES_OR_NAME['target-ECB'] = 'target-ECB';
            ISSUE_TYPE_CLASSES_OR_NAME['target-RSASIGN'] = 'target-RSASIGN';
            ISSUE_TYPE_CLASSES_OR_NAME['target-GCM'] = 'target-GCM';
            ISSUE_TYPE_CLASSES_OR_NAME['target-ECB'] = 'target-ECB';
            ISSUE_TYPE_CLASSES_OR_NAME['target-GCM'] = 'target-GCM';
            ISSUE_TYPE_CLASSES_OR_NAME['target-RSASIGN'] = 'target-RSASIGN';

		const checkboxes = document.querySelectorAll('input[type="checkbox"]');
        const buttons = document.querySelectorAll('input[type="button"]');

		function change() {
            var elem = document.getElementById('button1');
            const fold = ' Fold leak details ';
            const deploy = ' Deploy leak details ';
            if (elem.innerHTML === deploy) {
                elem.innerHTML = fold;
            } else if (elem.innerHTML === fold) {
                elem.innerHTML = deploy;
            } else {
                console.log(elem.innerHTML);
            }

            const issueSummaries = document.querySelectorAll('details.issue-inline-message' + ' summary');
            const issueSummariesOpen = document.querySelectorAll('details.issue-inline-message[open]' + ' summary');
            const issueSummariesArray = Array.from(issueSummaries);
            const issueSummariesOpenArray = Array.from(issueSummariesOpen);

            if (elem.innerHTML === fold) {
                let issueSummariesClose = [];
                for (let i = 0; i < issueSummariesArray.length; i++) {
                    const issue = issueSummariesArray[i];
                    if (!(issueSummariesOpenArray.includes(issue))) {
                        issueSummariesClose.push(issue);
                    }
                }
                for (let k = 0; k < issueSummariesClose.length; k++) {
		            issueSummariesClose[k].click();
		            for (let i = 0; i < 5 ; i++) {
		                checkboxes[i].checked = true;
            	    }
            	}
            } else if (elem.innerHTML === deploy) {
                for (let k = 0; k < issueSummariesOpen.length; k++) {
	                issueSummariesOpenArray[k].click()
	                for (let i = 0; i < 5 ; i++) { // 5 first checkboxes are Severity and Issue type one, others are for target-name
		                checkboxes[i].checked = false;
            	   }
                }
            } else {
                console.log("error");
            }
        }

        change();

        var lastClick = ["0"];
		for (let i = 0; i < checkboxes.length; i++) {
		    checkboxes[i].addEventListener('change', () => {
// 		        console.log(ISSUE_TYPE_CLASSES_OR_NAME[checkboxes[i].name]);
		        const issueSelector = '.' + ISSUE_TYPE_CLASSES_OR_NAME[checkboxes[i].name];
		        const issueSummaries = document.querySelectorAll('details' + issueSelector + ' > summary');
		        for (let i = 0; i < issueSummaries.length; i++) {
			        issueSummaries[i].click();
			    }
	        });
	   }
       
    </script>
  </body>
</html>