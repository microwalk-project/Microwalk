<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>CQR visualizer</title>
    <meta name="viewport" content="width=device-width,initial-scale=1">
	<meta http-equiv="content-security-policy" content="script-src 'unsafe-inline'">
	<style>
		html, body, div, span, applet, object, iframe,
		h1, h2, h3, h4, h5, h6, p, blockquote, pre,
		a, abbr, acronym, address, big, cite, code,
		del, dfn, em, img, ins, kbd, q, s, samp,
		small, strike, strong, sub, sup, tt, var,
		b, u, i, center,
		dl, dt, dd, ol, ul, li,
		fieldset, form, label, legend,
		table, caption, tbody, tfoot, thead, tr, th, td,
		article, aside, canvas, details, embed,
		figure, figcaption, footer, header, hgroup,
		menu, nav, output, ruby, section, summary,
		time, mark, audio, video {
			margin: 0;
			padding: 0;
			border: 0;
			font-size: 100%;
			font: inherit;
			vertical-align: baseline;
		}
		/* HTML5 display-role reset for older browsers */
		article, aside, details, figcaption, figure,
		footer, header, hgroup, menu, nav, section {
			display: block;
		}
		header {
            position : static;
        }
		body {
			line-height: 1;
		}
		ol, ul {
			list-style: none;
		}
		blockquote, q {
			quotes: none;
		}
		blockquote:before, blockquote:after,
		q:before, q:after {
			content: '';
			content: none;
		}
		table {
			border-collapse: collapse;
			border-spacing: 0;
		}

		:root {
			--accent-color: #DC8ADD78;
            --height: 12px;
		}
		body {
			font-family: monospace;
		}
		header {
    		background-color: var(--accent-color);
    		color: black;
    		margin-bottom: 1em;
    		padding: 1em 3em;
    		font-size: 20px;
    	}
    	code {
    		white-space: break-spaces;
    	}

        .header-text {
            font-size: 0.6em;
        }

    	.line-number {
    		text-align: right;
    		display: inline-block;
    		min-width: 4em;
    		margin-right: 8px;
    		border-right: 4px solid var(--accent-color);
    		padding-right: 8px;
    	}
    	.line-number, code {
    		padding-top: 2px;
    		padding-bottom: 2px;
    	}
    	.issue-line .line-number {
    		background-color: #ff00008f;
    	}
    	.issue-inline-message {
    		background-color: #e8e3e8;
			margin: 5px 0;
    		padding: 1em 5em;
    		border-top: 1px solid #4E464E;
    		border-bottom: 1px solid #4E464E;
    	}
    	.issue-inline-message > details {
    		font-weight: bold;
    		margin-bottom: 1em;
    	}
    	.issue-inline-message.issue-critical > summary {
    		color: #C81E1E;
    	}
    	.issue-inline-message.issue-major > summary {
    		color: #AD5100;
    	}
    	.issue-inline-message.issue-minor > summary {
    		color: #615900;
    	}
    	p {
    		font-size: 0.em;
    		margin-top: 0.5em;
    	}
    	h1 {
    	    font-size: 2em;
            margin-bottom: 0.2em;

    	}
    	.In-the-target {
    	    font-size: 0.7em;
    	}
    	details {
            border-radius: 4px;
            padding: 0.5em 0.5em 0;
        }
        summary {
            font-weight: bold;
            margin: -0.5em -0.5em 0;
            padding: 0.5em;
        }
        details.header-issue-counter[open] {
            padding: 0.5em;
        }
        details.issue-inline-message[open] {
            background-color: #c5299e24;
            padding: 1em 5em;
            /*margin-bottom: 1em;*/
        }
        details.header-issue-counter[open] summary {
            border-bottom: 1px solid black;
            margin-bottom: 0.5em;
        }
        details.issue-inline-message[open] summary {
            /*background-color: #c5299e24;*/
    		margin-bottom: 1em;
        }
        i {
            color: black;
        }
        input[type="checkbox"] {
			accent-color: black;
		}
		button {
		    border: 0;
            line-height: 2.5;
            padding: 0 20px;
            font-size: 1rem;
            text-align: center;
            color: #fff;
            text-shadow: 1px 1px 1px #000;
            border-radius: 10px;
            background-color: rgba(220, 0, 0, 1);
            background-image: linear-gradient(to top left, rgba(0, 0, 0, 0.2), rgba(0, 0, 0, 0.2) 30%, rgba(0, 0, 0, 0));
            box-shadow: inset 2px 2px 3px rgba(255, 255, 255, 0.6), inset -2px -2px 3px rgba(0, 0, 0, 0.6);
		}
		.deploy-button:hover {
            background-color: rgba(255, 0, 0, 1);
        }

        .deploy-button:active {
            box-shadow: inset -2px -2px 3px rgba(255, 255, 255, 0.6), inset 2px 2px 3px rgba(0, 0, 0, 0.6);
        }

        .cstat-no {
          background: #F6C6CE;
        }
        .line-number2 {
    		text-align: right;
    		display: inline-block;
    		min-width: 4em;
    		padding-right: 8px;
            border-right: 4px solid var(--accent-color);
    	}
    	.line-number2, code {
    		padding-top: 2px;
    		padding-bottom: 2px;
    	}
    	.source-line {
        }
        .line-counter {
    		text-align: center;
    		display: inline-block;

            height: var(--height);
    		min-width: 4em;
    		margin-right: 8px;
    		border-right: 4px
    		padding-right: 8px;
    	}

        .cline-yes {
          background: rgb(230,245,208);
          padding-top: 2px;
          padding-bottom: 2px;
        }

        .cline-no {
          background: #FCE1E5;
          padding-top: 2px;
          padding-bottom: 2px;
        }

        .header-option{
          line-height: 1;
        }

        .filter-inputs {
            display: flex;
            align-items: center;
            margin-bottom: 0.5em;
        }
        
        .button-container {
            flex: 0 0 auto;
            margin-right: 20px; 
            display: flex;
            align-items: center;
        }
        
        .options-container {
            display: flex;
            flex-direction: column;
        }
        
        .severity-options, .issue-type-options {
            margin-top: 1px;
        }

    </style>
  </head>
  <body>
  <div class="grid-container">
    <div class="head">
    <header>
<h1>node-forge/lib/util.js</h1>
        <div class="filter-inputs">
            <div class="button-container">
                <button onclick="change()" title="Click here to expand or collapse all leak details!" class="deploy-button" Id="button1"> Deploy leak details </button>
            </div>
            <div class="options-container">
                <div class="severity-options">
                    <span class="header-option">Severity:</span>
                    <label><input type="checkbox" name="severity-critical" > Critical</label>
                    <label><input type="checkbox" name="severity-major" > Major</label>
                    <label><input type="checkbox" name="severity-minor" > Minor</label>
                </div>
                <div class="issue-type-options">
                    <span>Issue type:</span>
                    <label><input type="checkbox" name="issue-type-memory-access" > Memory access</label>
                    <label><input type="checkbox" name="issue-type-branch" > Branch</label>
                </div>
            </div>
        </div>
        <p class="header-text">Total number of problem found: 7 out of 180</p>
        <p class="header-text">Number of critical in file: 7   ≅ 100%</p>
        <p class="header-text">Number of memory access error in file: 4   ≅ 57%</p>
        <p class="header-text">Coverage proportion (on the number of character): 30162 / 67206   ≅ 45%</p>
        <p class="header-text">Coverage proportion (on the number of line): 1251 / 2652   ≅ 47%</p><details open class="header-issue-counter"><summary class="In-the-target"><name="target-DECODE" Id="DECODE" <h2>In the target-DECODE</h2></summary>
            <p class="header-text">Number of problem found: 4</p>
            <p class="header-text">Number of critical: 4   ≅ 100%</p>
            <p class="header-text">Number of memory access error: 4   ≅ 100%</p></details><details open class="header-issue-counter"><summary class="In-the-target"><name="target-ECB" Id="ECB" <h2>In the target-ECB</h2></summary>
            <p class="header-text">Number of problem found: 1</p>
            <p class="header-text">Number of critical: 1   ≅ 100%</p>
            <p class="header-text">Number of memory access error: 0   ≅ 0%</p></details><details open class="header-issue-counter"><summary class="In-the-target"><name="target-RSASIGN" Id="RSASIGN" <h2>In the target-RSASIGN</h2></summary>
            <p class="header-text">Number of problem found: 2</p>
            <p class="header-text">Number of critical: 2   ≅ 100%</p>
            <p class="header-text">Number of memory access error: 0   ≅ 0%</p></details>
    </header>
    </div><div class="source-line"><span class="line-number ">1</span><span class="line-counter cline-yes">&nbsp</span><code>/**</code></div>
<div class="source-line"><span class="line-number ">2</span><span class="line-counter cline-yes">&nbsp</span><code> * Utility functions for web applications.</code></div>
<div class="source-line"><span class="line-number ">3</span><span class="line-counter cline-yes">&nbsp</span><code> *</code></div>
<div class="source-line"><span class="line-number ">4</span><span class="line-counter cline-yes">&nbsp</span><code> * @author Dave Longley</code></div>
<div class="source-line"><span class="line-number ">5</span><span class="line-counter cline-yes">&nbsp</span><code> *</code></div>
<div class="source-line"><span class="line-number ">6</span><span class="line-counter cline-yes">&nbsp</span><code> * Copyright (c) 2010-2018 Digital Bazaar, Inc.</code></div>
<div class="source-line"><span class="line-number ">7</span><span class="line-counter cline-yes">&nbsp</span><code> */</code></div>
<div class="source-line"><span class="line-number ">8</span><span class="line-counter cline-yes">&nbsp</span><code>var forge = require(&#39;./forge&#39;);</code></div>
<div class="source-line"><span class="line-number ">9</span><span class="line-counter cline-yes">&nbsp</span><code>var baseN = require(&#39;./baseN&#39;);</code></div>
<div class="source-line"><span class="line-number ">10</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<div class="source-line"><span class="line-number ">11</span><span class="line-counter cline-yes">&nbsp</span><code>/* Utilities API */</code></div>
<div class="source-line"><span class="line-number ">12</span><span class="line-counter cline-yes">&nbsp</span><code>var util = module.exports = forge.util = forge.util || {};</code></div>
<div class="source-line"><span class="line-number ">13</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<div class="source-line"><span class="line-number ">14</span><span class="line-counter cline-yes">&nbsp</span><code>// define setImmediate and nextTick</code></div>
<div class="source-line"><span class="line-number ">15</span><span class="line-counter cline-yes">&nbsp</span><code>(function() {</code></div>
<div class="source-line"><span class="line-number ">16</span><span class="line-counter cline-yes">&nbsp</span><code>  // use native nextTick (unless we&#39;re in webpack)</code></div>
<div class="source-line"><span class="line-number ">17</span><span class="line-counter cline-yes">&nbsp</span><code>  // webpack (or better node-libs-browser polyfill) sets process.browser.</code></div>
<div class="source-line"><span class="line-number ">18</span><span class="line-counter cline-yes">&nbsp</span><code>  // this way we can detect webpack properly</code></div>
<div class="source-line"><span class="line-number ">19</span><span class="line-counter cline-yes">&nbsp</span><code>  if(typeof process !== &#39;undefined&#39; &amp;&amp; process.nextTick &amp;&amp; !process.browser) {</code></div>
<div class="source-line"><span class="line-number ">20</span><span class="line-counter cline-yes">&nbsp</span><code>    util.nextTick = process.nextTick;</code></div>
<div class="source-line"><span class="line-number ">21</span><span class="line-counter cline-yes">&nbsp</span><code>    if(typeof setImmediate === &#39;function&#39;) {</code></div>
<div class="source-line"><span class="line-number ">22</span><span class="line-counter cline-yes">&nbsp</span><code>      util.setImmediate = setImmediate;</code></div>
<div class="source-line"><span class="line-number ">23</span><span class="line-counter cline-no">！</span><code><span>    }</span><span class="cstat-no" title="statement not covered"> else {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">24</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">      // polyfill setImmediate with nextTick, older versions of node</span><span></span></code></div>
<div class="source-line"><span class="line-number ">25</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">      // (those w/o setImmediate) won&#39;t totally starve IO</span><span></span></code></div>
<div class="source-line"><span class="line-number ">26</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">      util.setImmediate = util.nextTick;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">27</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    }</span><span></span></code></div>
<div class="source-line"><span class="line-number ">28</span><span class="line-counter cline-yes">&nbsp</span><code>    return;</code></div>
<div class="source-line"><span class="line-number ">29</span><span class="line-counter cline-yes">&nbsp</span><code>  }</code></div>
<div class="source-line"><span class="line-number ">30</span><span class="line-counter cline-no">！</span><code><span class="cstat-no" title="statement not covered"><br/></span><span></span></code></div>
<div class="source-line"><span class="line-number ">31</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  // polyfill nextTick with native setImmediate</span><span></span></code></div>
<div class="source-line"><span class="line-number ">32</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  if(typeof setImmediate === &#39;function&#39;) {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">33</span><span class="line-counter cline-no">！</span><code><span>    util.setImmediate = </span><span class="cstat-no" title="statement not covered">function() { return setImmediate.apply(undefined, arguments); }</span><span>;</span></code></div>
<div class="source-line"><span class="line-number ">34</span><span class="line-counter cline-no">！</span><code><span>    util.nextTick = </span><span class="cstat-no" title="statement not covered">function(callback) {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">35</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">      return setImmediate(callback);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">36</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    }</span><span>;</span></code></div>
<div class="source-line"><span class="line-number ">37</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    return;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">38</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  }</span><span></span></code></div>
<div class="source-line"><span class="line-number ">39</span><span class="line-counter cline-no">！</span><code><span class="cstat-no" title="statement not covered"><br/></span><span></span></code></div>
<div class="source-line"><span class="line-number ">40</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  /* Note: A polyfill upgrade pattern is used here to allow combining</span><span></span></code></div>
<div class="source-line"><span class="line-number ">41</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  polyfills. For example, MutationObserver is fast, but blocks UI updates,</span><span></span></code></div>
<div class="source-line"><span class="line-number ">42</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  so it needs to allow UI updates periodically, so it falls back on</span><span></span></code></div>
<div class="source-line"><span class="line-number ">43</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  postMessage or setTimeout. */</span><span></span></code></div>
<div class="source-line"><span class="line-number ">44</span><span class="line-counter cline-no">！</span><code><span class="cstat-no" title="statement not covered"><br/></span><span></span></code></div>
<div class="source-line"><span class="line-number ">45</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  // polyfill with setTimeout</span><span></span></code></div>
<div class="source-line"><span class="line-number ">46</span><span class="line-counter cline-no">！</span><code><span>  util.setImmediate = </span><span class="cstat-no" title="statement not covered">function(callback) {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">47</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    setTimeout(callback, 0);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">48</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  }</span><span>;</span></code></div>
<div class="source-line"><span class="line-number ">49</span><span class="line-counter cline-no">！</span><code><span class="cstat-no" title="statement not covered"><br/></span><span></span></code></div>
<div class="source-line"><span class="line-number ">50</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  // upgrade polyfill to use postMessage</span><span></span></code></div>
<div class="source-line"><span class="line-number ">51</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  if(typeof window !== &#39;undefined&#39; &amp;&amp;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">52</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    typeof window.postMessage === &#39;function&#39;</span><span>) </span><span class="cstat-no" title="statement not covered">{</span><span></span></code></div>
<div class="source-line"><span class="line-number ">53</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    var msg = &#39;forge.setImmediate&#39;;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">54</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    var callbacks = [];</span><span></span></code></div>
<div class="source-line"><span class="line-number ">55</span><span class="line-counter cline-no">！</span><code><span>    util.setImmediate = </span><span class="cstat-no" title="statement not covered">function(callback) {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">56</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">      callbacks.push(callback);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">57</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">      // only send message when one hasn&#39;t been sent in</span><span></span></code></div>
<div class="source-line"><span class="line-number ">58</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">      // the current turn of the event loop</span><span></span></code></div>
<div class="source-line"><span class="line-number ">59</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">      if(callbacks.length === 1) {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">60</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">        window.postMessage(msg, &#39;*&#39;);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">61</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">      }</span><span></span></code></div>
<div class="source-line"><span class="line-number ">62</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    }</span><span>;</span></code></div>
<div class="source-line"><span class="line-number ">63</span><span class="line-counter cline-no">！</span><code><span>    </span><span class="cstat-no" title="statement not covered">function handler(event) {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">64</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">      if(event.source === window &amp;&amp; event.data === msg) {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">65</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">        event.stopPropagation();</span><span></span></code></div>
<div class="source-line"><span class="line-number ">66</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">        var copy = callbacks.slice();</span><span></span></code></div>
<div class="source-line"><span class="line-number ">67</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">        callbacks.length = 0;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">68</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">        copy.forEach(function(callback) {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">69</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">          callback();</span><span></span></code></div>
<div class="source-line"><span class="line-number ">70</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">        });</span><span></span></code></div>
<div class="source-line"><span class="line-number ">71</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">      }</span><span></span></code></div>
<div class="source-line"><span class="line-number ">72</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    }</span><span></span></code></div>
<div class="source-line"><span class="line-number ">73</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    window.addEventListener(&#39;message&#39;, handler, true);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">74</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  }</span><span></span></code></div>
<div class="source-line"><span class="line-number ">75</span><span class="line-counter cline-no">！</span><code><span class="cstat-no" title="statement not covered"><br/></span><span></span></code></div>
<div class="source-line"><span class="line-number ">76</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  // upgrade polyfill to use MutationObserver</span><span></span></code></div>
<div class="source-line"><span class="line-number ">77</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  if(typeof MutationObserver !== &#39;undefined&#39;) {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">78</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    // polyfill with MutationObserver</span><span></span></code></div>
<div class="source-line"><span class="line-number ">79</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    var now = Date.now();</span><span></span></code></div>
<div class="source-line"><span class="line-number ">80</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    var attr = true;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">81</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    var div = document.createElement(&#39;div&#39;);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">82</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    var callbacks = [];</span><span></span></code></div>
<div class="source-line"><span class="line-number ">83</span><span class="line-counter cline-no">！</span><code><span>    new MutationObserver(</span><span class="cstat-no" title="statement not covered">function() {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">84</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">      var copy = callbacks.slice();</span><span></span></code></div>
<div class="source-line"><span class="line-number ">85</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">      callbacks.length = 0;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">86</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">      copy.forEach(function(callback) {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">87</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">        callback();</span><span></span></code></div>
<div class="source-line"><span class="line-number ">88</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">      });</span><span></span></code></div>
<div class="source-line"><span class="line-number ">89</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    }</span><span>).observe(div, {attributes: true});</span></code></div>
<div class="source-line"><span class="line-number ">90</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    var oldSetImmediate = util.setImmediate;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">91</span><span class="line-counter cline-no">！</span><code><span>    util.setImmediate = </span><span class="cstat-no" title="statement not covered">function(callback) {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">92</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">      if(Date.now() - now &gt; 15) {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">93</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">        now = Date.now();</span><span></span></code></div>
<div class="source-line"><span class="line-number ">94</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">        oldSetImmediate(callback);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">95</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">      } else {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">96</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">        callbacks.push(callback);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">97</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">        // only trigger observer when it hasn&#39;t been triggered in</span><span></span></code></div>
<div class="source-line"><span class="line-number ">98</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">        // the current turn of the event loop</span><span></span></code></div>
<div class="source-line"><span class="line-number ">99</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">        if(callbacks.length === 1) {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">100</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">          div.setAttribute(&#39;a&#39;, attr = !attr);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">101</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">        }</span><span></span></code></div>
<div class="source-line"><span class="line-number ">102</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">      }</span><span></span></code></div>
<div class="source-line"><span class="line-number ">103</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    }</span><span>;</span></code></div>
<div class="source-line"><span class="line-number ">104</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  }</span><span></span></code></div>
<div class="source-line"><span class="line-number ">105</span><span class="line-counter cline-no">！</span><code><span class="cstat-no" title="statement not covered"><br/></span><span></span></code></div>
<div class="source-line"><span class="line-number ">106</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  util.nextTick = util.setImmediate;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">107</span><span class="line-counter cline-yes">&nbsp</span><code>})();</code></div>
<div class="source-line"><span class="line-number ">108</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<div class="source-line"><span class="line-number ">109</span><span class="line-counter cline-yes">&nbsp</span><code>// check if running under Node.js</code></div>
<div class="source-line"><span class="line-number ">110</span><span class="line-counter cline-yes">&nbsp</span><code>util.isNodejs =</code></div>
<div class="source-line"><span class="line-number ">111</span><span class="line-counter cline-yes">&nbsp</span><code>  typeof process !== &#39;undefined&#39; &amp;&amp; process.versions &amp;&amp; process.versions.node;</code></div>
<div class="source-line"><span class="line-number ">112</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<div class="source-line"><span class="line-number ">113</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<div class="source-line"><span class="line-number ">114</span><span class="line-counter cline-yes">&nbsp</span><code>// &#39;self&#39; will also work in Web Workers (instance of WorkerGlobalScope) while</code></div>
<div class="source-line"><span class="line-number ">115</span><span class="line-counter cline-yes">&nbsp</span><code>// it will point to `window` in the main thread.</code></div>
<div class="source-line"><span class="line-number ">116</span><span class="line-counter cline-yes">&nbsp</span><code>// To remain compatible with older browsers, we fall back to &#39;window&#39; if &#39;self&#39;</code></div>
<div class="source-line"><span class="line-number ">117</span><span class="line-counter cline-yes">&nbsp</span><code>// is not available.</code></div>
<div class="source-line"><span class="line-number ">118</span><span class="line-counter cline-yes">&nbsp</span><code>util.globalScope = (function() {</code></div>
<div class="source-line"><span class="line-number ">119</span><span class="line-counter cline-yes">&nbsp</span><code>  if(util.isNodejs) {</code></div>
<div class="source-line"><span class="line-number ">120</span><span class="line-counter cline-yes">&nbsp</span><code>    return global;</code></div>
<div class="source-line"><span class="line-number ">121</span><span class="line-counter cline-yes">&nbsp</span><code>  }</code></div>
<div class="source-line"><span class="line-number ">122</span><span class="line-counter cline-no">！</span><code><span class="cstat-no" title="statement not covered"><br/></span><span></span></code></div>
<div class="source-line"><span class="line-number ">123</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  return typeof self === &#39;undefined&#39; ? window</span><span> </span><span class="cstat-no" title="statement not covered">: self</span><span>;</span></code></div>
<div class="source-line"><span class="line-number ">124</span><span class="line-counter cline-yes">&nbsp</span><code>})();</code></div>
<div class="source-line"><span class="line-number ">125</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<div class="source-line"><span class="line-number ">126</span><span class="line-counter cline-yes">&nbsp</span><code>// define isArray</code></div>
<div class="source-line"><span class="line-number ">127</span><span class="line-counter cline-no">！</span><code><span>util.isArray = Array.isArray || </span><span class="cstat-no" title="statement not covered">function(x) {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">128</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  return Object.prototype.toString.call(x) === &#39;[object Array]&#39;;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">129</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">}</span><span>;</span></code></div>
<div class="source-line"><span class="line-number ">130</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<div class="source-line"><span class="line-number ">131</span><span class="line-counter cline-yes">&nbsp</span><code>// define isArrayBuffer</code></div>
<div class="source-line"><span class="line-number ">132</span><span class="line-counter cline-yes">&nbsp</span><code>util.isArrayBuffer = function(x) {</code></div>
<div class="source-line"><span class="line-number ">133</span><span class="line-counter cline-yes">&nbsp</span><code>  return typeof ArrayBuffer !== &#39;undefined&#39; &amp;&amp; x instanceof ArrayBuffer;</code></div>
<div class="source-line"><span class="line-number ">134</span><span class="line-counter cline-yes">&nbsp</span><code>};</code></div>
<div class="source-line"><span class="line-number ">135</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<div class="source-line"><span class="line-number ">136</span><span class="line-counter cline-yes">&nbsp</span><code>// define isArrayBufferView</code></div>
<div class="source-line"><span class="line-number ">137</span><span class="line-counter cline-yes">&nbsp</span><code>util.isArrayBufferView = function(x) {</code></div>
<div class="source-line"><span class="line-number ">138</span><span class="line-counter cline-yes">&nbsp</span><code>  return x &amp;&amp; util.isArrayBuffer(x.buffer) &amp;&amp; x.byteLength !== undefined;</code></div>
<div class="source-line"><span class="line-number ">139</span><span class="line-counter cline-yes">&nbsp</span><code>};</code></div>
<div class="source-line"><span class="line-number ">140</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<div class="source-line"><span class="line-number ">141</span><span class="line-counter cline-yes">&nbsp</span><code>/**</code></div>
<div class="source-line"><span class="line-number ">142</span><span class="line-counter cline-yes">&nbsp</span><code> * Ensure a bits param is 8, 16, 24, or 32. Used to validate input for</code></div>
<div class="source-line"><span class="line-number ">143</span><span class="line-counter cline-yes">&nbsp</span><code> * algorithms where bit manipulation, JavaScript limitations, and/or algorithm</code></div>
<div class="source-line"><span class="line-number ">144</span><span class="line-counter cline-yes">&nbsp</span><code> * design only allow for byte operations of a limited size.</code></div>
<div class="source-line"><span class="line-number ">145</span><span class="line-counter cline-yes">&nbsp</span><code> *</code></div>
<div class="source-line"><span class="line-number ">146</span><span class="line-counter cline-yes">&nbsp</span><code> * @param n number of bits.</code></div>
<div class="source-line"><span class="line-number ">147</span><span class="line-counter cline-yes">&nbsp</span><code> *</code></div>
<div class="source-line"><span class="line-number ">148</span><span class="line-counter cline-yes">&nbsp</span><code> * Throw Error if n invalid.</code></div>
<div class="source-line"><span class="line-number ">149</span><span class="line-counter cline-yes">&nbsp</span><code> */</code></div>
<div class="source-line"><span class="line-number ">150</span><span class="line-counter cline-yes">&nbsp</span><code>function _checkBitsParam(n) {</code></div>
<div class="source-line"><span class="line-number ">151</span><span class="line-counter cline-no">！</span><code><span>  if(!(n === 8 || n === 16 </span><span class="cstat-no" title="statement not covered">|| n === 24</span><span> || n === 32)) {</span></code></div>
<div class="source-line"><span class="line-number ">152</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    throw new Error(&#39;Only 8, 16, 24, or 32 bits supported: &#39; + n);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">153</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  }</span><span></span></code></div>
<div class="source-line"><span class="line-number ">154</span><span class="line-counter cline-yes">&nbsp</span><code>}</code></div>
<div class="source-line"><span class="line-number ">155</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<div class="source-line"><span class="line-number ">156</span><span class="line-counter cline-yes">&nbsp</span><code>// TODO: set ByteBuffer to best available backing</code></div>
<div class="source-line"><span class="line-number ">157</span><span class="line-counter cline-yes">&nbsp</span><code>util.ByteBuffer = ByteStringBuffer;</code></div>
<div class="source-line"><span class="line-number ">158</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<div class="source-line"><span class="line-number ">159</span><span class="line-counter cline-yes">&nbsp</span><code>/** Buffer w/BinaryString backing */</code></div>
<div class="source-line"><span class="line-number ">160</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<div class="source-line"><span class="line-number ">161</span><span class="line-counter cline-yes">&nbsp</span><code>/**</code></div>
<div class="source-line"><span class="line-number ">162</span><span class="line-counter cline-yes">&nbsp</span><code> * Constructor for a binary string backed byte buffer.</code></div>
<div class="source-line"><span class="line-number ">163</span><span class="line-counter cline-yes">&nbsp</span><code> *</code></div>
<div class="source-line"><span class="line-number ">164</span><span class="line-counter cline-yes">&nbsp</span><code> * @param [b] the bytes to wrap (either encoded as string, one byte per</code></div>
<div class="source-line"><span class="line-number ">165</span><span class="line-counter cline-yes">&nbsp</span><code> *          character, or as an ArrayBuffer or Typed Array).</code></div>
<div class="source-line"><span class="line-number ">166</span><span class="line-counter cline-yes">&nbsp</span><code> */</code></div>
<div class="source-line"><span class="line-number ">167</span><span class="line-counter cline-yes">&nbsp</span><code>function ByteStringBuffer(b) {</code></div>
<div class="source-line"><span class="line-number ">168</span><span class="line-counter cline-yes">&nbsp</span><code>  // TODO: update to match DataBuffer API</code></div>
<div class="source-line"><span class="line-number ">169</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<div class="source-line"><span class="line-number ">170</span><span class="line-counter cline-yes">&nbsp</span><code>  // the data in this buffer</code></div>
<div class="source-line"><span class="line-number ">171</span><span class="line-counter cline-yes">&nbsp</span><code>  this.data = &#39;&#39;;</code></div>
<div class="source-line"><span class="line-number ">172</span><span class="line-counter cline-yes">&nbsp</span><code>  // the pointer for reading from this buffer</code></div>
<div class="source-line"><span class="line-number ">173</span><span class="line-counter cline-yes">&nbsp</span><code>  this.read = 0;</code></div>
<div class="source-line"><span class="line-number ">174</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<div class="source-line"><span class="line-number ">175</span><span class="line-counter cline-yes">&nbsp</span><code>  if(typeof b === &#39;string&#39;) {</code></div>
<div class="source-line"><span class="line-number ">176</span><span class="line-counter cline-yes">&nbsp</span><code>    this.data = b;</code></div>
<div class="source-line"><span class="line-number ">177</span><span class="line-counter cline-yes">&nbsp</span><code>  } else if(util.isArrayBuffer(b) || util.isArrayBufferView(b)) {</code></div>
<div class="source-line"><span class="line-number ">178</span><span class="line-counter cline-yes">&nbsp</span><code>    if(typeof Buffer !== &#39;undefined&#39; &amp;&amp; b instanceof Buffer) {</code></div>
<div class="source-line"><span class="line-number ">179</span><span class="line-counter cline-yes">&nbsp</span><code>      this.data = b.toString(&#39;binary&#39;);</code></div>
<div class="source-line"><span class="line-number ">180</span><span class="line-counter cline-yes">&nbsp</span><code>    } else {</code></div>
<div class="source-line"><span class="line-number ">181</span><span class="line-counter cline-yes">&nbsp</span><code>      // convert native buffer to forge buffer</code></div>
<div class="source-line"><span class="line-number ">182</span><span class="line-counter cline-yes">&nbsp</span><code>      // FIXME: support native buffers internally instead</code></div>
<div class="source-line"><span class="line-number ">183</span><span class="line-counter cline-yes">&nbsp</span><code>      var arr = new Uint8Array(b);</code></div>
<div class="source-line"><span class="line-number ">184</span><span class="line-counter cline-yes">&nbsp</span><code>      try {</code></div>
<div class="source-line"><span class="line-number ">185</span><span class="line-counter cline-yes">&nbsp</span><code>        this.data = String.fromCharCode.apply(null, arr);</code></div>
<div class="source-line"><span class="line-number ">186</span><span class="line-counter cline-no">！</span><code><span>      } </span><span class="cstat-no" title="statement not covered">catch(e) {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">187</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">        for(var i = 0; i &lt; arr.length; ++i) {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">188</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">          this.putByte(arr[i]);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">189</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">        }</span><span></span></code></div>
<div class="source-line"><span class="line-number ">190</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">      }</span><span></span></code></div>
<div class="source-line"><span class="line-number ">191</span><span class="line-counter cline-yes">&nbsp</span><code>    }</code></div>
<div class="source-line"><span class="line-number ">192</span><span class="line-counter cline-yes">&nbsp</span><code>  } else if(b instanceof ByteStringBuffer ||</code></div>
<div class="source-line"><span class="line-number ">193</span><span class="line-counter cline-no">！</span><code><span>    (typeof b === &#39;object&#39; </span><span class="cstat-no" title="statement not covered">&amp;&amp; typeof b.data === &#39;string&#39;</span><span> </span><span class="cstat-no" title="statement not covered">&amp;&amp;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">194</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    typeof b.read === &#39;number&#39;</span><span>)) </span><span class="cstat-no" title="statement not covered">{</span><span></span></code></div>
<div class="source-line"><span class="line-number ">195</span><span class="line-counter cline-yes">&nbsp</span><code>    // copy existing buffer</code></div>
<div class="source-line"><span class="line-number ">196</span><span class="line-counter cline-yes">&nbsp</span><code>    this.data = b.data;</code></div>
<div class="source-line"><span class="line-number ">197</span><span class="line-counter cline-yes">&nbsp</span><code>    this.read = b.read;</code></div>
<div class="source-line"><span class="line-number ">198</span><span class="line-counter cline-yes">&nbsp</span><code>  }</code></div>
<div class="source-line"><span class="line-number ">199</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<div class="source-line"><span class="line-number ">200</span><span class="line-counter cline-yes">&nbsp</span><code>  // used for v8 optimization</code></div>
<div class="source-line"><span class="line-number ">201</span><span class="line-counter cline-yes">&nbsp</span><code>  this._constructedStringLength = 0;</code></div>
<div class="source-line"><span class="line-number ">202</span><span class="line-counter cline-yes">&nbsp</span><code>}</code></div>
<div class="source-line"><span class="line-number ">203</span><span class="line-counter cline-yes">&nbsp</span><code>util.ByteStringBuffer = ByteStringBuffer;</code></div>
<div class="source-line"><span class="line-number ">204</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<div class="source-line"><span class="line-number ">205</span><span class="line-counter cline-yes">&nbsp</span><code>/* Note: This is an optimization for V8-based browsers. When V8 concatenates</code></div>
<div class="source-line"><span class="line-number ">206</span><span class="line-counter cline-yes">&nbsp</span><code>  a string, the strings are only joined logically using a &quot;cons string&quot; or</code></div>
<div class="source-line"><span class="line-number ">207</span><span class="line-counter cline-yes">&nbsp</span><code>  &quot;constructed/concatenated string&quot;. These containers keep references to one</code></div>
<div class="source-line"><span class="line-number ">208</span><span class="line-counter cline-yes">&nbsp</span><code>  another and can result in very large memory usage. For example, if a 2MB</code></div>
<div class="source-line"><span class="line-number ">209</span><span class="line-counter cline-yes">&nbsp</span><code>  string is constructed by concatenating 4 bytes together at a time, the</code></div>
<div class="source-line"><span class="line-number ">210</span><span class="line-counter cline-yes">&nbsp</span><code>  memory usage will be ~44MB; so ~22x increase. The strings are only joined</code></div>
<div class="source-line"><span class="line-number ">211</span><span class="line-counter cline-yes">&nbsp</span><code>  together when an operation requiring their joining takes place, such as</code></div>
<div class="source-line"><span class="line-number ">212</span><span class="line-counter cline-yes">&nbsp</span><code>  substr(). This function is called when adding data to this buffer to ensure</code></div>
<div class="source-line"><span class="line-number ">213</span><span class="line-counter cline-yes">&nbsp</span><code>  these types of strings are periodically joined to reduce the memory</code></div>
<div class="source-line"><span class="line-number ">214</span><span class="line-counter cline-yes">&nbsp</span><code>  footprint. */</code></div>
<div class="source-line"><span class="line-number ">215</span><span class="line-counter cline-yes">&nbsp</span><code>var _MAX_CONSTRUCTED_STRING_LENGTH = 4096;</code></div>
<div class="source-line"><span class="line-number ">216</span><span class="line-counter cline-yes">&nbsp</span><code>util.ByteStringBuffer.prototype._optimizeConstructedString = function(x) {</code></div>
<div class="source-line"><span class="line-number ">217</span><span class="line-counter cline-yes">&nbsp</span><code>  this._constructedStringLength += x;</code></div>
<div class="source-line"><span class="line-number ">218</span><span class="line-counter cline-no">！</span><code><span>  if(this._constructedStringLength &gt; _MAX_CONSTRUCTED_STRING_LENGTH) </span><span class="cstat-no" title="statement not covered">{</span><span></span></code></div>
<div class="source-line"><span class="line-number ">219</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    // this substr() should cause the constructed string to join</span><span></span></code></div>
<div class="source-line"><span class="line-number ">220</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    this.data.substr(0, 1);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">221</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    this._constructedStringLength = 0;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">222</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  }</span><span></span></code></div>
<div class="source-line"><span class="line-number ">223</span><span class="line-counter cline-yes">&nbsp</span><code>};</code></div>
<div class="source-line"><span class="line-number ">224</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<div class="source-line"><span class="line-number ">225</span><span class="line-counter cline-yes">&nbsp</span><code>/**</code></div>
<div class="source-line"><span class="line-number ">226</span><span class="line-counter cline-yes">&nbsp</span><code> * Gets the number of bytes in this buffer.</code></div>
<div class="source-line"><span class="line-number ">227</span><span class="line-counter cline-yes">&nbsp</span><code> *</code></div>
<div class="source-line"><span class="line-number ">228</span><span class="line-counter cline-yes">&nbsp</span><code> * @return the number of bytes in this buffer.</code></div>
<div class="source-line"><span class="line-number ">229</span><span class="line-counter cline-yes">&nbsp</span><code> */</code></div>
<div class="source-line"><span class="line-number ">230</span><span class="line-counter cline-yes">&nbsp</span><code>util.ByteStringBuffer.prototype.length = function() {</code></div>
<div class="source-line"><span class="line-number ">231</span><span class="line-counter cline-yes">&nbsp</span><code>  return this.data.length - this.read;</code></div>
<div class="source-line"><span class="line-number ">232</span><span class="line-counter cline-yes">&nbsp</span><code>};</code></div>
<div class="source-line"><span class="line-number ">233</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<div class="source-line"><span class="line-number ">234</span><span class="line-counter cline-yes">&nbsp</span><code>/**</code></div>
<div class="source-line"><span class="line-number ">235</span><span class="line-counter cline-yes">&nbsp</span><code> * Gets whether or not this buffer is empty.</code></div>
<div class="source-line"><span class="line-number ">236</span><span class="line-counter cline-yes">&nbsp</span><code> *</code></div>
<div class="source-line"><span class="line-number ">237</span><span class="line-counter cline-yes">&nbsp</span><code> * @return true if this buffer is empty, false if not.</code></div>
<div class="source-line"><span class="line-number ">238</span><span class="line-counter cline-yes">&nbsp</span><code> */</code></div>
<div class="source-line"><span class="line-number ">239</span><span class="line-counter cline-no">！</span><code><span>util.ByteStringBuffer.prototype.isEmpty = </span><span class="cstat-no" title="statement not covered">function() {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">240</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  return this.length() &lt;= 0;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">241</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">}</span><span>;</span></code></div>
<div class="source-line"><span class="line-number ">242</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<div class="source-line"><span class="line-number ">243</span><span class="line-counter cline-yes">&nbsp</span><code>/**</code></div>
<div class="source-line"><span class="line-number ">244</span><span class="line-counter cline-yes">&nbsp</span><code> * Puts a byte in this buffer.</code></div>
<div class="source-line"><span class="line-number ">245</span><span class="line-counter cline-yes">&nbsp</span><code> *</code></div>
<div class="source-line"><span class="line-number ">246</span><span class="line-counter cline-yes">&nbsp</span><code> * @param b the byte to put.</code></div>
<div class="source-line"><span class="line-number ">247</span><span class="line-counter cline-yes">&nbsp</span><code> *</code></div>
<div class="source-line"><span class="line-number ">248</span><span class="line-counter cline-yes">&nbsp</span><code> * @return this buffer.</code></div>
<div class="source-line"><span class="line-number ">249</span><span class="line-counter cline-yes">&nbsp</span><code> */</code></div>
<div class="source-line"><span class="line-number ">250</span><span class="line-counter cline-yes">&nbsp</span><code>util.ByteStringBuffer.prototype.putByte = function(b) {</code></div>
<div class="source-line"><span class="line-number ">251</span><span class="line-counter cline-yes">&nbsp</span><code>  return this.putBytes(String.fromCharCode(b));</code></div>
<div class="source-line"><span class="line-number ">252</span><span class="line-counter cline-yes">&nbsp</span><code>};</code></div>
<div class="source-line"><span class="line-number ">253</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<div class="source-line"><span class="line-number ">254</span><span class="line-counter cline-yes">&nbsp</span><code>/**</code></div>
<div class="source-line"><span class="line-number ">255</span><span class="line-counter cline-yes">&nbsp</span><code> * Puts a byte in this buffer N times.</code></div>
<div class="source-line"><span class="line-number ">256</span><span class="line-counter cline-yes">&nbsp</span><code> *</code></div>
<div class="source-line"><span class="line-number ">257</span><span class="line-counter cline-yes">&nbsp</span><code> * @param b the byte to put.</code></div>
<div class="source-line"><span class="line-number ">258</span><span class="line-counter cline-yes">&nbsp</span><code> * @param n the number of bytes of value b to put.</code></div>
<div class="source-line"><span class="line-number ">259</span><span class="line-counter cline-yes">&nbsp</span><code> *</code></div>
<div class="source-line"><span class="line-number ">260</span><span class="line-counter cline-yes">&nbsp</span><code> * @return this buffer.</code></div>
<div class="source-line"><span class="line-number ">261</span><span class="line-counter cline-yes">&nbsp</span><code> */</code></div>
<div class="source-line"><span class="line-number ">262</span><span class="line-counter cline-yes">&nbsp</span><code>util.ByteStringBuffer.prototype.fillWithByte = function(b, n) {</code></div>
<div class="source-line"><span class="line-number ">263</span><span class="line-counter cline-yes">&nbsp</span><code>  b = String.fromCharCode(b);</code></div>
<div class="source-line"><span class="line-number ">264</span><span class="line-counter cline-yes">&nbsp</span><code>  var d = this.data;</code></div>
<div class="source-line"><span class="line-number ">265</span><span class="line-counter cline-yes">&nbsp</span><code>  while(n &gt; 0) {</code></div>
<div class="source-line"><span class="line-number ">266</span><span class="line-counter cline-yes">&nbsp</span><code>    if(n &amp; 1) {</code></div>
<div class="source-line"><span class="line-number ">267</span><span class="line-counter cline-yes">&nbsp</span><code>      d += b;</code></div>
<div class="source-line"><span class="line-number ">268</span><span class="line-counter cline-yes">&nbsp</span><code>    }</code></div>
<div class="source-line"><span class="line-number ">269</span><span class="line-counter cline-yes">&nbsp</span><code>    n &gt;&gt;&gt;= 1;</code></div>
<div class="source-line"><span class="line-number ">270</span><span class="line-counter cline-yes">&nbsp</span><code>    if(n &gt; 0) {</code></div>
<div class="source-line"><span class="line-number ">271</span><span class="line-counter cline-yes">&nbsp</span><code>      b += b;</code></div>
<div class="source-line"><span class="line-number ">272</span><span class="line-counter cline-yes">&nbsp</span><code>    }</code></div>
<div class="source-line"><span class="line-number ">273</span><span class="line-counter cline-yes">&nbsp</span><code>  }</code></div>
<div class="source-line"><span class="line-number ">274</span><span class="line-counter cline-yes">&nbsp</span><code>  this.data = d;</code></div>
<div class="source-line"><span class="line-number ">275</span><span class="line-counter cline-yes">&nbsp</span><code>  this._optimizeConstructedString(n);</code></div>
<div class="source-line"><span class="line-number ">276</span><span class="line-counter cline-yes">&nbsp</span><code>  return this;</code></div>
<div class="source-line"><span class="line-number ">277</span><span class="line-counter cline-yes">&nbsp</span><code>};</code></div>
<div class="source-line"><span class="line-number ">278</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<div class="source-line"><span class="line-number ">279</span><span class="line-counter cline-yes">&nbsp</span><code>/**</code></div>
<div class="source-line"><span class="line-number ">280</span><span class="line-counter cline-yes">&nbsp</span><code> * Puts bytes in this buffer.</code></div>
<div class="source-line"><span class="line-number ">281</span><span class="line-counter cline-yes">&nbsp</span><code> *</code></div>
<div class="source-line"><span class="line-number ">282</span><span class="line-counter cline-yes">&nbsp</span><code> * @param bytes the bytes (as a binary encoded string) to put.</code></div>
<div class="source-line"><span class="line-number ">283</span><span class="line-counter cline-yes">&nbsp</span><code> *</code></div>
<div class="source-line"><span class="line-number ">284</span><span class="line-counter cline-yes">&nbsp</span><code> * @return this buffer.</code></div>
<div class="source-line"><span class="line-number ">285</span><span class="line-counter cline-yes">&nbsp</span><code> */</code></div>
<div class="source-line"><span class="line-number ">286</span><span class="line-counter cline-yes">&nbsp</span><code>util.ByteStringBuffer.prototype.putBytes = function(bytes) {</code></div>
<div class="source-line"><span class="line-number ">287</span><span class="line-counter cline-yes">&nbsp</span><code>  this.data += bytes;</code></div>
<div class="source-line"><span class="line-number ">288</span><span class="line-counter cline-yes">&nbsp</span><code>  this._optimizeConstructedString(bytes.length);</code></div>
<div class="source-line"><span class="line-number ">289</span><span class="line-counter cline-yes">&nbsp</span><code>  return this;</code></div>
<div class="source-line"><span class="line-number ">290</span><span class="line-counter cline-yes">&nbsp</span><code>};</code></div>
<div class="source-line"><span class="line-number ">291</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<div class="source-line"><span class="line-number ">292</span><span class="line-counter cline-yes">&nbsp</span><code>/**</code></div>
<div class="source-line"><span class="line-number ">293</span><span class="line-counter cline-yes">&nbsp</span><code> * Puts a UTF-16 encoded string into this buffer.</code></div>
<div class="source-line"><span class="line-number ">294</span><span class="line-counter cline-yes">&nbsp</span><code> *</code></div>
<div class="source-line"><span class="line-number ">295</span><span class="line-counter cline-yes">&nbsp</span><code> * @param str the string to put.</code></div>
<div class="source-line"><span class="line-number ">296</span><span class="line-counter cline-yes">&nbsp</span><code> *</code></div>
<div class="source-line"><span class="line-number ">297</span><span class="line-counter cline-yes">&nbsp</span><code> * @return this buffer.</code></div>
<div class="source-line"><span class="line-number ">298</span><span class="line-counter cline-yes">&nbsp</span><code> */</code></div>
<div class="source-line"><span class="line-number ">299</span><span class="line-counter cline-yes">&nbsp</span><code>util.ByteStringBuffer.prototype.putString = function(str) {</code></div>
<div class="source-line"><span class="line-number ">300</span><span class="line-counter cline-yes">&nbsp</span><code>  return this.putBytes(util.encodeUtf8(str));</code></div>
<div class="source-line"><span class="line-number ">301</span><span class="line-counter cline-yes">&nbsp</span><code>};</code></div>
<div class="source-line"><span class="line-number ">302</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<div class="source-line"><span class="line-number ">303</span><span class="line-counter cline-yes">&nbsp</span><code>/**</code></div>
<div class="source-line"><span class="line-number ">304</span><span class="line-counter cline-yes">&nbsp</span><code> * Puts a 16-bit integer in this buffer in big-endian order.</code></div>
<div class="source-line"><span class="line-number ">305</span><span class="line-counter cline-yes">&nbsp</span><code> *</code></div>
<div class="source-line"><span class="line-number ">306</span><span class="line-counter cline-yes">&nbsp</span><code> * @param i the 16-bit integer.</code></div>
<div class="source-line"><span class="line-number ">307</span><span class="line-counter cline-yes">&nbsp</span><code> *</code></div>
<div class="source-line"><span class="line-number ">308</span><span class="line-counter cline-yes">&nbsp</span><code> * @return this buffer.</code></div>
<div class="source-line"><span class="line-number ">309</span><span class="line-counter cline-yes">&nbsp</span><code> */</code></div>
<div class="source-line"><span class="line-number ">310</span><span class="line-counter cline-no">！</span><code><span>util.ByteStringBuffer.prototype.putInt16 = </span><span class="cstat-no" title="statement not covered">function(i) {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">311</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  return this.putBytes(</span><span></span></code></div>
<div class="source-line"><span class="line-number ">312</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    String.fromCharCode(i &gt;&gt; 8 &amp; 0xFF) +</span><span></span></code></div>
<div class="source-line"><span class="line-number ">313</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    String.fromCharCode(i &amp; 0xFF));</span><span></span></code></div>
<div class="source-line"><span class="line-number ">314</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">}</span><span>;</span></code></div>
<div class="source-line"><span class="line-number ">315</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<div class="source-line"><span class="line-number ">316</span><span class="line-counter cline-yes">&nbsp</span><code>/**</code></div>
<div class="source-line"><span class="line-number ">317</span><span class="line-counter cline-yes">&nbsp</span><code> * Puts a 24-bit integer in this buffer in big-endian order.</code></div>
<div class="source-line"><span class="line-number ">318</span><span class="line-counter cline-yes">&nbsp</span><code> *</code></div>
<div class="source-line"><span class="line-number ">319</span><span class="line-counter cline-yes">&nbsp</span><code> * @param i the 24-bit integer.</code></div>
<div class="source-line"><span class="line-number ">320</span><span class="line-counter cline-yes">&nbsp</span><code> *</code></div>
<div class="source-line"><span class="line-number ">321</span><span class="line-counter cline-yes">&nbsp</span><code> * @return this buffer.</code></div>
<div class="source-line"><span class="line-number ">322</span><span class="line-counter cline-yes">&nbsp</span><code> */</code></div>
<div class="source-line"><span class="line-number ">323</span><span class="line-counter cline-no">！</span><code><span>util.ByteStringBuffer.prototype.putInt24 = </span><span class="cstat-no" title="statement not covered">function(i) {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">324</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  return this.putBytes(</span><span></span></code></div>
<div class="source-line"><span class="line-number ">325</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    String.fromCharCode(i &gt;&gt; 16 &amp; 0xFF) +</span><span></span></code></div>
<div class="source-line"><span class="line-number ">326</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    String.fromCharCode(i &gt;&gt; 8 &amp; 0xFF) +</span><span></span></code></div>
<div class="source-line"><span class="line-number ">327</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    String.fromCharCode(i &amp; 0xFF));</span><span></span></code></div>
<div class="source-line"><span class="line-number ">328</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">}</span><span>;</span></code></div>
<div class="source-line"><span class="line-number ">329</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<div class="source-line"><span class="line-number ">330</span><span class="line-counter cline-yes">&nbsp</span><code>/**</code></div>
<div class="source-line"><span class="line-number ">331</span><span class="line-counter cline-yes">&nbsp</span><code> * Puts a 32-bit integer in this buffer in big-endian order.</code></div>
<div class="source-line"><span class="line-number ">332</span><span class="line-counter cline-yes">&nbsp</span><code> *</code></div>
<div class="source-line"><span class="line-number ">333</span><span class="line-counter cline-yes">&nbsp</span><code> * @param i the 32-bit integer.</code></div>
<div class="source-line"><span class="line-number ">334</span><span class="line-counter cline-yes">&nbsp</span><code> *</code></div>
<div class="source-line"><span class="line-number ">335</span><span class="line-counter cline-yes">&nbsp</span><code> * @return this buffer.</code></div>
<div class="source-line"><span class="line-number ">336</span><span class="line-counter cline-yes">&nbsp</span><code> */</code></div>
<div class="source-line"><span class="line-number ">337</span><span class="line-counter cline-yes">&nbsp</span><code>util.ByteStringBuffer.prototype.putInt32 = function(i) {</code></div>
<div class="source-line"><span class="line-number ">338</span><span class="line-counter cline-yes">&nbsp</span><code>  return this.putBytes(</code></div>
<div class="source-line"><span class="line-number ">339</span><span class="line-counter cline-yes">&nbsp</span><code>    String.fromCharCode(i &gt;&gt; 24 &amp; 0xFF) +</code></div>
<div class="source-line"><span class="line-number ">340</span><span class="line-counter cline-yes">&nbsp</span><code>    String.fromCharCode(i &gt;&gt; 16 &amp; 0xFF) +</code></div>
<div class="source-line"><span class="line-number ">341</span><span class="line-counter cline-yes">&nbsp</span><code>    String.fromCharCode(i &gt;&gt; 8 &amp; 0xFF) +</code></div>
<div class="source-line"><span class="line-number ">342</span><span class="line-counter cline-yes">&nbsp</span><code>    String.fromCharCode(i &amp; 0xFF));</code></div>
<div class="source-line"><span class="line-number ">343</span><span class="line-counter cline-yes">&nbsp</span><code>};</code></div>
<div class="source-line"><span class="line-number ">344</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<div class="source-line"><span class="line-number ">345</span><span class="line-counter cline-yes">&nbsp</span><code>/**</code></div>
<div class="source-line"><span class="line-number ">346</span><span class="line-counter cline-yes">&nbsp</span><code> * Puts a 16-bit integer in this buffer in little-endian order.</code></div>
<div class="source-line"><span class="line-number ">347</span><span class="line-counter cline-yes">&nbsp</span><code> *</code></div>
<div class="source-line"><span class="line-number ">348</span><span class="line-counter cline-yes">&nbsp</span><code> * @param i the 16-bit integer.</code></div>
<div class="source-line"><span class="line-number ">349</span><span class="line-counter cline-yes">&nbsp</span><code> *</code></div>
<div class="source-line"><span class="line-number ">350</span><span class="line-counter cline-yes">&nbsp</span><code> * @return this buffer.</code></div>
<div class="source-line"><span class="line-number ">351</span><span class="line-counter cline-yes">&nbsp</span><code> */</code></div>
<div class="source-line"><span class="line-number ">352</span><span class="line-counter cline-no">！</span><code><span>util.ByteStringBuffer.prototype.putInt16Le = </span><span class="cstat-no" title="statement not covered">function(i) {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">353</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  return this.putBytes(</span><span></span></code></div>
<div class="source-line"><span class="line-number ">354</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    String.fromCharCode(i &amp; 0xFF) +</span><span></span></code></div>
<div class="source-line"><span class="line-number ">355</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    String.fromCharCode(i &gt;&gt; 8 &amp; 0xFF));</span><span></span></code></div>
<div class="source-line"><span class="line-number ">356</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">}</span><span>;</span></code></div>
<div class="source-line"><span class="line-number ">357</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<div class="source-line"><span class="line-number ">358</span><span class="line-counter cline-yes">&nbsp</span><code>/**</code></div>
<div class="source-line"><span class="line-number ">359</span><span class="line-counter cline-yes">&nbsp</span><code> * Puts a 24-bit integer in this buffer in little-endian order.</code></div>
<div class="source-line"><span class="line-number ">360</span><span class="line-counter cline-yes">&nbsp</span><code> *</code></div>
<div class="source-line"><span class="line-number ">361</span><span class="line-counter cline-yes">&nbsp</span><code> * @param i the 24-bit integer.</code></div>
<div class="source-line"><span class="line-number ">362</span><span class="line-counter cline-yes">&nbsp</span><code> *</code></div>
<div class="source-line"><span class="line-number ">363</span><span class="line-counter cline-yes">&nbsp</span><code> * @return this buffer.</code></div>
<div class="source-line"><span class="line-number ">364</span><span class="line-counter cline-yes">&nbsp</span><code> */</code></div>
<div class="source-line"><span class="line-number ">365</span><span class="line-counter cline-no">！</span><code><span>util.ByteStringBuffer.prototype.putInt24Le = </span><span class="cstat-no" title="statement not covered">function(i) {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">366</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  return this.putBytes(</span><span></span></code></div>
<div class="source-line"><span class="line-number ">367</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    String.fromCharCode(i &amp; 0xFF) +</span><span></span></code></div>
<div class="source-line"><span class="line-number ">368</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    String.fromCharCode(i &gt;&gt; 8 &amp; 0xFF) +</span><span></span></code></div>
<div class="source-line"><span class="line-number ">369</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    String.fromCharCode(i &gt;&gt; 16 &amp; 0xFF));</span><span></span></code></div>
<div class="source-line"><span class="line-number ">370</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">}</span><span>;</span></code></div>
<div class="source-line"><span class="line-number ">371</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<div class="source-line"><span class="line-number ">372</span><span class="line-counter cline-yes">&nbsp</span><code>/**</code></div>
<div class="source-line"><span class="line-number ">373</span><span class="line-counter cline-yes">&nbsp</span><code> * Puts a 32-bit integer in this buffer in little-endian order.</code></div>
<div class="source-line"><span class="line-number ">374</span><span class="line-counter cline-yes">&nbsp</span><code> *</code></div>
<div class="source-line"><span class="line-number ">375</span><span class="line-counter cline-yes">&nbsp</span><code> * @param i the 32-bit integer.</code></div>
<div class="source-line"><span class="line-number ">376</span><span class="line-counter cline-yes">&nbsp</span><code> *</code></div>
<div class="source-line"><span class="line-number ">377</span><span class="line-counter cline-yes">&nbsp</span><code> * @return this buffer.</code></div>
<div class="source-line"><span class="line-number ">378</span><span class="line-counter cline-yes">&nbsp</span><code> */</code></div>
<div class="source-line"><span class="line-number ">379</span><span class="line-counter cline-no">！</span><code><span>util.ByteStringBuffer.prototype.putInt32Le = </span><span class="cstat-no" title="statement not covered">function(i) {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">380</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  return this.putBytes(</span><span></span></code></div>
<div class="source-line"><span class="line-number ">381</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    String.fromCharCode(i &amp; 0xFF) +</span><span></span></code></div>
<div class="source-line"><span class="line-number ">382</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    String.fromCharCode(i &gt;&gt; 8 &amp; 0xFF) +</span><span></span></code></div>
<div class="source-line"><span class="line-number ">383</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    String.fromCharCode(i &gt;&gt; 16 &amp; 0xFF) +</span><span></span></code></div>
<div class="source-line"><span class="line-number ">384</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    String.fromCharCode(i &gt;&gt; 24 &amp; 0xFF));</span><span></span></code></div>
<div class="source-line"><span class="line-number ">385</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">}</span><span>;</span></code></div>
<div class="source-line"><span class="line-number ">386</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<div class="source-line"><span class="line-number ">387</span><span class="line-counter cline-yes">&nbsp</span><code>/**</code></div>
<div class="source-line"><span class="line-number ">388</span><span class="line-counter cline-yes">&nbsp</span><code> * Puts an n-bit integer in this buffer in big-endian order.</code></div>
<div class="source-line"><span class="line-number ">389</span><span class="line-counter cline-yes">&nbsp</span><code> *</code></div>
<div class="source-line"><span class="line-number ">390</span><span class="line-counter cline-yes">&nbsp</span><code> * @param i the n-bit integer.</code></div>
<div class="source-line"><span class="line-number ">391</span><span class="line-counter cline-yes">&nbsp</span><code> * @param n the number of bits in the integer (8, 16, 24, or 32).</code></div>
<div class="source-line"><span class="line-number ">392</span><span class="line-counter cline-yes">&nbsp</span><code> *</code></div>
<div class="source-line"><span class="line-number ">393</span><span class="line-counter cline-yes">&nbsp</span><code> * @return this buffer.</code></div>
<div class="source-line"><span class="line-number ">394</span><span class="line-counter cline-yes">&nbsp</span><code> */</code></div>
<div class="source-line"><span class="line-number ">395</span><span class="line-counter cline-no">！</span><code><span>util.ByteStringBuffer.prototype.putInt = </span><span class="cstat-no" title="statement not covered">function(i, n) {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">396</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  _checkBitsParam(n);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">397</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  var bytes = &#39;&#39;;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">398</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  do {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">399</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    n -= 8;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">400</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    bytes += String.fromCharCode((i &gt;&gt; n) &amp; 0xFF);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">401</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  } while(n &gt; 0);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">402</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  return this.putBytes(bytes);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">403</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">}</span><span>;</span></code></div>
<div class="source-line"><span class="line-number ">404</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<div class="source-line"><span class="line-number ">405</span><span class="line-counter cline-yes">&nbsp</span><code>/**</code></div>
<div class="source-line"><span class="line-number ">406</span><span class="line-counter cline-yes">&nbsp</span><code> * Puts a signed n-bit integer in this buffer in big-endian order. Two&#39;s</code></div>
<div class="source-line"><span class="line-number ">407</span><span class="line-counter cline-yes">&nbsp</span><code> * complement representation is used.</code></div>
<div class="source-line"><span class="line-number ">408</span><span class="line-counter cline-yes">&nbsp</span><code> *</code></div>
<div class="source-line"><span class="line-number ">409</span><span class="line-counter cline-yes">&nbsp</span><code> * @param i the n-bit integer.</code></div>
<div class="source-line"><span class="line-number ">410</span><span class="line-counter cline-yes">&nbsp</span><code> * @param n the number of bits in the integer (8, 16, 24, or 32).</code></div>
<div class="source-line"><span class="line-number ">411</span><span class="line-counter cline-yes">&nbsp</span><code> *</code></div>
<div class="source-line"><span class="line-number ">412</span><span class="line-counter cline-yes">&nbsp</span><code> * @return this buffer.</code></div>
<div class="source-line"><span class="line-number ">413</span><span class="line-counter cline-yes">&nbsp</span><code> */</code></div>
<div class="source-line"><span class="line-number ">414</span><span class="line-counter cline-no">！</span><code><span>util.ByteStringBuffer.prototype.putSignedInt = </span><span class="cstat-no" title="statement not covered">function(i, n) {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">415</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  // putInt checks n</span><span></span></code></div>
<div class="source-line"><span class="line-number ">416</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  if(i &lt; 0) {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">417</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    i += 2 &lt;&lt; (n - 1);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">418</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  }</span><span></span></code></div>
<div class="source-line"><span class="line-number ">419</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  return this.putInt(i, n);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">420</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">}</span><span>;</span></code></div>
<div class="source-line"><span class="line-number ">421</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<div class="source-line"><span class="line-number ">422</span><span class="line-counter cline-yes">&nbsp</span><code>/**</code></div>
<div class="source-line"><span class="line-number ">423</span><span class="line-counter cline-yes">&nbsp</span><code> * Puts the given buffer into this buffer.</code></div>
<div class="source-line"><span class="line-number ">424</span><span class="line-counter cline-yes">&nbsp</span><code> *</code></div>
<div class="source-line"><span class="line-number ">425</span><span class="line-counter cline-yes">&nbsp</span><code> * @param buffer the buffer to put into this one.</code></div>
<div class="source-line"><span class="line-number ">426</span><span class="line-counter cline-yes">&nbsp</span><code> *</code></div>
<div class="source-line"><span class="line-number ">427</span><span class="line-counter cline-yes">&nbsp</span><code> * @return this buffer.</code></div>
<div class="source-line"><span class="line-number ">428</span><span class="line-counter cline-yes">&nbsp</span><code> */</code></div>
<div class="source-line"><span class="line-number ">429</span><span class="line-counter cline-yes">&nbsp</span><code>util.ByteStringBuffer.prototype.putBuffer = function(buffer) {</code></div>
<div class="source-line"><span class="line-number ">430</span><span class="line-counter cline-yes">&nbsp</span><code>  return this.putBytes(buffer.getBytes());</code></div>
<div class="source-line"><span class="line-number ">431</span><span class="line-counter cline-yes">&nbsp</span><code>};</code></div>
<div class="source-line"><span class="line-number ">432</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<div class="source-line"><span class="line-number ">433</span><span class="line-counter cline-yes">&nbsp</span><code>/**</code></div>
<div class="source-line"><span class="line-number ">434</span><span class="line-counter cline-yes">&nbsp</span><code> * Gets a byte from this buffer and advances the read pointer by 1.</code></div>
<div class="source-line"><span class="line-number ">435</span><span class="line-counter cline-yes">&nbsp</span><code> *</code></div>
<div class="source-line"><span class="line-number ">436</span><span class="line-counter cline-yes">&nbsp</span><code> * @return the byte.</code></div>
<div class="source-line"><span class="line-number ">437</span><span class="line-counter cline-yes">&nbsp</span><code> */</code></div>
<div class="source-line"><span class="line-number ">438</span><span class="line-counter cline-yes">&nbsp</span><code>util.ByteStringBuffer.prototype.getByte = function() {</code></div>
<div class="source-line"><span class="line-number ">439</span><span class="line-counter cline-yes">&nbsp</span><code>  return this.data.charCodeAt(this.read++);</code></div>
<div class="source-line"><span class="line-number ">440</span><span class="line-counter cline-yes">&nbsp</span><code>};</code></div>
<div class="source-line"><span class="line-number ">441</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<div class="source-line"><span class="line-number ">442</span><span class="line-counter cline-yes">&nbsp</span><code>/**</code></div>
<div class="source-line"><span class="line-number ">443</span><span class="line-counter cline-yes">&nbsp</span><code> * Gets a uint16 from this buffer in big-endian order and advances the read</code></div>
<div class="source-line"><span class="line-number ">444</span><span class="line-counter cline-yes">&nbsp</span><code> * pointer by 2.</code></div>
<div class="source-line"><span class="line-number ">445</span><span class="line-counter cline-yes">&nbsp</span><code> *</code></div>
<div class="source-line"><span class="line-number ">446</span><span class="line-counter cline-yes">&nbsp</span><code> * @return the uint16.</code></div>
<div class="source-line"><span class="line-number ">447</span><span class="line-counter cline-yes">&nbsp</span><code> */</code></div>
<div class="source-line"><span class="line-number ">448</span><span class="line-counter cline-no">！</span><code><span>util.ByteStringBuffer.prototype.getInt16 = </span><span class="cstat-no" title="statement not covered">function() {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">449</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  var rval = (</span><span></span></code></div>
<div class="source-line"><span class="line-number ">450</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    this.data.charCodeAt(this.read) &lt;&lt; 8 ^</span><span></span></code></div>
<div class="source-line"><span class="line-number ">451</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    this.data.charCodeAt(this.read + 1));</span><span></span></code></div>
<div class="source-line"><span class="line-number ">452</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  this.read += 2;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">453</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  return rval;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">454</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">}</span><span>;</span></code></div>
<div class="source-line"><span class="line-number ">455</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<div class="source-line"><span class="line-number ">456</span><span class="line-counter cline-yes">&nbsp</span><code>/**</code></div>
<div class="source-line"><span class="line-number ">457</span><span class="line-counter cline-yes">&nbsp</span><code> * Gets a uint24 from this buffer in big-endian order and advances the read</code></div>
<div class="source-line"><span class="line-number ">458</span><span class="line-counter cline-yes">&nbsp</span><code> * pointer by 3.</code></div>
<div class="source-line"><span class="line-number ">459</span><span class="line-counter cline-yes">&nbsp</span><code> *</code></div>
<div class="source-line"><span class="line-number ">460</span><span class="line-counter cline-yes">&nbsp</span><code> * @return the uint24.</code></div>
<div class="source-line"><span class="line-number ">461</span><span class="line-counter cline-yes">&nbsp</span><code> */</code></div>
<div class="source-line"><span class="line-number ">462</span><span class="line-counter cline-no">！</span><code><span>util.ByteStringBuffer.prototype.getInt24 = </span><span class="cstat-no" title="statement not covered">function() {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">463</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  var rval = (</span><span></span></code></div>
<div class="source-line"><span class="line-number ">464</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    this.data.charCodeAt(this.read) &lt;&lt; 16 ^</span><span></span></code></div>
<div class="source-line"><span class="line-number ">465</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    this.data.charCodeAt(this.read + 1) &lt;&lt; 8 ^</span><span></span></code></div>
<div class="source-line"><span class="line-number ">466</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    this.data.charCodeAt(this.read + 2));</span><span></span></code></div>
<div class="source-line"><span class="line-number ">467</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  this.read += 3;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">468</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  return rval;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">469</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">}</span><span>;</span></code></div>
<div class="source-line"><span class="line-number ">470</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<div class="source-line"><span class="line-number ">471</span><span class="line-counter cline-yes">&nbsp</span><code>/**</code></div>
<div class="source-line"><span class="line-number ">472</span><span class="line-counter cline-yes">&nbsp</span><code> * Gets a uint32 from this buffer in big-endian order and advances the read</code></div>
<div class="source-line"><span class="line-number ">473</span><span class="line-counter cline-yes">&nbsp</span><code> * pointer by 4.</code></div>
<div class="source-line"><span class="line-number ">474</span><span class="line-counter cline-yes">&nbsp</span><code> *</code></div>
<div class="source-line"><span class="line-number ">475</span><span class="line-counter cline-yes">&nbsp</span><code> * @return the word.</code></div>
<div class="source-line"><span class="line-number ">476</span><span class="line-counter cline-yes">&nbsp</span><code> */</code></div>
<div class="source-line"><span class="line-number ">477</span><span class="line-counter cline-yes">&nbsp</span><code>util.ByteStringBuffer.prototype.getInt32 = function() {</code></div>
<div class="source-line"><span class="line-number ">478</span><span class="line-counter cline-yes">&nbsp</span><code>  var rval = (</code></div>
<div class="source-line"><span class="line-number ">479</span><span class="line-counter cline-yes">&nbsp</span><code>    this.data.charCodeAt(this.read) &lt;&lt; 24 ^</code></div>
<div class="source-line"><span class="line-number ">480</span><span class="line-counter cline-yes">&nbsp</span><code>    this.data.charCodeAt(this.read + 1) &lt;&lt; 16 ^</code></div>
<div class="source-line"><span class="line-number ">481</span><span class="line-counter cline-yes">&nbsp</span><code>    this.data.charCodeAt(this.read + 2) &lt;&lt; 8 ^</code></div>
<div class="source-line"><span class="line-number ">482</span><span class="line-counter cline-yes">&nbsp</span><code>    this.data.charCodeAt(this.read + 3));</code></div>
<div class="source-line"><span class="line-number ">483</span><span class="line-counter cline-yes">&nbsp</span><code>  this.read += 4;</code></div>
<div class="source-line"><span class="line-number ">484</span><span class="line-counter cline-yes">&nbsp</span><code>  return rval;</code></div>
<div class="source-line"><span class="line-number ">485</span><span class="line-counter cline-yes">&nbsp</span><code>};</code></div>
<div class="source-line"><span class="line-number ">486</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<div class="source-line"><span class="line-number ">487</span><span class="line-counter cline-yes">&nbsp</span><code>/**</code></div>
<div class="source-line"><span class="line-number ">488</span><span class="line-counter cline-yes">&nbsp</span><code> * Gets a uint16 from this buffer in little-endian order and advances the read</code></div>
<div class="source-line"><span class="line-number ">489</span><span class="line-counter cline-yes">&nbsp</span><code> * pointer by 2.</code></div>
<div class="source-line"><span class="line-number ">490</span><span class="line-counter cline-yes">&nbsp</span><code> *</code></div>
<div class="source-line"><span class="line-number ">491</span><span class="line-counter cline-yes">&nbsp</span><code> * @return the uint16.</code></div>
<div class="source-line"><span class="line-number ">492</span><span class="line-counter cline-yes">&nbsp</span><code> */</code></div>
<div class="source-line"><span class="line-number ">493</span><span class="line-counter cline-no">！</span><code><span>util.ByteStringBuffer.prototype.getInt16Le = </span><span class="cstat-no" title="statement not covered">function() {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">494</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  var rval = (</span><span></span></code></div>
<div class="source-line"><span class="line-number ">495</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    this.data.charCodeAt(this.read) ^</span><span></span></code></div>
<div class="source-line"><span class="line-number ">496</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    this.data.charCodeAt(this.read + 1) &lt;&lt; 8);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">497</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  this.read += 2;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">498</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  return rval;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">499</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">}</span><span>;</span></code></div>
<div class="source-line"><span class="line-number ">500</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<div class="source-line"><span class="line-number ">501</span><span class="line-counter cline-yes">&nbsp</span><code>/**</code></div>
<div class="source-line"><span class="line-number ">502</span><span class="line-counter cline-yes">&nbsp</span><code> * Gets a uint24 from this buffer in little-endian order and advances the read</code></div>
<div class="source-line"><span class="line-number ">503</span><span class="line-counter cline-yes">&nbsp</span><code> * pointer by 3.</code></div>
<div class="source-line"><span class="line-number ">504</span><span class="line-counter cline-yes">&nbsp</span><code> *</code></div>
<div class="source-line"><span class="line-number ">505</span><span class="line-counter cline-yes">&nbsp</span><code> * @return the uint24.</code></div>
<div class="source-line"><span class="line-number ">506</span><span class="line-counter cline-yes">&nbsp</span><code> */</code></div>
<div class="source-line"><span class="line-number ">507</span><span class="line-counter cline-no">！</span><code><span>util.ByteStringBuffer.prototype.getInt24Le = </span><span class="cstat-no" title="statement not covered">function() {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">508</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  var rval = (</span><span></span></code></div>
<div class="source-line"><span class="line-number ">509</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    this.data.charCodeAt(this.read) ^</span><span></span></code></div>
<div class="source-line"><span class="line-number ">510</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    this.data.charCodeAt(this.read + 1) &lt;&lt; 8 ^</span><span></span></code></div>
<div class="source-line"><span class="line-number ">511</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    this.data.charCodeAt(this.read + 2) &lt;&lt; 16);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">512</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  this.read += 3;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">513</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  return rval;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">514</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">}</span><span>;</span></code></div>
<div class="source-line"><span class="line-number ">515</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<div class="source-line"><span class="line-number ">516</span><span class="line-counter cline-yes">&nbsp</span><code>/**</code></div>
<div class="source-line"><span class="line-number ">517</span><span class="line-counter cline-yes">&nbsp</span><code> * Gets a uint32 from this buffer in little-endian order and advances the read</code></div>
<div class="source-line"><span class="line-number ">518</span><span class="line-counter cline-yes">&nbsp</span><code> * pointer by 4.</code></div>
<div class="source-line"><span class="line-number ">519</span><span class="line-counter cline-yes">&nbsp</span><code> *</code></div>
<div class="source-line"><span class="line-number ">520</span><span class="line-counter cline-yes">&nbsp</span><code> * @return the word.</code></div>
<div class="source-line"><span class="line-number ">521</span><span class="line-counter cline-yes">&nbsp</span><code> */</code></div>
<div class="source-line"><span class="line-number ">522</span><span class="line-counter cline-no">！</span><code><span>util.ByteStringBuffer.prototype.getInt32Le = </span><span class="cstat-no" title="statement not covered">function() {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">523</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  var rval = (</span><span></span></code></div>
<div class="source-line"><span class="line-number ">524</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    this.data.charCodeAt(this.read) ^</span><span></span></code></div>
<div class="source-line"><span class="line-number ">525</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    this.data.charCodeAt(this.read + 1) &lt;&lt; 8 ^</span><span></span></code></div>
<div class="source-line"><span class="line-number ">526</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    this.data.charCodeAt(this.read + 2) &lt;&lt; 16 ^</span><span></span></code></div>
<div class="source-line"><span class="line-number ">527</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    this.data.charCodeAt(this.read + 3) &lt;&lt; 24);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">528</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  this.read += 4;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">529</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  return rval;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">530</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">}</span><span>;</span></code></div>
<div class="source-line"><span class="line-number ">531</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<div class="source-line"><span class="line-number ">532</span><span class="line-counter cline-yes">&nbsp</span><code>/**</code></div>
<div class="source-line"><span class="line-number ">533</span><span class="line-counter cline-yes">&nbsp</span><code> * Gets an n-bit integer from this buffer in big-endian order and advances the</code></div>
<div class="source-line"><span class="line-number ">534</span><span class="line-counter cline-yes">&nbsp</span><code> * read pointer by ceil(n/8).</code></div>
<div class="source-line"><span class="line-number ">535</span><span class="line-counter cline-yes">&nbsp</span><code> *</code></div>
<div class="source-line"><span class="line-number ">536</span><span class="line-counter cline-yes">&nbsp</span><code> * @param n the number of bits in the integer (8, 16, 24, or 32).</code></div>
<div class="source-line"><span class="line-number ">537</span><span class="line-counter cline-yes">&nbsp</span><code> *</code></div>
<div class="source-line"><span class="line-number ">538</span><span class="line-counter cline-yes">&nbsp</span><code> * @return the integer.</code></div>
<div class="source-line"><span class="line-number ">539</span><span class="line-counter cline-yes">&nbsp</span><code> */</code></div>
<div class="source-line"><span class="line-number ">540</span><span class="line-counter cline-yes">&nbsp</span><code>util.ByteStringBuffer.prototype.getInt = function(n) {</code></div>
<div class="source-line"><span class="line-number ">541</span><span class="line-counter cline-yes">&nbsp</span><code>  _checkBitsParam(n);</code></div>
<div class="source-line"><span class="line-number ">542</span><span class="line-counter cline-yes">&nbsp</span><code>  var rval = 0;</code></div>
<div class="source-line"><span class="line-number ">543</span><span class="line-counter cline-yes">&nbsp</span><code>  do {</code></div>
<div class="source-line"><span class="line-number ">544</span><span class="line-counter cline-yes">&nbsp</span><code>    // TODO: Use (rval * 0x100) if adding support for 33 to 53 bits.</code></div>
<div class="source-line"><span class="line-number ">545</span><span class="line-counter cline-yes">&nbsp</span><code>    rval = (rval &lt;&lt; 8) + this.data.charCodeAt(this.read++);</code></div>
<div class="source-line"><span class="line-number ">546</span><span class="line-counter cline-yes">&nbsp</span><code>    n -= 8;</code></div>
<div class="source-line"><span class="line-number ">547</span><span class="line-counter cline-yes">&nbsp</span><code>  } while(n &gt; 0);</code></div>
<div class="source-line"><span class="line-number ">548</span><span class="line-counter cline-yes">&nbsp</span><code>  return rval;</code></div>
<div class="source-line"><span class="line-number ">549</span><span class="line-counter cline-yes">&nbsp</span><code>};</code></div>
<div class="source-line"><span class="line-number ">550</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<div class="source-line"><span class="line-number ">551</span><span class="line-counter cline-yes">&nbsp</span><code>/**</code></div>
<div class="source-line"><span class="line-number ">552</span><span class="line-counter cline-yes">&nbsp</span><code> * Gets a signed n-bit integer from this buffer in big-endian order, using</code></div>
<div class="source-line"><span class="line-number ">553</span><span class="line-counter cline-yes">&nbsp</span><code> * two&#39;s complement, and advances the read pointer by n/8.</code></div>
<div class="source-line"><span class="line-number ">554</span><span class="line-counter cline-yes">&nbsp</span><code> *</code></div>
<div class="source-line"><span class="line-number ">555</span><span class="line-counter cline-yes">&nbsp</span><code> * @param n the number of bits in the integer (8, 16, 24, or 32).</code></div>
<div class="source-line"><span class="line-number ">556</span><span class="line-counter cline-yes">&nbsp</span><code> *</code></div>
<div class="source-line"><span class="line-number ">557</span><span class="line-counter cline-yes">&nbsp</span><code> * @return the integer.</code></div>
<div class="source-line"><span class="line-number ">558</span><span class="line-counter cline-yes">&nbsp</span><code> */</code></div>
<div class="source-line"><span class="line-number ">559</span><span class="line-counter cline-no">！</span><code><span>util.ByteStringBuffer.prototype.getSignedInt = </span><span class="cstat-no" title="statement not covered">function(n) {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">560</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  // getInt checks n</span><span></span></code></div>
<div class="source-line"><span class="line-number ">561</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  var x = this.getInt(n);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">562</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  var max = 2 &lt;&lt; (n - 2);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">563</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  if(x &gt;= max) {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">564</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    x -= max &lt;&lt; 1;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">565</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  }</span><span></span></code></div>
<div class="source-line"><span class="line-number ">566</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  return x;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">567</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">}</span><span>;</span></code></div>
<div class="source-line"><span class="line-number ">568</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<div class="source-line"><span class="line-number ">569</span><span class="line-counter cline-yes">&nbsp</span><code>/**</code></div>
<div class="source-line"><span class="line-number ">570</span><span class="line-counter cline-yes">&nbsp</span><code> * Reads bytes out as a binary encoded string and clears them from the</code></div>
<div class="source-line"><span class="line-number ">571</span><span class="line-counter cline-yes">&nbsp</span><code> * buffer. Note that the resulting string is binary encoded (in node.js this</code></div>
<div class="source-line"><span class="line-number ">572</span><span class="line-counter cline-yes">&nbsp</span><code> * encoding is referred to as `binary`, it is *not* `utf8`).</code></div>
<div class="source-line"><span class="line-number ">573</span><span class="line-counter cline-yes">&nbsp</span><code> *</code></div>
<div class="source-line"><span class="line-number ">574</span><span class="line-counter cline-yes">&nbsp</span><code> * @param count the number of bytes to read, undefined or null for all.</code></div>
<div class="source-line"><span class="line-number ">575</span><span class="line-counter cline-yes">&nbsp</span><code> *</code></div>
<div class="source-line"><span class="line-number ">576</span><span class="line-counter cline-yes">&nbsp</span><code> * @return a binary encoded string of bytes.</code></div>
<div class="source-line"><span class="line-number ">577</span><span class="line-counter cline-yes">&nbsp</span><code> */</code></div>
<div class="source-line"><span class="line-number ">578</span><span class="line-counter cline-yes">&nbsp</span><code>util.ByteStringBuffer.prototype.getBytes = function(count) {</code></div>
<div class="source-line"><span class="line-number ">579</span><span class="line-counter cline-yes">&nbsp</span><code>  var rval;</code></div>
<div class="source-line"><span class="line-number ">580</span><span class="line-counter cline-yes">&nbsp</span><code>  if(count) {</code></div>
<div class="source-line"><span class="line-number ">581</span><span class="line-counter cline-yes">&nbsp</span><code>    // read count bytes</code></div>
<div class="source-line"><span class="line-number ">582</span><span class="line-counter cline-yes">&nbsp</span><code>    count = Math.min(this.length(), count);</code></div>
<div class="source-line"><span class="line-number ">583</span><span class="line-counter cline-yes">&nbsp</span><code>    rval = this.data.slice(this.read, this.read + count);</code></div>
<div class="source-line"><span class="line-number ">584</span><span class="line-counter cline-yes">&nbsp</span><code>    this.read += count;</code></div>
<div class="source-line"><span class="line-number ">585</span><span class="line-counter cline-yes">&nbsp</span><code>  } else if(count === 0) {</code></div>
<div class="source-line"><span class="line-number ">586</span><span class="line-counter cline-yes">&nbsp</span><code>    rval = &#39;&#39;;</code></div>
<div class="source-line"><span class="line-number ">587</span><span class="line-counter cline-yes">&nbsp</span><code>  } else {</code></div>
<div class="source-line"><span class="line-number ">588</span><span class="line-counter cline-yes">&nbsp</span><code>    // read all bytes, optimize to only copy when needed</code></div>
<div class="source-line"><span class="line-number ">589</span><span class="line-counter cline-no">！</span><code><span>    rval = (this.read === 0) ? this.data </span><span class="cstat-no" title="statement not covered">: this.data.slice(this.read)</span><span>;</span></code></div>
<div class="source-line"><span class="line-number ">590</span><span class="line-counter cline-yes">&nbsp</span><code>    this.clear();</code></div>
<div class="source-line"><span class="line-number ">591</span><span class="line-counter cline-yes">&nbsp</span><code>  }</code></div>
<div class="source-line"><span class="line-number ">592</span><span class="line-counter cline-yes">&nbsp</span><code>  return rval;</code></div>
<div class="source-line"><span class="line-number ">593</span><span class="line-counter cline-yes">&nbsp</span><code>};</code></div>
<div class="source-line"><span class="line-number ">594</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<div class="source-line"><span class="line-number ">595</span><span class="line-counter cline-yes">&nbsp</span><code>/**</code></div>
<div class="source-line"><span class="line-number ">596</span><span class="line-counter cline-yes">&nbsp</span><code> * Gets a binary encoded string of the bytes from this buffer without</code></div>
<div class="source-line"><span class="line-number ">597</span><span class="line-counter cline-yes">&nbsp</span><code> * modifying the read pointer.</code></div>
<div class="source-line"><span class="line-number ">598</span><span class="line-counter cline-yes">&nbsp</span><code> *</code></div>
<div class="source-line"><span class="line-number ">599</span><span class="line-counter cline-yes">&nbsp</span><code> * @param count the number of bytes to get, omit to get all.</code></div>
<div class="source-line"><span class="line-number ">600</span><span class="line-counter cline-yes">&nbsp</span><code> *</code></div>
<div class="source-line"><span class="line-number ">601</span><span class="line-counter cline-yes">&nbsp</span><code> * @return a string full of binary encoded characters.</code></div>
<div class="source-line"><span class="line-number ">602</span><span class="line-counter cline-yes">&nbsp</span><code> */</code></div>
<div class="source-line"><span class="line-number ">603</span><span class="line-counter cline-yes">&nbsp</span><code>util.ByteStringBuffer.prototype.bytes = function(count) {</code></div>
<div class="source-line"><span class="line-number ">604</span><span class="line-counter cline-yes">&nbsp</span><code>  return (typeof(count) === &#39;undefined&#39; ?</code></div>
<div class="source-line"><span class="line-number ">605</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    this.data.slice(this.read)</span><span> :</span></code></div>
<div class="source-line"><span class="line-number ">606</span><span class="line-counter cline-yes">&nbsp</span><code>    this.data.slice(this.read, this.read + count));</code></div>
<div class="source-line"><span class="line-number ">607</span><span class="line-counter cline-yes">&nbsp</span><code>};</code></div>
<div class="source-line"><span class="line-number ">608</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<div class="source-line"><span class="line-number ">609</span><span class="line-counter cline-yes">&nbsp</span><code>/**</code></div>
<div class="source-line"><span class="line-number ">610</span><span class="line-counter cline-yes">&nbsp</span><code> * Gets a byte at the given index without modifying the read pointer.</code></div>
<div class="source-line"><span class="line-number ">611</span><span class="line-counter cline-yes">&nbsp</span><code> *</code></div>
<div class="source-line"><span class="line-number ">612</span><span class="line-counter cline-yes">&nbsp</span><code> * @param i the byte index.</code></div>
<div class="source-line"><span class="line-number ">613</span><span class="line-counter cline-yes">&nbsp</span><code> *</code></div>
<div class="source-line"><span class="line-number ">614</span><span class="line-counter cline-yes">&nbsp</span><code> * @return the byte.</code></div>
<div class="source-line"><span class="line-number ">615</span><span class="line-counter cline-yes">&nbsp</span><code> */</code></div>
<div class="source-line"><span class="line-number ">616</span><span class="line-counter cline-no">！</span><code><span>util.ByteStringBuffer.prototype.at = </span><span class="cstat-no" title="statement not covered">function(i) {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">617</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  return this.data.charCodeAt(this.read + i);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">618</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">}</span><span>;</span></code></div>
<div class="source-line"><span class="line-number ">619</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<div class="source-line"><span class="line-number ">620</span><span class="line-counter cline-yes">&nbsp</span><code>/**</code></div>
<div class="source-line"><span class="line-number ">621</span><span class="line-counter cline-yes">&nbsp</span><code> * Puts a byte at the given index without modifying the read pointer.</code></div>
<div class="source-line"><span class="line-number ">622</span><span class="line-counter cline-yes">&nbsp</span><code> *</code></div>
<div class="source-line"><span class="line-number ">623</span><span class="line-counter cline-yes">&nbsp</span><code> * @param i the byte index.</code></div>
<div class="source-line"><span class="line-number ">624</span><span class="line-counter cline-yes">&nbsp</span><code> * @param b the byte to put.</code></div>
<div class="source-line"><span class="line-number ">625</span><span class="line-counter cline-yes">&nbsp</span><code> *</code></div>
<div class="source-line"><span class="line-number ">626</span><span class="line-counter cline-yes">&nbsp</span><code> * @return this buffer.</code></div>
<div class="source-line"><span class="line-number ">627</span><span class="line-counter cline-yes">&nbsp</span><code> */</code></div>
<div class="source-line"><span class="line-number ">628</span><span class="line-counter cline-no">！</span><code><span>util.ByteStringBuffer.prototype.setAt = </span><span class="cstat-no" title="statement not covered">function(i, b) {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">629</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  this.data = this.data.substr(0, this.read + i) +</span><span></span></code></div>
<div class="source-line"><span class="line-number ">630</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    String.fromCharCode(b) +</span><span></span></code></div>
<div class="source-line"><span class="line-number ">631</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    this.data.substr(this.read + i + 1);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">632</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  return this;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">633</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">}</span><span>;</span></code></div>
<div class="source-line"><span class="line-number ">634</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<div class="source-line"><span class="line-number ">635</span><span class="line-counter cline-yes">&nbsp</span><code>/**</code></div>
<div class="source-line"><span class="line-number ">636</span><span class="line-counter cline-yes">&nbsp</span><code> * Gets the last byte without modifying the read pointer.</code></div>
<div class="source-line"><span class="line-number ">637</span><span class="line-counter cline-yes">&nbsp</span><code> *</code></div>
<div class="source-line"><span class="line-number ">638</span><span class="line-counter cline-yes">&nbsp</span><code> * @return the last byte.</code></div>
<div class="source-line"><span class="line-number ">639</span><span class="line-counter cline-yes">&nbsp</span><code> */</code></div>
<div class="source-line"><span class="line-number ">640</span><span class="line-counter cline-no">！</span><code><span>util.ByteStringBuffer.prototype.last = </span><span class="cstat-no" title="statement not covered">function() {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">641</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  return this.data.charCodeAt(this.data.length - 1);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">642</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">}</span><span>;</span></code></div>
<div class="source-line"><span class="line-number ">643</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<div class="source-line"><span class="line-number ">644</span><span class="line-counter cline-yes">&nbsp</span><code>/**</code></div>
<div class="source-line"><span class="line-number ">645</span><span class="line-counter cline-yes">&nbsp</span><code> * Creates a copy of this buffer.</code></div>
<div class="source-line"><span class="line-number ">646</span><span class="line-counter cline-yes">&nbsp</span><code> *</code></div>
<div class="source-line"><span class="line-number ">647</span><span class="line-counter cline-yes">&nbsp</span><code> * @return the copy.</code></div>
<div class="source-line"><span class="line-number ">648</span><span class="line-counter cline-yes">&nbsp</span><code> */</code></div>
<div class="source-line"><span class="line-number ">649</span><span class="line-counter cline-no">！</span><code><span>util.ByteStringBuffer.prototype.copy = </span><span class="cstat-no" title="statement not covered">function() {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">650</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  var c = util.createBuffer(this.data);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">651</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  c.read = this.read;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">652</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  return c;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">653</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">}</span><span>;</span></code></div>
<div class="source-line"><span class="line-number ">654</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<div class="source-line"><span class="line-number ">655</span><span class="line-counter cline-yes">&nbsp</span><code>/**</code></div>
<div class="source-line"><span class="line-number ">656</span><span class="line-counter cline-yes">&nbsp</span><code> * Compacts this buffer.</code></div>
<div class="source-line"><span class="line-number ">657</span><span class="line-counter cline-yes">&nbsp</span><code> *</code></div>
<div class="source-line"><span class="line-number ">658</span><span class="line-counter cline-yes">&nbsp</span><code> * @return this buffer.</code></div>
<div class="source-line"><span class="line-number ">659</span><span class="line-counter cline-yes">&nbsp</span><code> */</code></div>
<div class="source-line"><span class="line-number ">660</span><span class="line-counter cline-yes">&nbsp</span><code>util.ByteStringBuffer.prototype.compact = function() {</code></div>
<div class="source-line"><span class="line-number ">661</span><span class="line-counter cline-yes">&nbsp</span><code>  if(this.read &gt; 0) {</code></div>
<div class="source-line"><span class="line-number ">662</span><span class="line-counter cline-yes">&nbsp</span><code>    this.data = this.data.slice(this.read);</code></div>
<div class="source-line"><span class="line-number ">663</span><span class="line-counter cline-yes">&nbsp</span><code>    this.read = 0;</code></div>
<div class="source-line"><span class="line-number ">664</span><span class="line-counter cline-yes">&nbsp</span><code>  }</code></div>
<div class="source-line"><span class="line-number ">665</span><span class="line-counter cline-yes">&nbsp</span><code>  return this;</code></div>
<div class="source-line"><span class="line-number ">666</span><span class="line-counter cline-yes">&nbsp</span><code>};</code></div>
<div class="source-line"><span class="line-number ">667</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<div class="source-line"><span class="line-number ">668</span><span class="line-counter cline-yes">&nbsp</span><code>/**</code></div>
<div class="source-line"><span class="line-number ">669</span><span class="line-counter cline-yes">&nbsp</span><code> * Clears this buffer.</code></div>
<div class="source-line"><span class="line-number ">670</span><span class="line-counter cline-yes">&nbsp</span><code> *</code></div>
<div class="source-line"><span class="line-number ">671</span><span class="line-counter cline-yes">&nbsp</span><code> * @return this buffer.</code></div>
<div class="source-line"><span class="line-number ">672</span><span class="line-counter cline-yes">&nbsp</span><code> */</code></div>
<div class="source-line"><span class="line-number ">673</span><span class="line-counter cline-yes">&nbsp</span><code>util.ByteStringBuffer.prototype.clear = function() {</code></div>
<div class="source-line"><span class="line-number ">674</span><span class="line-counter cline-yes">&nbsp</span><code>  this.data = &#39;&#39;;</code></div>
<div class="source-line"><span class="line-number ">675</span><span class="line-counter cline-yes">&nbsp</span><code>  this.read = 0;</code></div>
<div class="source-line"><span class="line-number ">676</span><span class="line-counter cline-yes">&nbsp</span><code>  return this;</code></div>
<div class="source-line"><span class="line-number ">677</span><span class="line-counter cline-yes">&nbsp</span><code>};</code></div>
<div class="source-line"><span class="line-number ">678</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<div class="source-line"><span class="line-number ">679</span><span class="line-counter cline-yes">&nbsp</span><code>/**</code></div>
<div class="source-line"><span class="line-number ">680</span><span class="line-counter cline-yes">&nbsp</span><code> * Shortens this buffer by triming bytes off of the end of this buffer.</code></div>
<div class="source-line"><span class="line-number ">681</span><span class="line-counter cline-yes">&nbsp</span><code> *</code></div>
<div class="source-line"><span class="line-number ">682</span><span class="line-counter cline-yes">&nbsp</span><code> * @param count the number of bytes to trim off.</code></div>
<div class="source-line"><span class="line-number ">683</span><span class="line-counter cline-yes">&nbsp</span><code> *</code></div>
<div class="source-line"><span class="line-number ">684</span><span class="line-counter cline-yes">&nbsp</span><code> * @return this buffer.</code></div>
<div class="source-line"><span class="line-number ">685</span><span class="line-counter cline-yes">&nbsp</span><code> */</code></div>
<div class="source-line"><span class="line-number ">686</span><span class="line-counter cline-yes">&nbsp</span><code>util.ByteStringBuffer.prototype.truncate = function(count) {</code></div>
<div class="source-line"><span class="line-number ">687</span><span class="line-counter cline-yes">&nbsp</span><code>  var len = Math.max(0, this.length() - count);</code></div>
<div class="source-line"><span class="line-number ">688</span><span class="line-counter cline-yes">&nbsp</span><code>  this.data = this.data.substr(this.read, len);</code></div>
<div class="source-line"><span class="line-number ">689</span><span class="line-counter cline-yes">&nbsp</span><code>  this.read = 0;</code></div>
<div class="source-line"><span class="line-number ">690</span><span class="line-counter cline-yes">&nbsp</span><code>  return this;</code></div>
<div class="source-line"><span class="line-number ">691</span><span class="line-counter cline-yes">&nbsp</span><code>};</code></div>
<div class="source-line"><span class="line-number ">692</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<div class="source-line"><span class="line-number ">693</span><span class="line-counter cline-yes">&nbsp</span><code>/**</code></div>
<div class="source-line"><span class="line-number ">694</span><span class="line-counter cline-yes">&nbsp</span><code> * Converts this buffer to a hexadecimal string.</code></div>
<div class="source-line"><span class="line-number ">695</span><span class="line-counter cline-yes">&nbsp</span><code> *</code></div>
<div class="source-line"><span class="line-number ">696</span><span class="line-counter cline-yes">&nbsp</span><code> * @return a hexadecimal string.</code></div>
<div class="source-line"><span class="line-number ">697</span><span class="line-counter cline-yes">&nbsp</span><code> */</code></div>
<div class="source-line"><span class="line-number ">698</span><span class="line-counter cline-yes">&nbsp</span><code>util.ByteStringBuffer.prototype.toHex = function() {</code></div>
<div class="source-line"><span class="line-number ">699</span><span class="line-counter cline-yes">&nbsp</span><code>  var rval = &#39;&#39;;</code></div>
<div class="source-line"><span class="line-number ">700</span><span class="line-counter cline-yes">&nbsp</span><code>  for(var i = this.read; i &lt; this.data.length; ++i) {</code></div>
<div class="source-line"><span class="line-number ">701</span><span class="line-counter cline-yes">&nbsp</span><code>    var b = this.data.charCodeAt(i);</code></div>
<mark class="issue-line"><div class="source-line"><span class="line-number ">702</span><span class="line-counter cline-yes">&nbsp</span><code>    if(b &lt; 16) {</code></div>
</mark><details class="issue-inline-message issue-critical issue-branch target-ECB">
                        <summary>💥&nbsp;<i>ECB</i> Secret-dependent branch</summary>
                <div class="issue-description">[ECB] Found vulnerable jump instruction, leakage score 100.00% +/- 0%.</div>
            </details><details class="issue-inline-message issue-critical issue-branch target-RSASIGN">
                        <summary>💥&nbsp;<i>RSASIGN</i> Secret-dependent branch</summary>
                <div class="issue-description">[RSASIGN] Found vulnerable jump instruction, leakage score 100.00% +/- 0%.</div>
            </details><div class="source-line"><span class="line-number ">703</span><span class="line-counter cline-yes">&nbsp</span><code>      rval += &#39;0&#39;;</code></div>
<div class="source-line"><span class="line-number ">704</span><span class="line-counter cline-yes">&nbsp</span><code>    }</code></div>
<div class="source-line"><span class="line-number ">705</span><span class="line-counter cline-yes">&nbsp</span><code>    rval += b.toString(16);</code></div>
<div class="source-line"><span class="line-number ">706</span><span class="line-counter cline-yes">&nbsp</span><code>  }</code></div>
<div class="source-line"><span class="line-number ">707</span><span class="line-counter cline-yes">&nbsp</span><code>  return rval;</code></div>
<div class="source-line"><span class="line-number ">708</span><span class="line-counter cline-yes">&nbsp</span><code>};</code></div>
<div class="source-line"><span class="line-number ">709</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<div class="source-line"><span class="line-number ">710</span><span class="line-counter cline-yes">&nbsp</span><code>/**</code></div>
<div class="source-line"><span class="line-number ">711</span><span class="line-counter cline-yes">&nbsp</span><code> * Converts this buffer to a UTF-16 string (standard JavaScript string).</code></div>
<div class="source-line"><span class="line-number ">712</span><span class="line-counter cline-yes">&nbsp</span><code> *</code></div>
<div class="source-line"><span class="line-number ">713</span><span class="line-counter cline-yes">&nbsp</span><code> * @return a UTF-16 string.</code></div>
<div class="source-line"><span class="line-number ">714</span><span class="line-counter cline-yes">&nbsp</span><code> */</code></div>
<div class="source-line"><span class="line-number ">715</span><span class="line-counter cline-no">！</span><code><span>util.ByteStringBuffer.prototype.toString = </span><span class="cstat-no" title="statement not covered">function() {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">716</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  return util.decodeUtf8(this.bytes());</span><span></span></code></div>
<div class="source-line"><span class="line-number ">717</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">}</span><span>;</span></code></div>
<div class="source-line"><span class="line-number ">718</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<div class="source-line"><span class="line-number ">719</span><span class="line-counter cline-yes">&nbsp</span><code>/** End Buffer w/BinaryString backing */</code></div>
<div class="source-line"><span class="line-number ">720</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<div class="source-line"><span class="line-number ">721</span><span class="line-counter cline-yes">&nbsp</span><code>/** Buffer w/UInt8Array backing */</code></div>
<div class="source-line"><span class="line-number ">722</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<div class="source-line"><span class="line-number ">723</span><span class="line-counter cline-yes">&nbsp</span><code>/**</code></div>
<div class="source-line"><span class="line-number ">724</span><span class="line-counter cline-yes">&nbsp</span><code> * FIXME: Experimental. Do not use yet.</code></div>
<div class="source-line"><span class="line-number ">725</span><span class="line-counter cline-yes">&nbsp</span><code> *</code></div>
<div class="source-line"><span class="line-number ">726</span><span class="line-counter cline-yes">&nbsp</span><code> * Constructor for an ArrayBuffer-backed byte buffer.</code></div>
<div class="source-line"><span class="line-number ">727</span><span class="line-counter cline-yes">&nbsp</span><code> *</code></div>
<div class="source-line"><span class="line-number ">728</span><span class="line-counter cline-yes">&nbsp</span><code> * The buffer may be constructed from a string, an ArrayBuffer, DataView, or a</code></div>
<div class="source-line"><span class="line-number ">729</span><span class="line-counter cline-yes">&nbsp</span><code> * TypedArray.</code></div>
<div class="source-line"><span class="line-number ">730</span><span class="line-counter cline-yes">&nbsp</span><code> *</code></div>
<div class="source-line"><span class="line-number ">731</span><span class="line-counter cline-yes">&nbsp</span><code> * If a string is given, its encoding should be provided as an option,</code></div>
<div class="source-line"><span class="line-number ">732</span><span class="line-counter cline-yes">&nbsp</span><code> * otherwise it will default to &#39;binary&#39;. A &#39;binary&#39; string is encoded such</code></div>
<div class="source-line"><span class="line-number ">733</span><span class="line-counter cline-yes">&nbsp</span><code> * that each character is one byte in length and size.</code></div>
<div class="source-line"><span class="line-number ">734</span><span class="line-counter cline-yes">&nbsp</span><code> *</code></div>
<div class="source-line"><span class="line-number ">735</span><span class="line-counter cline-yes">&nbsp</span><code> * If an ArrayBuffer, DataView, or TypedArray is given, it will be used</code></div>
<div class="source-line"><span class="line-number ">736</span><span class="line-counter cline-yes">&nbsp</span><code> * *directly* without any copying. Note that, if a write to the buffer requires</code></div>
<div class="source-line"><span class="line-number ">737</span><span class="line-counter cline-yes">&nbsp</span><code> * more space, the buffer will allocate a new backing ArrayBuffer to</code></div>
<div class="source-line"><span class="line-number ">738</span><span class="line-counter cline-yes">&nbsp</span><code> * accommodate. The starting read and write offsets for the buffer may be</code></div>
<div class="source-line"><span class="line-number ">739</span><span class="line-counter cline-yes">&nbsp</span><code> * given as options.</code></div>
<div class="source-line"><span class="line-number ">740</span><span class="line-counter cline-yes">&nbsp</span><code> *</code></div>
<div class="source-line"><span class="line-number ">741</span><span class="line-counter cline-yes">&nbsp</span><code> * @param [b] the initial bytes for this buffer.</code></div>
<div class="source-line"><span class="line-number ">742</span><span class="line-counter cline-yes">&nbsp</span><code> * @param options the options to use:</code></div>
<div class="source-line"><span class="line-number ">743</span><span class="line-counter cline-yes">&nbsp</span><code> *          [readOffset] the starting read offset to use (default: 0).</code></div>
<div class="source-line"><span class="line-number ">744</span><span class="line-counter cline-yes">&nbsp</span><code> *          [writeOffset] the starting write offset to use (default: the</code></div>
<div class="source-line"><span class="line-number ">745</span><span class="line-counter cline-yes">&nbsp</span><code> *            length of the first parameter).</code></div>
<div class="source-line"><span class="line-number ">746</span><span class="line-counter cline-yes">&nbsp</span><code> *          [growSize] the minimum amount, in bytes, to grow the buffer by to</code></div>
<div class="source-line"><span class="line-number ">747</span><span class="line-counter cline-yes">&nbsp</span><code> *            accommodate writes (default: 1024).</code></div>
<div class="source-line"><span class="line-number ">748</span><span class="line-counter cline-yes">&nbsp</span><code> *          [encoding] the encoding (&#39;binary&#39;, &#39;utf8&#39;, &#39;utf16&#39;, &#39;hex&#39;) for the</code></div>
<div class="source-line"><span class="line-number ">749</span><span class="line-counter cline-yes">&nbsp</span><code> *            first parameter, if it is a string (default: &#39;binary&#39;).</code></div>
<div class="source-line"><span class="line-number ">750</span><span class="line-counter cline-yes">&nbsp</span><code> */</code></div>
<div class="source-line"><span class="line-number ">751</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">function DataBuffer(b, options) {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">752</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  // default options</span><span></span></code></div>
<div class="source-line"><span class="line-number ">753</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  options = options || {};</span><span></span></code></div>
<div class="source-line"><span class="line-number ">754</span><span class="line-counter cline-no">！</span><code><span class="cstat-no" title="statement not covered"><br/></span><span></span></code></div>
<div class="source-line"><span class="line-number ">755</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  // pointers for read from/write to buffer</span><span></span></code></div>
<div class="source-line"><span class="line-number ">756</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  this.read = options.readOffset || 0;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">757</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  this.growSize = options.growSize || 1024;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">758</span><span class="line-counter cline-no">！</span><code><span class="cstat-no" title="statement not covered"><br/></span><span></span></code></div>
<div class="source-line"><span class="line-number ">759</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  var isArrayBuffer = util.isArrayBuffer(b);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">760</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  var isArrayBufferView = util.isArrayBufferView(b);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">761</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  if(isArrayBuffer || isArrayBufferView) {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">762</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    // use ArrayBuffer directly</span><span></span></code></div>
<div class="source-line"><span class="line-number ">763</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    if(isArrayBuffer) {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">764</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">      this.data = new DataView(b);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">765</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    } else {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">766</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">      // TODO: adjust read/write offset based on the type of view</span><span></span></code></div>
<div class="source-line"><span class="line-number ">767</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">      // or specify that this must be done in the options ... that the</span><span></span></code></div>
<div class="source-line"><span class="line-number ">768</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">      // offsets are byte-based</span><span></span></code></div>
<div class="source-line"><span class="line-number ">769</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">      this.data = new DataView(b.buffer, b.byteOffset, b.byteLength);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">770</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    }</span><span></span></code></div>
<div class="source-line"><span class="line-number ">771</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    this.write = (&#39;writeOffset&#39; in options ?</span><span></span></code></div>
<div class="source-line"><span class="line-number ">772</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">      options.writeOffset : this.data.byteLength);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">773</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    return;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">774</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  }</span><span></span></code></div>
<div class="source-line"><span class="line-number ">775</span><span class="line-counter cline-no">！</span><code><span class="cstat-no" title="statement not covered"><br/></span><span></span></code></div>
<div class="source-line"><span class="line-number ">776</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  // initialize to empty array buffer and add any given bytes using putBytes</span><span></span></code></div>
<div class="source-line"><span class="line-number ">777</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  this.data = new DataView(new ArrayBuffer(0));</span><span></span></code></div>
<div class="source-line"><span class="line-number ">778</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  this.write = 0;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">779</span><span class="line-counter cline-no">！</span><code><span class="cstat-no" title="statement not covered"><br/></span><span></span></code></div>
<div class="source-line"><span class="line-number ">780</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  if(b !== null &amp;&amp; b !== undefined) {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">781</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    this.putBytes(b);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">782</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  }</span><span></span></code></div>
<div class="source-line"><span class="line-number ">783</span><span class="line-counter cline-no">！</span><code><span class="cstat-no" title="statement not covered"><br/></span><span></span></code></div>
<div class="source-line"><span class="line-number ">784</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  if(&#39;writeOffset&#39; in options) {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">785</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    this.write = options.writeOffset;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">786</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  }</span><span></span></code></div>
<div class="source-line"><span class="line-number ">787</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">}</span><span></span></code></div>
<div class="source-line"><span class="line-number ">788</span><span class="line-counter cline-yes">&nbsp</span><code>util.DataBuffer = DataBuffer;</code></div>
<div class="source-line"><span class="line-number ">789</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<div class="source-line"><span class="line-number ">790</span><span class="line-counter cline-yes">&nbsp</span><code>/**</code></div>
<div class="source-line"><span class="line-number ">791</span><span class="line-counter cline-yes">&nbsp</span><code> * Gets the number of bytes in this buffer.</code></div>
<div class="source-line"><span class="line-number ">792</span><span class="line-counter cline-yes">&nbsp</span><code> *</code></div>
<div class="source-line"><span class="line-number ">793</span><span class="line-counter cline-yes">&nbsp</span><code> * @return the number of bytes in this buffer.</code></div>
<div class="source-line"><span class="line-number ">794</span><span class="line-counter cline-yes">&nbsp</span><code> */</code></div>
<div class="source-line"><span class="line-number ">795</span><span class="line-counter cline-no">！</span><code><span>util.DataBuffer.prototype.length = </span><span class="cstat-no" title="statement not covered">function() {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">796</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  return this.write - this.read;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">797</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">}</span><span>;</span></code></div>
<div class="source-line"><span class="line-number ">798</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<div class="source-line"><span class="line-number ">799</span><span class="line-counter cline-yes">&nbsp</span><code>/**</code></div>
<div class="source-line"><span class="line-number ">800</span><span class="line-counter cline-yes">&nbsp</span><code> * Gets whether or not this buffer is empty.</code></div>
<div class="source-line"><span class="line-number ">801</span><span class="line-counter cline-yes">&nbsp</span><code> *</code></div>
<div class="source-line"><span class="line-number ">802</span><span class="line-counter cline-yes">&nbsp</span><code> * @return true if this buffer is empty, false if not.</code></div>
<div class="source-line"><span class="line-number ">803</span><span class="line-counter cline-yes">&nbsp</span><code> */</code></div>
<div class="source-line"><span class="line-number ">804</span><span class="line-counter cline-no">！</span><code><span>util.DataBuffer.prototype.isEmpty = </span><span class="cstat-no" title="statement not covered">function() {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">805</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  return this.length() &lt;= 0;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">806</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">}</span><span>;</span></code></div>
<div class="source-line"><span class="line-number ">807</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<div class="source-line"><span class="line-number ">808</span><span class="line-counter cline-yes">&nbsp</span><code>/**</code></div>
<div class="source-line"><span class="line-number ">809</span><span class="line-counter cline-yes">&nbsp</span><code> * Ensures this buffer has enough empty space to accommodate the given number</code></div>
<div class="source-line"><span class="line-number ">810</span><span class="line-counter cline-yes">&nbsp</span><code> * of bytes. An optional parameter may be given that indicates a minimum</code></div>
<div class="source-line"><span class="line-number ">811</span><span class="line-counter cline-yes">&nbsp</span><code> * amount to grow the buffer if necessary. If the parameter is not given,</code></div>
<div class="source-line"><span class="line-number ">812</span><span class="line-counter cline-yes">&nbsp</span><code> * the buffer will be grown by some previously-specified default amount</code></div>
<div class="source-line"><span class="line-number ">813</span><span class="line-counter cline-yes">&nbsp</span><code> * or heuristic.</code></div>
<div class="source-line"><span class="line-number ">814</span><span class="line-counter cline-yes">&nbsp</span><code> *</code></div>
<div class="source-line"><span class="line-number ">815</span><span class="line-counter cline-yes">&nbsp</span><code> * @param amount the number of bytes to accommodate.</code></div>
<div class="source-line"><span class="line-number ">816</span><span class="line-counter cline-yes">&nbsp</span><code> * @param [growSize] the minimum amount, in bytes, to grow the buffer by if</code></div>
<div class="source-line"><span class="line-number ">817</span><span class="line-counter cline-yes">&nbsp</span><code> *          necessary.</code></div>
<div class="source-line"><span class="line-number ">818</span><span class="line-counter cline-yes">&nbsp</span><code> */</code></div>
<div class="source-line"><span class="line-number ">819</span><span class="line-counter cline-no">！</span><code><span>util.DataBuffer.prototype.accommodate = </span><span class="cstat-no" title="statement not covered">function(amount, growSize) {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">820</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  if(this.length() &gt;= amount) {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">821</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    return this;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">822</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  }</span><span></span></code></div>
<div class="source-line"><span class="line-number ">823</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  growSize = Math.max(growSize || this.growSize, amount);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">824</span><span class="line-counter cline-no">！</span><code><span class="cstat-no" title="statement not covered"><br/></span><span></span></code></div>
<div class="source-line"><span class="line-number ">825</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  // grow buffer</span><span></span></code></div>
<div class="source-line"><span class="line-number ">826</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  var src = new Uint8Array(</span><span></span></code></div>
<div class="source-line"><span class="line-number ">827</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    this.data.buffer, this.data.byteOffset, this.data.byteLength);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">828</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  var dst = new Uint8Array(this.length() + growSize);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">829</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  dst.set(src);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">830</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  this.data = new DataView(dst.buffer);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">831</span><span class="line-counter cline-no">！</span><code><span class="cstat-no" title="statement not covered"><br/></span><span></span></code></div>
<div class="source-line"><span class="line-number ">832</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  return this;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">833</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">}</span><span>;</span></code></div>
<div class="source-line"><span class="line-number ">834</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<div class="source-line"><span class="line-number ">835</span><span class="line-counter cline-yes">&nbsp</span><code>/**</code></div>
<div class="source-line"><span class="line-number ">836</span><span class="line-counter cline-yes">&nbsp</span><code> * Puts a byte in this buffer.</code></div>
<div class="source-line"><span class="line-number ">837</span><span class="line-counter cline-yes">&nbsp</span><code> *</code></div>
<div class="source-line"><span class="line-number ">838</span><span class="line-counter cline-yes">&nbsp</span><code> * @param b the byte to put.</code></div>
<div class="source-line"><span class="line-number ">839</span><span class="line-counter cline-yes">&nbsp</span><code> *</code></div>
<div class="source-line"><span class="line-number ">840</span><span class="line-counter cline-yes">&nbsp</span><code> * @return this buffer.</code></div>
<div class="source-line"><span class="line-number ">841</span><span class="line-counter cline-yes">&nbsp</span><code> */</code></div>
<div class="source-line"><span class="line-number ">842</span><span class="line-counter cline-no">！</span><code><span>util.DataBuffer.prototype.putByte = </span><span class="cstat-no" title="statement not covered">function(b) {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">843</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  this.accommodate(1);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">844</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  this.data.setUint8(this.write++, b);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">845</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  return this;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">846</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">}</span><span>;</span></code></div>
<div class="source-line"><span class="line-number ">847</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<div class="source-line"><span class="line-number ">848</span><span class="line-counter cline-yes">&nbsp</span><code>/**</code></div>
<div class="source-line"><span class="line-number ">849</span><span class="line-counter cline-yes">&nbsp</span><code> * Puts a byte in this buffer N times.</code></div>
<div class="source-line"><span class="line-number ">850</span><span class="line-counter cline-yes">&nbsp</span><code> *</code></div>
<div class="source-line"><span class="line-number ">851</span><span class="line-counter cline-yes">&nbsp</span><code> * @param b the byte to put.</code></div>
<div class="source-line"><span class="line-number ">852</span><span class="line-counter cline-yes">&nbsp</span><code> * @param n the number of bytes of value b to put.</code></div>
<div class="source-line"><span class="line-number ">853</span><span class="line-counter cline-yes">&nbsp</span><code> *</code></div>
<div class="source-line"><span class="line-number ">854</span><span class="line-counter cline-yes">&nbsp</span><code> * @return this buffer.</code></div>
<div class="source-line"><span class="line-number ">855</span><span class="line-counter cline-yes">&nbsp</span><code> */</code></div>
<div class="source-line"><span class="line-number ">856</span><span class="line-counter cline-no">！</span><code><span>util.DataBuffer.prototype.fillWithByte = </span><span class="cstat-no" title="statement not covered">function(b, n) {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">857</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  this.accommodate(n);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">858</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  for(var i = 0; i &lt; n; ++i) {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">859</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    this.data.setUint8(b);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">860</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  }</span><span></span></code></div>
<div class="source-line"><span class="line-number ">861</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  return this;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">862</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">}</span><span>;</span></code></div>
<div class="source-line"><span class="line-number ">863</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<div class="source-line"><span class="line-number ">864</span><span class="line-counter cline-yes">&nbsp</span><code>/**</code></div>
<div class="source-line"><span class="line-number ">865</span><span class="line-counter cline-yes">&nbsp</span><code> * Puts bytes in this buffer. The bytes may be given as a string, an</code></div>
<div class="source-line"><span class="line-number ">866</span><span class="line-counter cline-yes">&nbsp</span><code> * ArrayBuffer, a DataView, or a TypedArray.</code></div>
<div class="source-line"><span class="line-number ">867</span><span class="line-counter cline-yes">&nbsp</span><code> *</code></div>
<div class="source-line"><span class="line-number ">868</span><span class="line-counter cline-yes">&nbsp</span><code> * @param bytes the bytes to put.</code></div>
<div class="source-line"><span class="line-number ">869</span><span class="line-counter cline-yes">&nbsp</span><code> * @param [encoding] the encoding for the first parameter (&#39;binary&#39;, &#39;utf8&#39;,</code></div>
<div class="source-line"><span class="line-number ">870</span><span class="line-counter cline-yes">&nbsp</span><code> *          &#39;utf16&#39;, &#39;hex&#39;), if it is a string (default: &#39;binary&#39;).</code></div>
<div class="source-line"><span class="line-number ">871</span><span class="line-counter cline-yes">&nbsp</span><code> *</code></div>
<div class="source-line"><span class="line-number ">872</span><span class="line-counter cline-yes">&nbsp</span><code> * @return this buffer.</code></div>
<div class="source-line"><span class="line-number ">873</span><span class="line-counter cline-yes">&nbsp</span><code> */</code></div>
<div class="source-line"><span class="line-number ">874</span><span class="line-counter cline-no">！</span><code><span>util.DataBuffer.prototype.putBytes = </span><span class="cstat-no" title="statement not covered">function(bytes, encoding) {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">875</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  if(util.isArrayBufferView(bytes)) {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">876</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    var src = new Uint8Array(bytes.buffer, bytes.byteOffset, bytes.byteLength);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">877</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    var len = src.byteLength - src.byteOffset;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">878</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    this.accommodate(len);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">879</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    var dst = new Uint8Array(this.data.buffer, this.write);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">880</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    dst.set(src);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">881</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    this.write += len;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">882</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    return this;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">883</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  }</span><span></span></code></div>
<div class="source-line"><span class="line-number ">884</span><span class="line-counter cline-no">！</span><code><span class="cstat-no" title="statement not covered"><br/></span><span></span></code></div>
<div class="source-line"><span class="line-number ">885</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  if(util.isArrayBuffer(bytes)) {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">886</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    var src = new Uint8Array(bytes);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">887</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    this.accommodate(src.byteLength);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">888</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    var dst = new Uint8Array(this.data.buffer);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">889</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    dst.set(src, this.write);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">890</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    this.write += src.byteLength;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">891</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    return this;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">892</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  }</span><span></span></code></div>
<div class="source-line"><span class="line-number ">893</span><span class="line-counter cline-no">！</span><code><span class="cstat-no" title="statement not covered"><br/></span><span></span></code></div>
<div class="source-line"><span class="line-number ">894</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  // bytes is a util.DataBuffer or equivalent</span><span></span></code></div>
<div class="source-line"><span class="line-number ">895</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  if(bytes instanceof util.DataBuffer ||</span><span></span></code></div>
<div class="source-line"><span class="line-number ">896</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    (typeof bytes === &#39;object&#39; &amp;&amp;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">897</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    typeof bytes.read === &#39;number&#39; &amp;&amp; typeof bytes.write === &#39;number&#39; &amp;&amp;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">898</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    util.isArrayBufferView(bytes.data))) {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">899</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    var src = new Uint8Array(bytes.data.byteLength, bytes.read, bytes.length());</span><span></span></code></div>
<div class="source-line"><span class="line-number ">900</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    this.accommodate(src.byteLength);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">901</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    var dst = new Uint8Array(bytes.data.byteLength, this.write);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">902</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    dst.set(src);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">903</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    this.write += src.byteLength;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">904</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    return this;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">905</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  }</span><span></span></code></div>
<div class="source-line"><span class="line-number ">906</span><span class="line-counter cline-no">！</span><code><span class="cstat-no" title="statement not covered"><br/></span><span></span></code></div>
<div class="source-line"><span class="line-number ">907</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  if(bytes instanceof util.ByteStringBuffer) {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">908</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    // copy binary string and process as the same as a string parameter below</span><span></span></code></div>
<div class="source-line"><span class="line-number ">909</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    bytes = bytes.data;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">910</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    encoding = &#39;binary&#39;;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">911</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  }</span><span></span></code></div>
<div class="source-line"><span class="line-number ">912</span><span class="line-counter cline-no">！</span><code><span class="cstat-no" title="statement not covered"><br/></span><span></span></code></div>
<div class="source-line"><span class="line-number ">913</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  // string conversion</span><span></span></code></div>
<div class="source-line"><span class="line-number ">914</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  encoding = encoding || &#39;binary&#39;;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">915</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  if(typeof bytes === &#39;string&#39;) {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">916</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    var view;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">917</span><span class="line-counter cline-no">！</span><code><span class="cstat-no" title="statement not covered"><br/></span><span></span></code></div>
<div class="source-line"><span class="line-number ">918</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    // decode from string</span><span></span></code></div>
<div class="source-line"><span class="line-number ">919</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    if(encoding === &#39;hex&#39;) {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">920</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">      this.accommodate(Math.ceil(bytes.length / 2));</span><span></span></code></div>
<div class="source-line"><span class="line-number ">921</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">      view = new Uint8Array(this.data.buffer, this.write);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">922</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">      this.write += util.binary.hex.decode(bytes, view, this.write);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">923</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">      return this;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">924</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    }</span><span></span></code></div>
<div class="source-line"><span class="line-number ">925</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    if(encoding === &#39;base64&#39;) {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">926</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">      this.accommodate(Math.ceil(bytes.length / 4) * 3);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">927</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">      view = new Uint8Array(this.data.buffer, this.write);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">928</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">      this.write += util.binary.base64.decode(bytes, view, this.write);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">929</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">      return this;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">930</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    }</span><span></span></code></div>
<div class="source-line"><span class="line-number ">931</span><span class="line-counter cline-no">！</span><code><span class="cstat-no" title="statement not covered"><br/></span><span></span></code></div>
<div class="source-line"><span class="line-number ">932</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    // encode text as UTF-8 bytes</span><span></span></code></div>
<div class="source-line"><span class="line-number ">933</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    if(encoding === &#39;utf8&#39;) {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">934</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">      // encode as UTF-8 then decode string as raw binary</span><span></span></code></div>
<div class="source-line"><span class="line-number ">935</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">      bytes = util.encodeUtf8(bytes);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">936</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">      encoding = &#39;binary&#39;;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">937</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    }</span><span></span></code></div>
<div class="source-line"><span class="line-number ">938</span><span class="line-counter cline-no">！</span><code><span class="cstat-no" title="statement not covered"><br/></span><span></span></code></div>
<div class="source-line"><span class="line-number ">939</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    // decode string as raw binary</span><span></span></code></div>
<div class="source-line"><span class="line-number ">940</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    if(encoding === &#39;binary&#39; || encoding === &#39;raw&#39;) {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">941</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">      // one byte per character</span><span></span></code></div>
<div class="source-line"><span class="line-number ">942</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">      this.accommodate(bytes.length);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">943</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">      view = new Uint8Array(this.data.buffer, this.write);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">944</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">      this.write += util.binary.raw.decode(view);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">945</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">      return this;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">946</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    }</span><span></span></code></div>
<div class="source-line"><span class="line-number ">947</span><span class="line-counter cline-no">！</span><code><span class="cstat-no" title="statement not covered"><br/></span><span></span></code></div>
<div class="source-line"><span class="line-number ">948</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    // encode text as UTF-16 bytes</span><span></span></code></div>
<div class="source-line"><span class="line-number ">949</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    if(encoding === &#39;utf16&#39;) {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">950</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">      // two bytes per character</span><span></span></code></div>
<div class="source-line"><span class="line-number ">951</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">      this.accommodate(bytes.length * 2);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">952</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">      view = new Uint16Array(this.data.buffer, this.write);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">953</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">      this.write += util.text.utf16.encode(view);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">954</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">      return this;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">955</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    }</span><span></span></code></div>
<div class="source-line"><span class="line-number ">956</span><span class="line-counter cline-no">！</span><code><span class="cstat-no" title="statement not covered"><br/></span><span></span></code></div>
<div class="source-line"><span class="line-number ">957</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    throw new Error(&#39;Invalid encoding: &#39; + encoding);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">958</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  }</span><span></span></code></div>
<div class="source-line"><span class="line-number ">959</span><span class="line-counter cline-no">！</span><code><span class="cstat-no" title="statement not covered"><br/></span><span></span></code></div>
<div class="source-line"><span class="line-number ">960</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  throw Error(&#39;Invalid parameter: &#39; + bytes);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">961</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">}</span><span>;</span></code></div>
<div class="source-line"><span class="line-number ">962</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<div class="source-line"><span class="line-number ">963</span><span class="line-counter cline-yes">&nbsp</span><code>/**</code></div>
<div class="source-line"><span class="line-number ">964</span><span class="line-counter cline-yes">&nbsp</span><code> * Puts the given buffer into this buffer.</code></div>
<div class="source-line"><span class="line-number ">965</span><span class="line-counter cline-yes">&nbsp</span><code> *</code></div>
<div class="source-line"><span class="line-number ">966</span><span class="line-counter cline-yes">&nbsp</span><code> * @param buffer the buffer to put into this one.</code></div>
<div class="source-line"><span class="line-number ">967</span><span class="line-counter cline-yes">&nbsp</span><code> *</code></div>
<div class="source-line"><span class="line-number ">968</span><span class="line-counter cline-yes">&nbsp</span><code> * @return this buffer.</code></div>
<div class="source-line"><span class="line-number ">969</span><span class="line-counter cline-yes">&nbsp</span><code> */</code></div>
<div class="source-line"><span class="line-number ">970</span><span class="line-counter cline-no">！</span><code><span>util.DataBuffer.prototype.putBuffer = </span><span class="cstat-no" title="statement not covered">function(buffer) {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">971</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  this.putBytes(buffer);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">972</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  buffer.clear();</span><span></span></code></div>
<div class="source-line"><span class="line-number ">973</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  return this;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">974</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">}</span><span>;</span></code></div>
<div class="source-line"><span class="line-number ">975</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<div class="source-line"><span class="line-number ">976</span><span class="line-counter cline-yes">&nbsp</span><code>/**</code></div>
<div class="source-line"><span class="line-number ">977</span><span class="line-counter cline-yes">&nbsp</span><code> * Puts a string into this buffer.</code></div>
<div class="source-line"><span class="line-number ">978</span><span class="line-counter cline-yes">&nbsp</span><code> *</code></div>
<div class="source-line"><span class="line-number ">979</span><span class="line-counter cline-yes">&nbsp</span><code> * @param str the string to put.</code></div>
<div class="source-line"><span class="line-number ">980</span><span class="line-counter cline-yes">&nbsp</span><code> * @param [encoding] the encoding for the string (default: &#39;utf16&#39;).</code></div>
<div class="source-line"><span class="line-number ">981</span><span class="line-counter cline-yes">&nbsp</span><code> *</code></div>
<div class="source-line"><span class="line-number ">982</span><span class="line-counter cline-yes">&nbsp</span><code> * @return this buffer.</code></div>
<div class="source-line"><span class="line-number ">983</span><span class="line-counter cline-yes">&nbsp</span><code> */</code></div>
<div class="source-line"><span class="line-number ">984</span><span class="line-counter cline-no">！</span><code><span>util.DataBuffer.prototype.putString = </span><span class="cstat-no" title="statement not covered">function(str) {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">985</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  return this.putBytes(str, &#39;utf16&#39;);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">986</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">}</span><span>;</span></code></div>
<div class="source-line"><span class="line-number ">987</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<div class="source-line"><span class="line-number ">988</span><span class="line-counter cline-yes">&nbsp</span><code>/**</code></div>
<div class="source-line"><span class="line-number ">989</span><span class="line-counter cline-yes">&nbsp</span><code> * Puts a 16-bit integer in this buffer in big-endian order.</code></div>
<div class="source-line"><span class="line-number ">990</span><span class="line-counter cline-yes">&nbsp</span><code> *</code></div>
<div class="source-line"><span class="line-number ">991</span><span class="line-counter cline-yes">&nbsp</span><code> * @param i the 16-bit integer.</code></div>
<div class="source-line"><span class="line-number ">992</span><span class="line-counter cline-yes">&nbsp</span><code> *</code></div>
<div class="source-line"><span class="line-number ">993</span><span class="line-counter cline-yes">&nbsp</span><code> * @return this buffer.</code></div>
<div class="source-line"><span class="line-number ">994</span><span class="line-counter cline-yes">&nbsp</span><code> */</code></div>
<div class="source-line"><span class="line-number ">995</span><span class="line-counter cline-no">！</span><code><span>util.DataBuffer.prototype.putInt16 = </span><span class="cstat-no" title="statement not covered">function(i) {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">996</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  this.accommodate(2);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">997</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  this.data.setInt16(this.write, i);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">998</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  this.write += 2;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">999</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  return this;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1000</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">}</span><span>;</span></code></div>
<div class="source-line"><span class="line-number ">1001</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<div class="source-line"><span class="line-number ">1002</span><span class="line-counter cline-yes">&nbsp</span><code>/**</code></div>
<div class="source-line"><span class="line-number ">1003</span><span class="line-counter cline-yes">&nbsp</span><code> * Puts a 24-bit integer in this buffer in big-endian order.</code></div>
<div class="source-line"><span class="line-number ">1004</span><span class="line-counter cline-yes">&nbsp</span><code> *</code></div>
<div class="source-line"><span class="line-number ">1005</span><span class="line-counter cline-yes">&nbsp</span><code> * @param i the 24-bit integer.</code></div>
<div class="source-line"><span class="line-number ">1006</span><span class="line-counter cline-yes">&nbsp</span><code> *</code></div>
<div class="source-line"><span class="line-number ">1007</span><span class="line-counter cline-yes">&nbsp</span><code> * @return this buffer.</code></div>
<div class="source-line"><span class="line-number ">1008</span><span class="line-counter cline-yes">&nbsp</span><code> */</code></div>
<div class="source-line"><span class="line-number ">1009</span><span class="line-counter cline-no">！</span><code><span>util.DataBuffer.prototype.putInt24 = </span><span class="cstat-no" title="statement not covered">function(i) {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1010</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  this.accommodate(3);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1011</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  this.data.setInt16(this.write, i &gt;&gt; 8 &amp; 0xFFFF);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1012</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  this.data.setInt8(this.write, i &gt;&gt; 16 &amp; 0xFF);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1013</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  this.write += 3;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1014</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  return this;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1015</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">}</span><span>;</span></code></div>
<div class="source-line"><span class="line-number ">1016</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<div class="source-line"><span class="line-number ">1017</span><span class="line-counter cline-yes">&nbsp</span><code>/**</code></div>
<div class="source-line"><span class="line-number ">1018</span><span class="line-counter cline-yes">&nbsp</span><code> * Puts a 32-bit integer in this buffer in big-endian order.</code></div>
<div class="source-line"><span class="line-number ">1019</span><span class="line-counter cline-yes">&nbsp</span><code> *</code></div>
<div class="source-line"><span class="line-number ">1020</span><span class="line-counter cline-yes">&nbsp</span><code> * @param i the 32-bit integer.</code></div>
<div class="source-line"><span class="line-number ">1021</span><span class="line-counter cline-yes">&nbsp</span><code> *</code></div>
<div class="source-line"><span class="line-number ">1022</span><span class="line-counter cline-yes">&nbsp</span><code> * @return this buffer.</code></div>
<div class="source-line"><span class="line-number ">1023</span><span class="line-counter cline-yes">&nbsp</span><code> */</code></div>
<div class="source-line"><span class="line-number ">1024</span><span class="line-counter cline-no">！</span><code><span>util.DataBuffer.prototype.putInt32 = </span><span class="cstat-no" title="statement not covered">function(i) {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1025</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  this.accommodate(4);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1026</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  this.data.setInt32(this.write, i);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1027</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  this.write += 4;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1028</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  return this;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1029</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">}</span><span>;</span></code></div>
<div class="source-line"><span class="line-number ">1030</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<div class="source-line"><span class="line-number ">1031</span><span class="line-counter cline-yes">&nbsp</span><code>/**</code></div>
<div class="source-line"><span class="line-number ">1032</span><span class="line-counter cline-yes">&nbsp</span><code> * Puts a 16-bit integer in this buffer in little-endian order.</code></div>
<div class="source-line"><span class="line-number ">1033</span><span class="line-counter cline-yes">&nbsp</span><code> *</code></div>
<div class="source-line"><span class="line-number ">1034</span><span class="line-counter cline-yes">&nbsp</span><code> * @param i the 16-bit integer.</code></div>
<div class="source-line"><span class="line-number ">1035</span><span class="line-counter cline-yes">&nbsp</span><code> *</code></div>
<div class="source-line"><span class="line-number ">1036</span><span class="line-counter cline-yes">&nbsp</span><code> * @return this buffer.</code></div>
<div class="source-line"><span class="line-number ">1037</span><span class="line-counter cline-yes">&nbsp</span><code> */</code></div>
<div class="source-line"><span class="line-number ">1038</span><span class="line-counter cline-no">！</span><code><span>util.DataBuffer.prototype.putInt16Le = </span><span class="cstat-no" title="statement not covered">function(i) {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1039</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  this.accommodate(2);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1040</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  this.data.setInt16(this.write, i, true);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1041</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  this.write += 2;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1042</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  return this;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1043</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">}</span><span>;</span></code></div>
<div class="source-line"><span class="line-number ">1044</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<div class="source-line"><span class="line-number ">1045</span><span class="line-counter cline-yes">&nbsp</span><code>/**</code></div>
<div class="source-line"><span class="line-number ">1046</span><span class="line-counter cline-yes">&nbsp</span><code> * Puts a 24-bit integer in this buffer in little-endian order.</code></div>
<div class="source-line"><span class="line-number ">1047</span><span class="line-counter cline-yes">&nbsp</span><code> *</code></div>
<div class="source-line"><span class="line-number ">1048</span><span class="line-counter cline-yes">&nbsp</span><code> * @param i the 24-bit integer.</code></div>
<div class="source-line"><span class="line-number ">1049</span><span class="line-counter cline-yes">&nbsp</span><code> *</code></div>
<div class="source-line"><span class="line-number ">1050</span><span class="line-counter cline-yes">&nbsp</span><code> * @return this buffer.</code></div>
<div class="source-line"><span class="line-number ">1051</span><span class="line-counter cline-yes">&nbsp</span><code> */</code></div>
<div class="source-line"><span class="line-number ">1052</span><span class="line-counter cline-no">！</span><code><span>util.DataBuffer.prototype.putInt24Le = </span><span class="cstat-no" title="statement not covered">function(i) {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1053</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  this.accommodate(3);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1054</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  this.data.setInt8(this.write, i &gt;&gt; 16 &amp; 0xFF);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1055</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  this.data.setInt16(this.write, i &gt;&gt; 8 &amp; 0xFFFF, true);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1056</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  this.write += 3;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1057</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  return this;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1058</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">}</span><span>;</span></code></div>
<div class="source-line"><span class="line-number ">1059</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<div class="source-line"><span class="line-number ">1060</span><span class="line-counter cline-yes">&nbsp</span><code>/**</code></div>
<div class="source-line"><span class="line-number ">1061</span><span class="line-counter cline-yes">&nbsp</span><code> * Puts a 32-bit integer in this buffer in little-endian order.</code></div>
<div class="source-line"><span class="line-number ">1062</span><span class="line-counter cline-yes">&nbsp</span><code> *</code></div>
<div class="source-line"><span class="line-number ">1063</span><span class="line-counter cline-yes">&nbsp</span><code> * @param i the 32-bit integer.</code></div>
<div class="source-line"><span class="line-number ">1064</span><span class="line-counter cline-yes">&nbsp</span><code> *</code></div>
<div class="source-line"><span class="line-number ">1065</span><span class="line-counter cline-yes">&nbsp</span><code> * @return this buffer.</code></div>
<div class="source-line"><span class="line-number ">1066</span><span class="line-counter cline-yes">&nbsp</span><code> */</code></div>
<div class="source-line"><span class="line-number ">1067</span><span class="line-counter cline-no">！</span><code><span>util.DataBuffer.prototype.putInt32Le = </span><span class="cstat-no" title="statement not covered">function(i) {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1068</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  this.accommodate(4);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1069</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  this.data.setInt32(this.write, i, true);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1070</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  this.write += 4;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1071</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  return this;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1072</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">}</span><span>;</span></code></div>
<div class="source-line"><span class="line-number ">1073</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<div class="source-line"><span class="line-number ">1074</span><span class="line-counter cline-yes">&nbsp</span><code>/**</code></div>
<div class="source-line"><span class="line-number ">1075</span><span class="line-counter cline-yes">&nbsp</span><code> * Puts an n-bit integer in this buffer in big-endian order.</code></div>
<div class="source-line"><span class="line-number ">1076</span><span class="line-counter cline-yes">&nbsp</span><code> *</code></div>
<div class="source-line"><span class="line-number ">1077</span><span class="line-counter cline-yes">&nbsp</span><code> * @param i the n-bit integer.</code></div>
<div class="source-line"><span class="line-number ">1078</span><span class="line-counter cline-yes">&nbsp</span><code> * @param n the number of bits in the integer (8, 16, 24, or 32).</code></div>
<div class="source-line"><span class="line-number ">1079</span><span class="line-counter cline-yes">&nbsp</span><code> *</code></div>
<div class="source-line"><span class="line-number ">1080</span><span class="line-counter cline-yes">&nbsp</span><code> * @return this buffer.</code></div>
<div class="source-line"><span class="line-number ">1081</span><span class="line-counter cline-yes">&nbsp</span><code> */</code></div>
<div class="source-line"><span class="line-number ">1082</span><span class="line-counter cline-no">！</span><code><span>util.DataBuffer.prototype.putInt = </span><span class="cstat-no" title="statement not covered">function(i, n) {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1083</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  _checkBitsParam(n);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1084</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  this.accommodate(n / 8);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1085</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  do {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1086</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    n -= 8;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1087</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    this.data.setInt8(this.write++, (i &gt;&gt; n) &amp; 0xFF);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1088</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  } while(n &gt; 0);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1089</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  return this;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1090</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">}</span><span>;</span></code></div>
<div class="source-line"><span class="line-number ">1091</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<div class="source-line"><span class="line-number ">1092</span><span class="line-counter cline-yes">&nbsp</span><code>/**</code></div>
<div class="source-line"><span class="line-number ">1093</span><span class="line-counter cline-yes">&nbsp</span><code> * Puts a signed n-bit integer in this buffer in big-endian order. Two&#39;s</code></div>
<div class="source-line"><span class="line-number ">1094</span><span class="line-counter cline-yes">&nbsp</span><code> * complement representation is used.</code></div>
<div class="source-line"><span class="line-number ">1095</span><span class="line-counter cline-yes">&nbsp</span><code> *</code></div>
<div class="source-line"><span class="line-number ">1096</span><span class="line-counter cline-yes">&nbsp</span><code> * @param i the n-bit integer.</code></div>
<div class="source-line"><span class="line-number ">1097</span><span class="line-counter cline-yes">&nbsp</span><code> * @param n the number of bits in the integer.</code></div>
<div class="source-line"><span class="line-number ">1098</span><span class="line-counter cline-yes">&nbsp</span><code> *</code></div>
<div class="source-line"><span class="line-number ">1099</span><span class="line-counter cline-yes">&nbsp</span><code> * @return this buffer.</code></div>
<div class="source-line"><span class="line-number ">1100</span><span class="line-counter cline-yes">&nbsp</span><code> */</code></div>
<div class="source-line"><span class="line-number ">1101</span><span class="line-counter cline-no">！</span><code><span>util.DataBuffer.prototype.putSignedInt = </span><span class="cstat-no" title="statement not covered">function(i, n) {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1102</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  _checkBitsParam(n);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1103</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  this.accommodate(n / 8);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1104</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  if(i &lt; 0) {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1105</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    i += 2 &lt;&lt; (n - 1);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1106</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  }</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1107</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  return this.putInt(i, n);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1108</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">}</span><span>;</span></code></div>
<div class="source-line"><span class="line-number ">1109</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<div class="source-line"><span class="line-number ">1110</span><span class="line-counter cline-yes">&nbsp</span><code>/**</code></div>
<div class="source-line"><span class="line-number ">1111</span><span class="line-counter cline-yes">&nbsp</span><code> * Gets a byte from this buffer and advances the read pointer by 1.</code></div>
<div class="source-line"><span class="line-number ">1112</span><span class="line-counter cline-yes">&nbsp</span><code> *</code></div>
<div class="source-line"><span class="line-number ">1113</span><span class="line-counter cline-yes">&nbsp</span><code> * @return the byte.</code></div>
<div class="source-line"><span class="line-number ">1114</span><span class="line-counter cline-yes">&nbsp</span><code> */</code></div>
<div class="source-line"><span class="line-number ">1115</span><span class="line-counter cline-no">！</span><code><span>util.DataBuffer.prototype.getByte = </span><span class="cstat-no" title="statement not covered">function() {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1116</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  return this.data.getInt8(this.read++);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1117</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">}</span><span>;</span></code></div>
<div class="source-line"><span class="line-number ">1118</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<div class="source-line"><span class="line-number ">1119</span><span class="line-counter cline-yes">&nbsp</span><code>/**</code></div>
<div class="source-line"><span class="line-number ">1120</span><span class="line-counter cline-yes">&nbsp</span><code> * Gets a uint16 from this buffer in big-endian order and advances the read</code></div>
<div class="source-line"><span class="line-number ">1121</span><span class="line-counter cline-yes">&nbsp</span><code> * pointer by 2.</code></div>
<div class="source-line"><span class="line-number ">1122</span><span class="line-counter cline-yes">&nbsp</span><code> *</code></div>
<div class="source-line"><span class="line-number ">1123</span><span class="line-counter cline-yes">&nbsp</span><code> * @return the uint16.</code></div>
<div class="source-line"><span class="line-number ">1124</span><span class="line-counter cline-yes">&nbsp</span><code> */</code></div>
<div class="source-line"><span class="line-number ">1125</span><span class="line-counter cline-no">！</span><code><span>util.DataBuffer.prototype.getInt16 = </span><span class="cstat-no" title="statement not covered">function() {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1126</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  var rval = this.data.getInt16(this.read);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1127</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  this.read += 2;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1128</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  return rval;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1129</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">}</span><span>;</span></code></div>
<div class="source-line"><span class="line-number ">1130</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<div class="source-line"><span class="line-number ">1131</span><span class="line-counter cline-yes">&nbsp</span><code>/**</code></div>
<div class="source-line"><span class="line-number ">1132</span><span class="line-counter cline-yes">&nbsp</span><code> * Gets a uint24 from this buffer in big-endian order and advances the read</code></div>
<div class="source-line"><span class="line-number ">1133</span><span class="line-counter cline-yes">&nbsp</span><code> * pointer by 3.</code></div>
<div class="source-line"><span class="line-number ">1134</span><span class="line-counter cline-yes">&nbsp</span><code> *</code></div>
<div class="source-line"><span class="line-number ">1135</span><span class="line-counter cline-yes">&nbsp</span><code> * @return the uint24.</code></div>
<div class="source-line"><span class="line-number ">1136</span><span class="line-counter cline-yes">&nbsp</span><code> */</code></div>
<div class="source-line"><span class="line-number ">1137</span><span class="line-counter cline-no">！</span><code><span>util.DataBuffer.prototype.getInt24 = </span><span class="cstat-no" title="statement not covered">function() {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1138</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  var rval = (</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1139</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    this.data.getInt16(this.read) &lt;&lt; 8 ^</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1140</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    this.data.getInt8(this.read + 2));</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1141</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  this.read += 3;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1142</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  return rval;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1143</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">}</span><span>;</span></code></div>
<div class="source-line"><span class="line-number ">1144</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<div class="source-line"><span class="line-number ">1145</span><span class="line-counter cline-yes">&nbsp</span><code>/**</code></div>
<div class="source-line"><span class="line-number ">1146</span><span class="line-counter cline-yes">&nbsp</span><code> * Gets a uint32 from this buffer in big-endian order and advances the read</code></div>
<div class="source-line"><span class="line-number ">1147</span><span class="line-counter cline-yes">&nbsp</span><code> * pointer by 4.</code></div>
<div class="source-line"><span class="line-number ">1148</span><span class="line-counter cline-yes">&nbsp</span><code> *</code></div>
<div class="source-line"><span class="line-number ">1149</span><span class="line-counter cline-yes">&nbsp</span><code> * @return the word.</code></div>
<div class="source-line"><span class="line-number ">1150</span><span class="line-counter cline-yes">&nbsp</span><code> */</code></div>
<div class="source-line"><span class="line-number ">1151</span><span class="line-counter cline-no">！</span><code><span>util.DataBuffer.prototype.getInt32 = </span><span class="cstat-no" title="statement not covered">function() {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1152</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  var rval = this.data.getInt32(this.read);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1153</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  this.read += 4;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1154</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  return rval;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1155</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">}</span><span>;</span></code></div>
<div class="source-line"><span class="line-number ">1156</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<div class="source-line"><span class="line-number ">1157</span><span class="line-counter cline-yes">&nbsp</span><code>/**</code></div>
<div class="source-line"><span class="line-number ">1158</span><span class="line-counter cline-yes">&nbsp</span><code> * Gets a uint16 from this buffer in little-endian order and advances the read</code></div>
<div class="source-line"><span class="line-number ">1159</span><span class="line-counter cline-yes">&nbsp</span><code> * pointer by 2.</code></div>
<div class="source-line"><span class="line-number ">1160</span><span class="line-counter cline-yes">&nbsp</span><code> *</code></div>
<div class="source-line"><span class="line-number ">1161</span><span class="line-counter cline-yes">&nbsp</span><code> * @return the uint16.</code></div>
<div class="source-line"><span class="line-number ">1162</span><span class="line-counter cline-yes">&nbsp</span><code> */</code></div>
<div class="source-line"><span class="line-number ">1163</span><span class="line-counter cline-no">！</span><code><span>util.DataBuffer.prototype.getInt16Le = </span><span class="cstat-no" title="statement not covered">function() {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1164</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  var rval = this.data.getInt16(this.read, true);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1165</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  this.read += 2;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1166</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  return rval;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1167</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">}</span><span>;</span></code></div>
<div class="source-line"><span class="line-number ">1168</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<div class="source-line"><span class="line-number ">1169</span><span class="line-counter cline-yes">&nbsp</span><code>/**</code></div>
<div class="source-line"><span class="line-number ">1170</span><span class="line-counter cline-yes">&nbsp</span><code> * Gets a uint24 from this buffer in little-endian order and advances the read</code></div>
<div class="source-line"><span class="line-number ">1171</span><span class="line-counter cline-yes">&nbsp</span><code> * pointer by 3.</code></div>
<div class="source-line"><span class="line-number ">1172</span><span class="line-counter cline-yes">&nbsp</span><code> *</code></div>
<div class="source-line"><span class="line-number ">1173</span><span class="line-counter cline-yes">&nbsp</span><code> * @return the uint24.</code></div>
<div class="source-line"><span class="line-number ">1174</span><span class="line-counter cline-yes">&nbsp</span><code> */</code></div>
<div class="source-line"><span class="line-number ">1175</span><span class="line-counter cline-no">！</span><code><span>util.DataBuffer.prototype.getInt24Le = </span><span class="cstat-no" title="statement not covered">function() {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1176</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  var rval = (</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1177</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    this.data.getInt8(this.read) ^</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1178</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    this.data.getInt16(this.read + 1, true) &lt;&lt; 8);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1179</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  this.read += 3;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1180</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  return rval;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1181</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">}</span><span>;</span></code></div>
<div class="source-line"><span class="line-number ">1182</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<div class="source-line"><span class="line-number ">1183</span><span class="line-counter cline-yes">&nbsp</span><code>/**</code></div>
<div class="source-line"><span class="line-number ">1184</span><span class="line-counter cline-yes">&nbsp</span><code> * Gets a uint32 from this buffer in little-endian order and advances the read</code></div>
<div class="source-line"><span class="line-number ">1185</span><span class="line-counter cline-yes">&nbsp</span><code> * pointer by 4.</code></div>
<div class="source-line"><span class="line-number ">1186</span><span class="line-counter cline-yes">&nbsp</span><code> *</code></div>
<div class="source-line"><span class="line-number ">1187</span><span class="line-counter cline-yes">&nbsp</span><code> * @return the word.</code></div>
<div class="source-line"><span class="line-number ">1188</span><span class="line-counter cline-yes">&nbsp</span><code> */</code></div>
<div class="source-line"><span class="line-number ">1189</span><span class="line-counter cline-no">！</span><code><span>util.DataBuffer.prototype.getInt32Le = </span><span class="cstat-no" title="statement not covered">function() {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1190</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  var rval = this.data.getInt32(this.read, true);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1191</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  this.read += 4;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1192</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  return rval;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1193</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">}</span><span>;</span></code></div>
<div class="source-line"><span class="line-number ">1194</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<div class="source-line"><span class="line-number ">1195</span><span class="line-counter cline-yes">&nbsp</span><code>/**</code></div>
<div class="source-line"><span class="line-number ">1196</span><span class="line-counter cline-yes">&nbsp</span><code> * Gets an n-bit integer from this buffer in big-endian order and advances the</code></div>
<div class="source-line"><span class="line-number ">1197</span><span class="line-counter cline-yes">&nbsp</span><code> * read pointer by n/8.</code></div>
<div class="source-line"><span class="line-number ">1198</span><span class="line-counter cline-yes">&nbsp</span><code> *</code></div>
<div class="source-line"><span class="line-number ">1199</span><span class="line-counter cline-yes">&nbsp</span><code> * @param n the number of bits in the integer (8, 16, 24, or 32).</code></div>
<div class="source-line"><span class="line-number ">1200</span><span class="line-counter cline-yes">&nbsp</span><code> *</code></div>
<div class="source-line"><span class="line-number ">1201</span><span class="line-counter cline-yes">&nbsp</span><code> * @return the integer.</code></div>
<div class="source-line"><span class="line-number ">1202</span><span class="line-counter cline-yes">&nbsp</span><code> */</code></div>
<div class="source-line"><span class="line-number ">1203</span><span class="line-counter cline-no">！</span><code><span>util.DataBuffer.prototype.getInt = </span><span class="cstat-no" title="statement not covered">function(n) {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1204</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  _checkBitsParam(n);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1205</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  var rval = 0;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1206</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  do {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1207</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    // TODO: Use (rval * 0x100) if adding support for 33 to 53 bits.</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1208</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    rval = (rval &lt;&lt; 8) + this.data.getInt8(this.read++);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1209</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    n -= 8;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1210</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  } while(n &gt; 0);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1211</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  return rval;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1212</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">}</span><span>;</span></code></div>
<div class="source-line"><span class="line-number ">1213</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<div class="source-line"><span class="line-number ">1214</span><span class="line-counter cline-yes">&nbsp</span><code>/**</code></div>
<div class="source-line"><span class="line-number ">1215</span><span class="line-counter cline-yes">&nbsp</span><code> * Gets a signed n-bit integer from this buffer in big-endian order, using</code></div>
<div class="source-line"><span class="line-number ">1216</span><span class="line-counter cline-yes">&nbsp</span><code> * two&#39;s complement, and advances the read pointer by n/8.</code></div>
<div class="source-line"><span class="line-number ">1217</span><span class="line-counter cline-yes">&nbsp</span><code> *</code></div>
<div class="source-line"><span class="line-number ">1218</span><span class="line-counter cline-yes">&nbsp</span><code> * @param n the number of bits in the integer (8, 16, 24, or 32).</code></div>
<div class="source-line"><span class="line-number ">1219</span><span class="line-counter cline-yes">&nbsp</span><code> *</code></div>
<div class="source-line"><span class="line-number ">1220</span><span class="line-counter cline-yes">&nbsp</span><code> * @return the integer.</code></div>
<div class="source-line"><span class="line-number ">1221</span><span class="line-counter cline-yes">&nbsp</span><code> */</code></div>
<div class="source-line"><span class="line-number ">1222</span><span class="line-counter cline-no">！</span><code><span>util.DataBuffer.prototype.getSignedInt = </span><span class="cstat-no" title="statement not covered">function(n) {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1223</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  // getInt checks n</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1224</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  var x = this.getInt(n);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1225</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  var max = 2 &lt;&lt; (n - 2);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1226</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  if(x &gt;= max) {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1227</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    x -= max &lt;&lt; 1;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1228</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  }</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1229</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  return x;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1230</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">}</span><span>;</span></code></div>
<div class="source-line"><span class="line-number ">1231</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<div class="source-line"><span class="line-number ">1232</span><span class="line-counter cline-yes">&nbsp</span><code>/**</code></div>
<div class="source-line"><span class="line-number ">1233</span><span class="line-counter cline-yes">&nbsp</span><code> * Reads bytes out as a binary encoded string and clears them from the</code></div>
<div class="source-line"><span class="line-number ">1234</span><span class="line-counter cline-yes">&nbsp</span><code> * buffer.</code></div>
<div class="source-line"><span class="line-number ">1235</span><span class="line-counter cline-yes">&nbsp</span><code> *</code></div>
<div class="source-line"><span class="line-number ">1236</span><span class="line-counter cline-yes">&nbsp</span><code> * @param count the number of bytes to read, undefined or null for all.</code></div>
<div class="source-line"><span class="line-number ">1237</span><span class="line-counter cline-yes">&nbsp</span><code> *</code></div>
<div class="source-line"><span class="line-number ">1238</span><span class="line-counter cline-yes">&nbsp</span><code> * @return a binary encoded string of bytes.</code></div>
<div class="source-line"><span class="line-number ">1239</span><span class="line-counter cline-yes">&nbsp</span><code> */</code></div>
<div class="source-line"><span class="line-number ">1240</span><span class="line-counter cline-no">！</span><code><span>util.DataBuffer.prototype.getBytes = </span><span class="cstat-no" title="statement not covered">function(count) {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1241</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  // TODO: deprecate this method, it is poorly named and</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1242</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  // this.toString(&#39;binary&#39;) replaces it</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1243</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  // add a toTypedArray()/toArrayBuffer() function</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1244</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  var rval;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1245</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  if(count) {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1246</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    // read count bytes</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1247</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    count = Math.min(this.length(), count);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1248</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    rval = this.data.slice(this.read, this.read + count);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1249</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    this.read += count;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1250</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  } else if(count === 0) {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1251</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    rval = &#39;&#39;;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1252</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  } else {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1253</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    // read all bytes, optimize to only copy when needed</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1254</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    rval = (this.read === 0) ? this.data : this.data.slice(this.read);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1255</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    this.clear();</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1256</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  }</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1257</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  return rval;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1258</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">}</span><span>;</span></code></div>
<div class="source-line"><span class="line-number ">1259</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<div class="source-line"><span class="line-number ">1260</span><span class="line-counter cline-yes">&nbsp</span><code>/**</code></div>
<div class="source-line"><span class="line-number ">1261</span><span class="line-counter cline-yes">&nbsp</span><code> * Gets a binary encoded string of the bytes from this buffer without</code></div>
<div class="source-line"><span class="line-number ">1262</span><span class="line-counter cline-yes">&nbsp</span><code> * modifying the read pointer.</code></div>
<div class="source-line"><span class="line-number ">1263</span><span class="line-counter cline-yes">&nbsp</span><code> *</code></div>
<div class="source-line"><span class="line-number ">1264</span><span class="line-counter cline-yes">&nbsp</span><code> * @param count the number of bytes to get, omit to get all.</code></div>
<div class="source-line"><span class="line-number ">1265</span><span class="line-counter cline-yes">&nbsp</span><code> *</code></div>
<div class="source-line"><span class="line-number ">1266</span><span class="line-counter cline-yes">&nbsp</span><code> * @return a string full of binary encoded characters.</code></div>
<div class="source-line"><span class="line-number ">1267</span><span class="line-counter cline-yes">&nbsp</span><code> */</code></div>
<div class="source-line"><span class="line-number ">1268</span><span class="line-counter cline-no">！</span><code><span>util.DataBuffer.prototype.bytes = </span><span class="cstat-no" title="statement not covered">function(count) {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1269</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  // TODO: deprecate this method, it is poorly named, add &quot;getString()&quot;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1270</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  return (typeof(count) === &#39;undefined&#39; ?</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1271</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    this.data.slice(this.read) :</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1272</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    this.data.slice(this.read, this.read + count));</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1273</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">}</span><span>;</span></code></div>
<div class="source-line"><span class="line-number ">1274</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<div class="source-line"><span class="line-number ">1275</span><span class="line-counter cline-yes">&nbsp</span><code>/**</code></div>
<div class="source-line"><span class="line-number ">1276</span><span class="line-counter cline-yes">&nbsp</span><code> * Gets a byte at the given index without modifying the read pointer.</code></div>
<div class="source-line"><span class="line-number ">1277</span><span class="line-counter cline-yes">&nbsp</span><code> *</code></div>
<div class="source-line"><span class="line-number ">1278</span><span class="line-counter cline-yes">&nbsp</span><code> * @param i the byte index.</code></div>
<div class="source-line"><span class="line-number ">1279</span><span class="line-counter cline-yes">&nbsp</span><code> *</code></div>
<div class="source-line"><span class="line-number ">1280</span><span class="line-counter cline-yes">&nbsp</span><code> * @return the byte.</code></div>
<div class="source-line"><span class="line-number ">1281</span><span class="line-counter cline-yes">&nbsp</span><code> */</code></div>
<div class="source-line"><span class="line-number ">1282</span><span class="line-counter cline-no">！</span><code><span>util.DataBuffer.prototype.at = </span><span class="cstat-no" title="statement not covered">function(i) {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1283</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  return this.data.getUint8(this.read + i);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1284</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">}</span><span>;</span></code></div>
<div class="source-line"><span class="line-number ">1285</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<div class="source-line"><span class="line-number ">1286</span><span class="line-counter cline-yes">&nbsp</span><code>/**</code></div>
<div class="source-line"><span class="line-number ">1287</span><span class="line-counter cline-yes">&nbsp</span><code> * Puts a byte at the given index without modifying the read pointer.</code></div>
<div class="source-line"><span class="line-number ">1288</span><span class="line-counter cline-yes">&nbsp</span><code> *</code></div>
<div class="source-line"><span class="line-number ">1289</span><span class="line-counter cline-yes">&nbsp</span><code> * @param i the byte index.</code></div>
<div class="source-line"><span class="line-number ">1290</span><span class="line-counter cline-yes">&nbsp</span><code> * @param b the byte to put.</code></div>
<div class="source-line"><span class="line-number ">1291</span><span class="line-counter cline-yes">&nbsp</span><code> *</code></div>
<div class="source-line"><span class="line-number ">1292</span><span class="line-counter cline-yes">&nbsp</span><code> * @return this buffer.</code></div>
<div class="source-line"><span class="line-number ">1293</span><span class="line-counter cline-yes">&nbsp</span><code> */</code></div>
<div class="source-line"><span class="line-number ">1294</span><span class="line-counter cline-no">！</span><code><span>util.DataBuffer.prototype.setAt = </span><span class="cstat-no" title="statement not covered">function(i, b) {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1295</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  this.data.setUint8(i, b);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1296</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  return this;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1297</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">}</span><span>;</span></code></div>
<div class="source-line"><span class="line-number ">1298</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<div class="source-line"><span class="line-number ">1299</span><span class="line-counter cline-yes">&nbsp</span><code>/**</code></div>
<div class="source-line"><span class="line-number ">1300</span><span class="line-counter cline-yes">&nbsp</span><code> * Gets the last byte without modifying the read pointer.</code></div>
<div class="source-line"><span class="line-number ">1301</span><span class="line-counter cline-yes">&nbsp</span><code> *</code></div>
<div class="source-line"><span class="line-number ">1302</span><span class="line-counter cline-yes">&nbsp</span><code> * @return the last byte.</code></div>
<div class="source-line"><span class="line-number ">1303</span><span class="line-counter cline-yes">&nbsp</span><code> */</code></div>
<div class="source-line"><span class="line-number ">1304</span><span class="line-counter cline-no">！</span><code><span>util.DataBuffer.prototype.last = </span><span class="cstat-no" title="statement not covered">function() {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1305</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  return this.data.getUint8(this.write - 1);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1306</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">}</span><span>;</span></code></div>
<div class="source-line"><span class="line-number ">1307</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<div class="source-line"><span class="line-number ">1308</span><span class="line-counter cline-yes">&nbsp</span><code>/**</code></div>
<div class="source-line"><span class="line-number ">1309</span><span class="line-counter cline-yes">&nbsp</span><code> * Creates a copy of this buffer.</code></div>
<div class="source-line"><span class="line-number ">1310</span><span class="line-counter cline-yes">&nbsp</span><code> *</code></div>
<div class="source-line"><span class="line-number ">1311</span><span class="line-counter cline-yes">&nbsp</span><code> * @return the copy.</code></div>
<div class="source-line"><span class="line-number ">1312</span><span class="line-counter cline-yes">&nbsp</span><code> */</code></div>
<div class="source-line"><span class="line-number ">1313</span><span class="line-counter cline-no">！</span><code><span>util.DataBuffer.prototype.copy = </span><span class="cstat-no" title="statement not covered">function() {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1314</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  return new util.DataBuffer(this);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1315</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">}</span><span>;</span></code></div>
<div class="source-line"><span class="line-number ">1316</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<div class="source-line"><span class="line-number ">1317</span><span class="line-counter cline-yes">&nbsp</span><code>/**</code></div>
<div class="source-line"><span class="line-number ">1318</span><span class="line-counter cline-yes">&nbsp</span><code> * Compacts this buffer.</code></div>
<div class="source-line"><span class="line-number ">1319</span><span class="line-counter cline-yes">&nbsp</span><code> *</code></div>
<div class="source-line"><span class="line-number ">1320</span><span class="line-counter cline-yes">&nbsp</span><code> * @return this buffer.</code></div>
<div class="source-line"><span class="line-number ">1321</span><span class="line-counter cline-yes">&nbsp</span><code> */</code></div>
<div class="source-line"><span class="line-number ">1322</span><span class="line-counter cline-no">！</span><code><span>util.DataBuffer.prototype.compact = </span><span class="cstat-no" title="statement not covered">function() {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1323</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  if(this.read &gt; 0) {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1324</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    var src = new Uint8Array(this.data.buffer, this.read);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1325</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    var dst = new Uint8Array(src.byteLength);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1326</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    dst.set(src);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1327</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    this.data = new DataView(dst);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1328</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    this.write -= this.read;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1329</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    this.read = 0;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1330</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  }</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1331</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  return this;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1332</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">}</span><span>;</span></code></div>
<div class="source-line"><span class="line-number ">1333</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<div class="source-line"><span class="line-number ">1334</span><span class="line-counter cline-yes">&nbsp</span><code>/**</code></div>
<div class="source-line"><span class="line-number ">1335</span><span class="line-counter cline-yes">&nbsp</span><code> * Clears this buffer.</code></div>
<div class="source-line"><span class="line-number ">1336</span><span class="line-counter cline-yes">&nbsp</span><code> *</code></div>
<div class="source-line"><span class="line-number ">1337</span><span class="line-counter cline-yes">&nbsp</span><code> * @return this buffer.</code></div>
<div class="source-line"><span class="line-number ">1338</span><span class="line-counter cline-yes">&nbsp</span><code> */</code></div>
<div class="source-line"><span class="line-number ">1339</span><span class="line-counter cline-no">！</span><code><span>util.DataBuffer.prototype.clear = </span><span class="cstat-no" title="statement not covered">function() {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1340</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  this.data = new DataView(new ArrayBuffer(0));</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1341</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  this.read = this.write = 0;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1342</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  return this;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1343</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">}</span><span>;</span></code></div>
<div class="source-line"><span class="line-number ">1344</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<div class="source-line"><span class="line-number ">1345</span><span class="line-counter cline-yes">&nbsp</span><code>/**</code></div>
<div class="source-line"><span class="line-number ">1346</span><span class="line-counter cline-yes">&nbsp</span><code> * Shortens this buffer by triming bytes off of the end of this buffer.</code></div>
<div class="source-line"><span class="line-number ">1347</span><span class="line-counter cline-yes">&nbsp</span><code> *</code></div>
<div class="source-line"><span class="line-number ">1348</span><span class="line-counter cline-yes">&nbsp</span><code> * @param count the number of bytes to trim off.</code></div>
<div class="source-line"><span class="line-number ">1349</span><span class="line-counter cline-yes">&nbsp</span><code> *</code></div>
<div class="source-line"><span class="line-number ">1350</span><span class="line-counter cline-yes">&nbsp</span><code> * @return this buffer.</code></div>
<div class="source-line"><span class="line-number ">1351</span><span class="line-counter cline-yes">&nbsp</span><code> */</code></div>
<div class="source-line"><span class="line-number ">1352</span><span class="line-counter cline-no">！</span><code><span>util.DataBuffer.prototype.truncate = </span><span class="cstat-no" title="statement not covered">function(count) {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1353</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  this.write = Math.max(0, this.length() - count);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1354</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  this.read = Math.min(this.read, this.write);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1355</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  return this;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1356</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">}</span><span>;</span></code></div>
<div class="source-line"><span class="line-number ">1357</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<div class="source-line"><span class="line-number ">1358</span><span class="line-counter cline-yes">&nbsp</span><code>/**</code></div>
<div class="source-line"><span class="line-number ">1359</span><span class="line-counter cline-yes">&nbsp</span><code> * Converts this buffer to a hexadecimal string.</code></div>
<div class="source-line"><span class="line-number ">1360</span><span class="line-counter cline-yes">&nbsp</span><code> *</code></div>
<div class="source-line"><span class="line-number ">1361</span><span class="line-counter cline-yes">&nbsp</span><code> * @return a hexadecimal string.</code></div>
<div class="source-line"><span class="line-number ">1362</span><span class="line-counter cline-yes">&nbsp</span><code> */</code></div>
<div class="source-line"><span class="line-number ">1363</span><span class="line-counter cline-no">！</span><code><span>util.DataBuffer.prototype.toHex = </span><span class="cstat-no" title="statement not covered">function() {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1364</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  var rval = &#39;&#39;;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1365</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  for(var i = this.read; i &lt; this.data.byteLength; ++i) {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1366</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    var b = this.data.getUint8(i);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1367</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    if(b &lt; 16) {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1368</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">      rval += &#39;0&#39;;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1369</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    }</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1370</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    rval += b.toString(16);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1371</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  }</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1372</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  return rval;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1373</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">}</span><span>;</span></code></div>
<div class="source-line"><span class="line-number ">1374</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<div class="source-line"><span class="line-number ">1375</span><span class="line-counter cline-yes">&nbsp</span><code>/**</code></div>
<div class="source-line"><span class="line-number ">1376</span><span class="line-counter cline-yes">&nbsp</span><code> * Converts this buffer to a string, using the given encoding. If no</code></div>
<div class="source-line"><span class="line-number ">1377</span><span class="line-counter cline-yes">&nbsp</span><code> * encoding is given, &#39;utf8&#39; (UTF-8) is used.</code></div>
<div class="source-line"><span class="line-number ">1378</span><span class="line-counter cline-yes">&nbsp</span><code> *</code></div>
<div class="source-line"><span class="line-number ">1379</span><span class="line-counter cline-yes">&nbsp</span><code> * @param [encoding] the encoding to use: &#39;binary&#39;, &#39;utf8&#39;, &#39;utf16&#39;, &#39;hex&#39;,</code></div>
<div class="source-line"><span class="line-number ">1380</span><span class="line-counter cline-yes">&nbsp</span><code> *          &#39;base64&#39; (default: &#39;utf8&#39;).</code></div>
<div class="source-line"><span class="line-number ">1381</span><span class="line-counter cline-yes">&nbsp</span><code> *</code></div>
<div class="source-line"><span class="line-number ">1382</span><span class="line-counter cline-yes">&nbsp</span><code> * @return a string representation of the bytes in this buffer.</code></div>
<div class="source-line"><span class="line-number ">1383</span><span class="line-counter cline-yes">&nbsp</span><code> */</code></div>
<div class="source-line"><span class="line-number ">1384</span><span class="line-counter cline-no">！</span><code><span>util.DataBuffer.prototype.toString = </span><span class="cstat-no" title="statement not covered">function(encoding) {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1385</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  var view = new Uint8Array(this.data, this.read, this.length());</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1386</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  encoding = encoding || &#39;utf8&#39;;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1387</span><span class="line-counter cline-no">！</span><code><span class="cstat-no" title="statement not covered"><br/></span><span></span></code></div>
<div class="source-line"><span class="line-number ">1388</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  // encode to string</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1389</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  if(encoding === &#39;binary&#39; || encoding === &#39;raw&#39;) {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1390</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    return util.binary.raw.encode(view);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1391</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  }</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1392</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  if(encoding === &#39;hex&#39;) {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1393</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    return util.binary.hex.encode(view);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1394</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  }</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1395</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  if(encoding === &#39;base64&#39;) {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1396</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    return util.binary.base64.encode(view);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1397</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  }</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1398</span><span class="line-counter cline-no">！</span><code><span class="cstat-no" title="statement not covered"><br/></span><span></span></code></div>
<div class="source-line"><span class="line-number ">1399</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  // decode to text</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1400</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  if(encoding === &#39;utf8&#39;) {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1401</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    return util.text.utf8.decode(view);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1402</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  }</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1403</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  if(encoding === &#39;utf16&#39;) {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1404</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    return util.text.utf16.decode(view);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1405</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  }</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1406</span><span class="line-counter cline-no">！</span><code><span class="cstat-no" title="statement not covered"><br/></span><span></span></code></div>
<div class="source-line"><span class="line-number ">1407</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  throw new Error(&#39;Invalid encoding: &#39; + encoding);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1408</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">}</span><span>;</span></code></div>
<div class="source-line"><span class="line-number ">1409</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<div class="source-line"><span class="line-number ">1410</span><span class="line-counter cline-yes">&nbsp</span><code>/** End Buffer w/UInt8Array backing */</code></div>
<div class="source-line"><span class="line-number ">1411</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<div class="source-line"><span class="line-number ">1412</span><span class="line-counter cline-yes">&nbsp</span><code>/**</code></div>
<div class="source-line"><span class="line-number ">1413</span><span class="line-counter cline-yes">&nbsp</span><code> * Creates a buffer that stores bytes. A value may be given to populate the</code></div>
<div class="source-line"><span class="line-number ">1414</span><span class="line-counter cline-yes">&nbsp</span><code> * buffer with data. This value can either be string of encoded bytes or a</code></div>
<div class="source-line"><span class="line-number ">1415</span><span class="line-counter cline-yes">&nbsp</span><code> * regular string of characters. When passing a string of binary encoded</code></div>
<div class="source-line"><span class="line-number ">1416</span><span class="line-counter cline-yes">&nbsp</span><code> * bytes, the encoding `raw` should be given. This is also the default. When</code></div>
<div class="source-line"><span class="line-number ">1417</span><span class="line-counter cline-yes">&nbsp</span><code> * passing a string of characters, the encoding `utf8` should be given.</code></div>
<div class="source-line"><span class="line-number ">1418</span><span class="line-counter cline-yes">&nbsp</span><code> *</code></div>
<div class="source-line"><span class="line-number ">1419</span><span class="line-counter cline-yes">&nbsp</span><code> * @param [input] a string with encoded bytes to store in the buffer.</code></div>
<div class="source-line"><span class="line-number ">1420</span><span class="line-counter cline-yes">&nbsp</span><code> * @param [encoding] (default: &#39;raw&#39;, other: &#39;utf8&#39;).</code></div>
<div class="source-line"><span class="line-number ">1421</span><span class="line-counter cline-yes">&nbsp</span><code> */</code></div>
<div class="source-line"><span class="line-number ">1422</span><span class="line-counter cline-yes">&nbsp</span><code>util.createBuffer = function(input, encoding) {</code></div>
<div class="source-line"><span class="line-number ">1423</span><span class="line-counter cline-yes">&nbsp</span><code>  // TODO: deprecate, use new ByteBuffer() instead</code></div>
<div class="source-line"><span class="line-number ">1424</span><span class="line-counter cline-yes">&nbsp</span><code>  encoding = encoding || &#39;raw&#39;;</code></div>
<div class="source-line"><span class="line-number ">1425</span><span class="line-counter cline-no">！</span><code><span>  if(input !== undefined &amp;&amp; encoding === &#39;utf8&#39;) </span><span class="cstat-no" title="statement not covered">{</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1426</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    input = util.encodeUtf8(input);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1427</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  }</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1428</span><span class="line-counter cline-yes">&nbsp</span><code>  return new util.ByteBuffer(input);</code></div>
<div class="source-line"><span class="line-number ">1429</span><span class="line-counter cline-yes">&nbsp</span><code>};</code></div>
<div class="source-line"><span class="line-number ">1430</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<div class="source-line"><span class="line-number ">1431</span><span class="line-counter cline-yes">&nbsp</span><code>/**</code></div>
<div class="source-line"><span class="line-number ">1432</span><span class="line-counter cline-yes">&nbsp</span><code> * Fills a string with a particular value. If you want the string to be a byte</code></div>
<div class="source-line"><span class="line-number ">1433</span><span class="line-counter cline-yes">&nbsp</span><code> * string, pass in String.fromCharCode(theByte).</code></div>
<div class="source-line"><span class="line-number ">1434</span><span class="line-counter cline-yes">&nbsp</span><code> *</code></div>
<div class="source-line"><span class="line-number ">1435</span><span class="line-counter cline-yes">&nbsp</span><code> * @param c the character to fill the string with, use String.fromCharCode</code></div>
<div class="source-line"><span class="line-number ">1436</span><span class="line-counter cline-yes">&nbsp</span><code> *          to fill the string with a byte value.</code></div>
<div class="source-line"><span class="line-number ">1437</span><span class="line-counter cline-yes">&nbsp</span><code> * @param n the number of characters of value c to fill with.</code></div>
<div class="source-line"><span class="line-number ">1438</span><span class="line-counter cline-yes">&nbsp</span><code> *</code></div>
<div class="source-line"><span class="line-number ">1439</span><span class="line-counter cline-yes">&nbsp</span><code> * @return the filled string.</code></div>
<div class="source-line"><span class="line-number ">1440</span><span class="line-counter cline-yes">&nbsp</span><code> */</code></div>
<div class="source-line"><span class="line-number ">1441</span><span class="line-counter cline-yes">&nbsp</span><code>util.fillString = function(c, n) {</code></div>
<div class="source-line"><span class="line-number ">1442</span><span class="line-counter cline-yes">&nbsp</span><code>  var s = &#39;&#39;;</code></div>
<div class="source-line"><span class="line-number ">1443</span><span class="line-counter cline-yes">&nbsp</span><code>  while(n &gt; 0) {</code></div>
<div class="source-line"><span class="line-number ">1444</span><span class="line-counter cline-yes">&nbsp</span><code>    if(n &amp; 1) {</code></div>
<div class="source-line"><span class="line-number ">1445</span><span class="line-counter cline-yes">&nbsp</span><code>      s += c;</code></div>
<div class="source-line"><span class="line-number ">1446</span><span class="line-counter cline-yes">&nbsp</span><code>    }</code></div>
<div class="source-line"><span class="line-number ">1447</span><span class="line-counter cline-yes">&nbsp</span><code>    n &gt;&gt;&gt;= 1;</code></div>
<div class="source-line"><span class="line-number ">1448</span><span class="line-counter cline-yes">&nbsp</span><code>    if(n &gt; 0) {</code></div>
<div class="source-line"><span class="line-number ">1449</span><span class="line-counter cline-yes">&nbsp</span><code>      c += c;</code></div>
<div class="source-line"><span class="line-number ">1450</span><span class="line-counter cline-yes">&nbsp</span><code>    }</code></div>
<div class="source-line"><span class="line-number ">1451</span><span class="line-counter cline-yes">&nbsp</span><code>  }</code></div>
<div class="source-line"><span class="line-number ">1452</span><span class="line-counter cline-yes">&nbsp</span><code>  return s;</code></div>
<div class="source-line"><span class="line-number ">1453</span><span class="line-counter cline-yes">&nbsp</span><code>};</code></div>
<div class="source-line"><span class="line-number ">1454</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<div class="source-line"><span class="line-number ">1455</span><span class="line-counter cline-yes">&nbsp</span><code>/**</code></div>
<div class="source-line"><span class="line-number ">1456</span><span class="line-counter cline-yes">&nbsp</span><code> * Performs a per byte XOR between two byte strings and returns the result as a</code></div>
<div class="source-line"><span class="line-number ">1457</span><span class="line-counter cline-yes">&nbsp</span><code> * string of bytes.</code></div>
<div class="source-line"><span class="line-number ">1458</span><span class="line-counter cline-yes">&nbsp</span><code> *</code></div>
<div class="source-line"><span class="line-number ">1459</span><span class="line-counter cline-yes">&nbsp</span><code> * @param s1 first string of bytes.</code></div>
<div class="source-line"><span class="line-number ">1460</span><span class="line-counter cline-yes">&nbsp</span><code> * @param s2 second string of bytes.</code></div>
<div class="source-line"><span class="line-number ">1461</span><span class="line-counter cline-yes">&nbsp</span><code> * @param n the number of bytes to XOR.</code></div>
<div class="source-line"><span class="line-number ">1462</span><span class="line-counter cline-yes">&nbsp</span><code> *</code></div>
<div class="source-line"><span class="line-number ">1463</span><span class="line-counter cline-yes">&nbsp</span><code> * @return the XOR&#39;d result.</code></div>
<div class="source-line"><span class="line-number ">1464</span><span class="line-counter cline-yes">&nbsp</span><code> */</code></div>
<div class="source-line"><span class="line-number ">1465</span><span class="line-counter cline-no">！</span><code><span>util.xorBytes = </span><span class="cstat-no" title="statement not covered">function(s1, s2, n) {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1466</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  var s3 = &#39;&#39;;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1467</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  var b = &#39;&#39;;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1468</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  var t = &#39;&#39;;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1469</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  var i = 0;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1470</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  var c = 0;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1471</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  for(; n &gt; 0; --n, ++i) {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1472</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    b = s1.charCodeAt(i) ^ s2.charCodeAt(i);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1473</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    if(c &gt;= 10) {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1474</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">      s3 += t;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1475</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">      t = &#39;&#39;;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1476</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">      c = 0;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1477</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    }</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1478</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    t += String.fromCharCode(b);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1479</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    ++c;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1480</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  }</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1481</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  s3 += t;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1482</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  return s3;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1483</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">}</span><span>;</span></code></div>
<div class="source-line"><span class="line-number ">1484</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<div class="source-line"><span class="line-number ">1485</span><span class="line-counter cline-yes">&nbsp</span><code>/**</code></div>
<div class="source-line"><span class="line-number ">1486</span><span class="line-counter cline-yes">&nbsp</span><code> * Converts a hex string into a &#39;binary&#39; encoded string of bytes.</code></div>
<div class="source-line"><span class="line-number ">1487</span><span class="line-counter cline-yes">&nbsp</span><code> *</code></div>
<div class="source-line"><span class="line-number ">1488</span><span class="line-counter cline-yes">&nbsp</span><code> * @param hex the hexadecimal string to convert.</code></div>
<div class="source-line"><span class="line-number ">1489</span><span class="line-counter cline-yes">&nbsp</span><code> *</code></div>
<div class="source-line"><span class="line-number ">1490</span><span class="line-counter cline-yes">&nbsp</span><code> * @return the binary-encoded string of bytes.</code></div>
<div class="source-line"><span class="line-number ">1491</span><span class="line-counter cline-yes">&nbsp</span><code> */</code></div>
<div class="source-line"><span class="line-number ">1492</span><span class="line-counter cline-yes">&nbsp</span><code>util.hexToBytes = function(hex) {</code></div>
<div class="source-line"><span class="line-number ">1493</span><span class="line-counter cline-yes">&nbsp</span><code>  // TODO: deprecate: &quot;Deprecated. Use util.binary.hex.decode instead.&quot;</code></div>
<div class="source-line"><span class="line-number ">1494</span><span class="line-counter cline-yes">&nbsp</span><code>  var rval = &#39;&#39;;</code></div>
<div class="source-line"><span class="line-number ">1495</span><span class="line-counter cline-yes">&nbsp</span><code>  var i = 0;</code></div>
<mark class="issue-line"><div class="source-line"><span class="line-number ">1496</span><span class="line-counter cline-yes">&nbsp</span><code>  if(hex.length &amp; 1 == 1) {</code></div>
</mark><details class="issue-inline-message issue-critical issue-branch target-RSASIGN">
                        <summary>💥&nbsp;<i>RSASIGN</i> Secret-dependent branch</summary>
                <div class="issue-description">[RSASIGN] Found vulnerable jump instruction, leakage score 93.33% +/- 0%.</div>
            </details><div class="source-line"><span class="line-number ">1497</span><span class="line-counter cline-yes">&nbsp</span><code>    // odd number of characters, convert first character alone</code></div>
<div class="source-line"><span class="line-number ">1498</span><span class="line-counter cline-yes">&nbsp</span><code>    i = 1;</code></div>
<div class="source-line"><span class="line-number ">1499</span><span class="line-counter cline-yes">&nbsp</span><code>    rval += String.fromCharCode(parseInt(hex[0], 16));</code></div>
<div class="source-line"><span class="line-number ">1500</span><span class="line-counter cline-yes">&nbsp</span><code>  }</code></div>
<div class="source-line"><span class="line-number ">1501</span><span class="line-counter cline-yes">&nbsp</span><code>  // convert 2 characters (1 byte) at a time</code></div>
<div class="source-line"><span class="line-number ">1502</span><span class="line-counter cline-yes">&nbsp</span><code>  for(; i &lt; hex.length; i += 2) {</code></div>
<div class="source-line"><span class="line-number ">1503</span><span class="line-counter cline-yes">&nbsp</span><code>    rval += String.fromCharCode(parseInt(hex.substr(i, 2), 16));</code></div>
<div class="source-line"><span class="line-number ">1504</span><span class="line-counter cline-yes">&nbsp</span><code>  }</code></div>
<div class="source-line"><span class="line-number ">1505</span><span class="line-counter cline-yes">&nbsp</span><code>  return rval;</code></div>
<div class="source-line"><span class="line-number ">1506</span><span class="line-counter cline-yes">&nbsp</span><code>};</code></div>
<div class="source-line"><span class="line-number ">1507</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<div class="source-line"><span class="line-number ">1508</span><span class="line-counter cline-yes">&nbsp</span><code>/**</code></div>
<div class="source-line"><span class="line-number ">1509</span><span class="line-counter cline-yes">&nbsp</span><code> * Converts a &#39;binary&#39; encoded string of bytes to hex.</code></div>
<div class="source-line"><span class="line-number ">1510</span><span class="line-counter cline-yes">&nbsp</span><code> *</code></div>
<div class="source-line"><span class="line-number ">1511</span><span class="line-counter cline-yes">&nbsp</span><code> * @param bytes the byte string to convert.</code></div>
<div class="source-line"><span class="line-number ">1512</span><span class="line-counter cline-yes">&nbsp</span><code> *</code></div>
<div class="source-line"><span class="line-number ">1513</span><span class="line-counter cline-yes">&nbsp</span><code> * @return the string of hexadecimal characters.</code></div>
<div class="source-line"><span class="line-number ">1514</span><span class="line-counter cline-yes">&nbsp</span><code> */</code></div>
<div class="source-line"><span class="line-number ">1515</span><span class="line-counter cline-yes">&nbsp</span><code>util.bytesToHex = function(bytes) {</code></div>
<div class="source-line"><span class="line-number ">1516</span><span class="line-counter cline-yes">&nbsp</span><code>  // TODO: deprecate: &quot;Deprecated. Use util.binary.hex.encode instead.&quot;</code></div>
<div class="source-line"><span class="line-number ">1517</span><span class="line-counter cline-yes">&nbsp</span><code>  return util.createBuffer(bytes).toHex();</code></div>
<div class="source-line"><span class="line-number ">1518</span><span class="line-counter cline-yes">&nbsp</span><code>};</code></div>
<div class="source-line"><span class="line-number ">1519</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<div class="source-line"><span class="line-number ">1520</span><span class="line-counter cline-yes">&nbsp</span><code>/**</code></div>
<div class="source-line"><span class="line-number ">1521</span><span class="line-counter cline-yes">&nbsp</span><code> * Converts an 32-bit integer to 4-big-endian byte string.</code></div>
<div class="source-line"><span class="line-number ">1522</span><span class="line-counter cline-yes">&nbsp</span><code> *</code></div>
<div class="source-line"><span class="line-number ">1523</span><span class="line-counter cline-yes">&nbsp</span><code> * @param i the integer.</code></div>
<div class="source-line"><span class="line-number ">1524</span><span class="line-counter cline-yes">&nbsp</span><code> *</code></div>
<div class="source-line"><span class="line-number ">1525</span><span class="line-counter cline-yes">&nbsp</span><code> * @return the byte string.</code></div>
<div class="source-line"><span class="line-number ">1526</span><span class="line-counter cline-yes">&nbsp</span><code> */</code></div>
<div class="source-line"><span class="line-number ">1527</span><span class="line-counter cline-no">！</span><code><span>util.int32ToBytes = </span><span class="cstat-no" title="statement not covered">function(i) {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1528</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  return (</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1529</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    String.fromCharCode(i &gt;&gt; 24 &amp; 0xFF) +</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1530</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    String.fromCharCode(i &gt;&gt; 16 &amp; 0xFF) +</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1531</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    String.fromCharCode(i &gt;&gt; 8 &amp; 0xFF) +</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1532</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    String.fromCharCode(i &amp; 0xFF));</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1533</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">}</span><span>;</span></code></div>
<div class="source-line"><span class="line-number ">1534</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<div class="source-line"><span class="line-number ">1535</span><span class="line-counter cline-yes">&nbsp</span><code>// base64 characters, reverse mapping</code></div>
<div class="source-line"><span class="line-number ">1536</span><span class="line-counter cline-yes">&nbsp</span><code>var _base64 =</code></div>
<div class="source-line"><span class="line-number ">1537</span><span class="line-counter cline-yes">&nbsp</span><code>  &#39;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=&#39;;</code></div>
<div class="source-line"><span class="line-number ">1538</span><span class="line-counter cline-yes">&nbsp</span><code>var _base64Idx = [</code></div>
<div class="source-line"><span class="line-number ">1539</span><span class="line-counter cline-yes">&nbsp</span><code>/*43 -43 = 0*/</code></div>
<div class="source-line"><span class="line-number ">1540</span><span class="line-counter cline-yes">&nbsp</span><code>/*&#39;+&#39;,  1,  2,  3,&#39;/&#39; */</code></div>
<div class="source-line"><span class="line-number ">1541</span><span class="line-counter cline-yes">&nbsp</span><code>   62, -1, -1, -1, 63,</code></div>
<div class="source-line"><span class="line-number ">1542</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<div class="source-line"><span class="line-number ">1543</span><span class="line-counter cline-yes">&nbsp</span><code>/*&#39;0&#39;,&#39;1&#39;,&#39;2&#39;,&#39;3&#39;,&#39;4&#39;,&#39;5&#39;,&#39;6&#39;,&#39;7&#39;,&#39;8&#39;,&#39;9&#39; */</code></div>
<div class="source-line"><span class="line-number ">1544</span><span class="line-counter cline-yes">&nbsp</span><code>   52, 53, 54, 55, 56, 57, 58, 59, 60, 61,</code></div>
<div class="source-line"><span class="line-number ">1545</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<div class="source-line"><span class="line-number ">1546</span><span class="line-counter cline-yes">&nbsp</span><code>/*15, 16, 17,&#39;=&#39;, 19, 20, 21 */</code></div>
<div class="source-line"><span class="line-number ">1547</span><span class="line-counter cline-yes">&nbsp</span><code>  -1, -1, -1, 64, -1, -1, -1,</code></div>
<div class="source-line"><span class="line-number ">1548</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<div class="source-line"><span class="line-number ">1549</span><span class="line-counter cline-yes">&nbsp</span><code>/*65 - 43 = 22*/</code></div>
<div class="source-line"><span class="line-number ">1550</span><span class="line-counter cline-yes">&nbsp</span><code>/*&#39;A&#39;,&#39;B&#39;,&#39;C&#39;,&#39;D&#39;,&#39;E&#39;,&#39;F&#39;,&#39;G&#39;,&#39;H&#39;,&#39;I&#39;,&#39;J&#39;,&#39;K&#39;,&#39;L&#39;,&#39;M&#39;, */</code></div>
<div class="source-line"><span class="line-number ">1551</span><span class="line-counter cline-yes">&nbsp</span><code>   0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12,</code></div>
<div class="source-line"><span class="line-number ">1552</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<div class="source-line"><span class="line-number ">1553</span><span class="line-counter cline-yes">&nbsp</span><code>/*&#39;N&#39;,&#39;O&#39;,&#39;P&#39;,&#39;Q&#39;,&#39;R&#39;,&#39;S&#39;,&#39;T&#39;,&#39;U&#39;,&#39;V&#39;,&#39;W&#39;,&#39;X&#39;,&#39;Y&#39;,&#39;Z&#39; */</code></div>
<div class="source-line"><span class="line-number ">1554</span><span class="line-counter cline-yes">&nbsp</span><code>   13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25,</code></div>
<div class="source-line"><span class="line-number ">1555</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<div class="source-line"><span class="line-number ">1556</span><span class="line-counter cline-yes">&nbsp</span><code>/*91 - 43 = 48 */</code></div>
<div class="source-line"><span class="line-number ">1557</span><span class="line-counter cline-yes">&nbsp</span><code>/*48, 49, 50, 51, 52, 53 */</code></div>
<div class="source-line"><span class="line-number ">1558</span><span class="line-counter cline-yes">&nbsp</span><code>  -1, -1, -1, -1, -1, -1,</code></div>
<div class="source-line"><span class="line-number ">1559</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<div class="source-line"><span class="line-number ">1560</span><span class="line-counter cline-yes">&nbsp</span><code>/*97 - 43 = 54*/</code></div>
<div class="source-line"><span class="line-number ">1561</span><span class="line-counter cline-yes">&nbsp</span><code>/*&#39;a&#39;,&#39;b&#39;,&#39;c&#39;,&#39;d&#39;,&#39;e&#39;,&#39;f&#39;,&#39;g&#39;,&#39;h&#39;,&#39;i&#39;,&#39;j&#39;,&#39;k&#39;,&#39;l&#39;,&#39;m&#39; */</code></div>
<div class="source-line"><span class="line-number ">1562</span><span class="line-counter cline-yes">&nbsp</span><code>   26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38,</code></div>
<div class="source-line"><span class="line-number ">1563</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<div class="source-line"><span class="line-number ">1564</span><span class="line-counter cline-yes">&nbsp</span><code>/*&#39;n&#39;,&#39;o&#39;,&#39;p&#39;,&#39;q&#39;,&#39;r&#39;,&#39;s&#39;,&#39;t&#39;,&#39;u&#39;,&#39;v&#39;,&#39;w&#39;,&#39;x&#39;,&#39;y&#39;,&#39;z&#39; */</code></div>
<div class="source-line"><span class="line-number ">1565</span><span class="line-counter cline-yes">&nbsp</span><code>   39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51</code></div>
<div class="source-line"><span class="line-number ">1566</span><span class="line-counter cline-yes">&nbsp</span><code>];</code></div>
<div class="source-line"><span class="line-number ">1567</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<div class="source-line"><span class="line-number ">1568</span><span class="line-counter cline-yes">&nbsp</span><code>// base58 characters (Bitcoin alphabet)</code></div>
<div class="source-line"><span class="line-number ">1569</span><span class="line-counter cline-yes">&nbsp</span><code>var _base58 = &#39;123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz&#39;;</code></div>
<div class="source-line"><span class="line-number ">1570</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<div class="source-line"><span class="line-number ">1571</span><span class="line-counter cline-yes">&nbsp</span><code>/**</code></div>
<div class="source-line"><span class="line-number ">1572</span><span class="line-counter cline-yes">&nbsp</span><code> * Base64 encodes a &#39;binary&#39; encoded string of bytes.</code></div>
<div class="source-line"><span class="line-number ">1573</span><span class="line-counter cline-yes">&nbsp</span><code> *</code></div>
<div class="source-line"><span class="line-number ">1574</span><span class="line-counter cline-yes">&nbsp</span><code> * @param input the binary encoded string of bytes to base64-encode.</code></div>
<div class="source-line"><span class="line-number ">1575</span><span class="line-counter cline-yes">&nbsp</span><code> * @param maxline the maximum number of encoded characters per line to use,</code></div>
<div class="source-line"><span class="line-number ">1576</span><span class="line-counter cline-yes">&nbsp</span><code> *          defaults to none.</code></div>
<div class="source-line"><span class="line-number ">1577</span><span class="line-counter cline-yes">&nbsp</span><code> *</code></div>
<div class="source-line"><span class="line-number ">1578</span><span class="line-counter cline-yes">&nbsp</span><code> * @return the base64-encoded output.</code></div>
<div class="source-line"><span class="line-number ">1579</span><span class="line-counter cline-yes">&nbsp</span><code> */</code></div>
<div class="source-line"><span class="line-number ">1580</span><span class="line-counter cline-yes">&nbsp</span><code>util.encode64 = function(input, maxline) {</code></div>
<div class="source-line"><span class="line-number ">1581</span><span class="line-counter cline-yes">&nbsp</span><code>  // TODO: deprecate: &quot;Deprecated. Use util.binary.base64.encode instead.&quot;</code></div>
<div class="source-line"><span class="line-number ">1582</span><span class="line-counter cline-yes">&nbsp</span><code>  var line = &#39;&#39;;</code></div>
<div class="source-line"><span class="line-number ">1583</span><span class="line-counter cline-yes">&nbsp</span><code>  var output = &#39;&#39;;</code></div>
<div class="source-line"><span class="line-number ">1584</span><span class="line-counter cline-yes">&nbsp</span><code>  var chr1, chr2, chr3;</code></div>
<div class="source-line"><span class="line-number ">1585</span><span class="line-counter cline-yes">&nbsp</span><code>  var i = 0;</code></div>
<div class="source-line"><span class="line-number ">1586</span><span class="line-counter cline-yes">&nbsp</span><code>  while(i &lt; input.length) {</code></div>
<div class="source-line"><span class="line-number ">1587</span><span class="line-counter cline-yes">&nbsp</span><code>    chr1 = input.charCodeAt(i++);</code></div>
<div class="source-line"><span class="line-number ">1588</span><span class="line-counter cline-yes">&nbsp</span><code>    chr2 = input.charCodeAt(i++);</code></div>
<div class="source-line"><span class="line-number ">1589</span><span class="line-counter cline-yes">&nbsp</span><code>    chr3 = input.charCodeAt(i++);</code></div>
<div class="source-line"><span class="line-number ">1590</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<div class="source-line"><span class="line-number ">1591</span><span class="line-counter cline-yes">&nbsp</span><code>    // encode 4 character group</code></div>
<div class="source-line"><span class="line-number ">1592</span><span class="line-counter cline-yes">&nbsp</span><code>    line += _base64.charAt(chr1 &gt;&gt; 2);</code></div>
<div class="source-line"><span class="line-number ">1593</span><span class="line-counter cline-yes">&nbsp</span><code>    line += _base64.charAt(((chr1 &amp; 3) &lt;&lt; 4) | (chr2 &gt;&gt; 4));</code></div>
<div class="source-line"><span class="line-number ">1594</span><span class="line-counter cline-yes">&nbsp</span><code>    if(isNaN(chr2)) {</code></div>
<div class="source-line"><span class="line-number ">1595</span><span class="line-counter cline-yes">&nbsp</span><code>      line += &#39;==&#39;;</code></div>
<div class="source-line"><span class="line-number ">1596</span><span class="line-counter cline-yes">&nbsp</span><code>    } else {</code></div>
<div class="source-line"><span class="line-number ">1597</span><span class="line-counter cline-yes">&nbsp</span><code>      line += _base64.charAt(((chr2 &amp; 15) &lt;&lt; 2) | (chr3 &gt;&gt; 6));</code></div>
<div class="source-line"><span class="line-number ">1598</span><span class="line-counter cline-no">！</span><code><span>      line += isNaN(chr3) </span><span class="cstat-no" title="statement not covered">? &#39;=&#39;</span><span> : _base64.charAt(chr3 &amp; 63);</span></code></div>
<div class="source-line"><span class="line-number ">1599</span><span class="line-counter cline-yes">&nbsp</span><code>    }</code></div>
<div class="source-line"><span class="line-number ">1600</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<div class="source-line"><span class="line-number ">1601</span><span class="line-counter cline-no">！</span><code><span>    if(maxline </span><span class="cstat-no" title="statement not covered">&amp;&amp; line.length &gt; maxline</span><span>) </span><span class="cstat-no" title="statement not covered">{</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1602</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">      output += line.substr(0, maxline) + &#39;\r\n&#39;;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1603</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">      line = line.substr(maxline);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1604</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    }</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1605</span><span class="line-counter cline-yes">&nbsp</span><code>  }</code></div>
<div class="source-line"><span class="line-number ">1606</span><span class="line-counter cline-yes">&nbsp</span><code>  output += line;</code></div>
<div class="source-line"><span class="line-number ">1607</span><span class="line-counter cline-yes">&nbsp</span><code>  return output;</code></div>
<div class="source-line"><span class="line-number ">1608</span><span class="line-counter cline-yes">&nbsp</span><code>};</code></div>
<div class="source-line"><span class="line-number ">1609</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<div class="source-line"><span class="line-number ">1610</span><span class="line-counter cline-yes">&nbsp</span><code>/**</code></div>
<div class="source-line"><span class="line-number ">1611</span><span class="line-counter cline-yes">&nbsp</span><code> * Base64 decodes a string into a &#39;binary&#39; encoded string of bytes.</code></div>
<div class="source-line"><span class="line-number ">1612</span><span class="line-counter cline-yes">&nbsp</span><code> *</code></div>
<div class="source-line"><span class="line-number ">1613</span><span class="line-counter cline-yes">&nbsp</span><code> * @param input the base64-encoded input.</code></div>
<div class="source-line"><span class="line-number ">1614</span><span class="line-counter cline-yes">&nbsp</span><code> *</code></div>
<div class="source-line"><span class="line-number ">1615</span><span class="line-counter cline-yes">&nbsp</span><code> * @return the binary encoded string.</code></div>
<div class="source-line"><span class="line-number ">1616</span><span class="line-counter cline-yes">&nbsp</span><code> */</code></div>
<div class="source-line"><span class="line-number ">1617</span><span class="line-counter cline-yes">&nbsp</span><code>util.decode64 = function(input) {</code></div>
<div class="source-line"><span class="line-number ">1618</span><span class="line-counter cline-yes">&nbsp</span><code>  // TODO: deprecate: &quot;Deprecated. Use util.binary.base64.decode instead.&quot;</code></div>
<div class="source-line"><span class="line-number ">1619</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<div class="source-line"><span class="line-number ">1620</span><span class="line-counter cline-yes">&nbsp</span><code>  // remove all non-base64 characters</code></div>
<div class="source-line"><span class="line-number ">1621</span><span class="line-counter cline-yes">&nbsp</span><code>  input = input.replace(/[^A-Za-z0-9\+\/\=]/g, &#39;&#39;);</code></div>
<div class="source-line"><span class="line-number ">1622</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<div class="source-line"><span class="line-number ">1623</span><span class="line-counter cline-yes">&nbsp</span><code>  var output = &#39;&#39;;</code></div>
<div class="source-line"><span class="line-number ">1624</span><span class="line-counter cline-yes">&nbsp</span><code>  var enc1, enc2, enc3, enc4;</code></div>
<div class="source-line"><span class="line-number ">1625</span><span class="line-counter cline-yes">&nbsp</span><code>  var i = 0;</code></div>
<div class="source-line"><span class="line-number ">1626</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<div class="source-line"><span class="line-number ">1627</span><span class="line-counter cline-yes">&nbsp</span><code>  while(i &lt; input.length) {</code></div>
<mark class="issue-line"><div class="source-line"><span class="line-number ">1628</span><span class="line-counter cline-yes">&nbsp</span><code>    enc1 = _base64Idx[input.charCodeAt(i++) - 43];</code></div>
</mark><details class="issue-inline-message issue-critical issue-memory-access target-DECODE">
                        <summary>💥&nbsp;<i>DECODE</i> Secret-dependent memory access</summary>
                <div class="issue-description">[DECODE] Found vulnerable memory access instruction, leakage score 100.00% +/- 0%.</div>
            </details><mark class="issue-line"><div class="source-line"><span class="line-number ">1629</span><span class="line-counter cline-yes">&nbsp</span><code>    enc2 = _base64Idx[input.charCodeAt(i++) - 43];</code></div>
</mark><details class="issue-inline-message issue-critical issue-memory-access target-DECODE">
                        <summary>💥&nbsp;<i>DECODE</i> Secret-dependent memory access</summary>
                <div class="issue-description">[DECODE] Found vulnerable memory access instruction, leakage score 97.78% +/- 4.97%.</div>
            </details><mark class="issue-line"><div class="source-line"><span class="line-number ">1630</span><span class="line-counter cline-yes">&nbsp</span><code>    enc3 = _base64Idx[input.charCodeAt(i++) - 43];</code></div>
</mark><details class="issue-inline-message issue-critical issue-memory-access target-DECODE">
                        <summary>💥&nbsp;<i>DECODE</i> Secret-dependent memory access</summary>
                <div class="issue-description">[DECODE] Found vulnerable memory access instruction, leakage score 100.00% +/- 0%.</div>
            </details><mark class="issue-line"><div class="source-line"><span class="line-number ">1631</span><span class="line-counter cline-yes">&nbsp</span><code>    enc4 = _base64Idx[input.charCodeAt(i++) - 43];</code></div>
</mark><details class="issue-inline-message issue-critical issue-memory-access target-DECODE">
                        <summary>💥&nbsp;<i>DECODE</i> Secret-dependent memory access</summary>
                <div class="issue-description">[DECODE] Found vulnerable memory access instruction, leakage score 100.00% +/- 0%.</div>
            </details><div class="source-line"><span class="line-number ">1632</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<div class="source-line"><span class="line-number ">1633</span><span class="line-counter cline-yes">&nbsp</span><code>    output += String.fromCharCode((enc1 &lt;&lt; 2) | (enc2 &gt;&gt; 4));</code></div>
<div class="source-line"><span class="line-number ">1634</span><span class="line-counter cline-yes">&nbsp</span><code>    if(enc3 !== 64) {</code></div>
<div class="source-line"><span class="line-number ">1635</span><span class="line-counter cline-yes">&nbsp</span><code>      // decoded at least 2 bytes</code></div>
<div class="source-line"><span class="line-number ">1636</span><span class="line-counter cline-yes">&nbsp</span><code>      output += String.fromCharCode(((enc2 &amp; 15) &lt;&lt; 4) | (enc3 &gt;&gt; 2));</code></div>
<div class="source-line"><span class="line-number ">1637</span><span class="line-counter cline-yes">&nbsp</span><code>      if(enc4 !== 64) {</code></div>
<div class="source-line"><span class="line-number ">1638</span><span class="line-counter cline-yes">&nbsp</span><code>        // decoded 3 bytes</code></div>
<div class="source-line"><span class="line-number ">1639</span><span class="line-counter cline-yes">&nbsp</span><code>        output += String.fromCharCode(((enc3 &amp; 3) &lt;&lt; 6) | enc4);</code></div>
<div class="source-line"><span class="line-number ">1640</span><span class="line-counter cline-yes">&nbsp</span><code>      }</code></div>
<div class="source-line"><span class="line-number ">1641</span><span class="line-counter cline-yes">&nbsp</span><code>    }</code></div>
<div class="source-line"><span class="line-number ">1642</span><span class="line-counter cline-yes">&nbsp</span><code>  }</code></div>
<div class="source-line"><span class="line-number ">1643</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<div class="source-line"><span class="line-number ">1644</span><span class="line-counter cline-yes">&nbsp</span><code>  return output;</code></div>
<div class="source-line"><span class="line-number ">1645</span><span class="line-counter cline-yes">&nbsp</span><code>};</code></div>
<div class="source-line"><span class="line-number ">1646</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<div class="source-line"><span class="line-number ">1647</span><span class="line-counter cline-yes">&nbsp</span><code>/**</code></div>
<div class="source-line"><span class="line-number ">1648</span><span class="line-counter cline-yes">&nbsp</span><code> * Encodes the given string of characters (a standard JavaScript</code></div>
<div class="source-line"><span class="line-number ">1649</span><span class="line-counter cline-yes">&nbsp</span><code> * string) as a binary encoded string where the bytes represent</code></div>
<div class="source-line"><span class="line-number ">1650</span><span class="line-counter cline-yes">&nbsp</span><code> * a UTF-8 encoded string of characters. Non-ASCII characters will be</code></div>
<div class="source-line"><span class="line-number ">1651</span><span class="line-counter cline-yes">&nbsp</span><code> * encoded as multiple bytes according to UTF-8.</code></div>
<div class="source-line"><span class="line-number ">1652</span><span class="line-counter cline-yes">&nbsp</span><code> *</code></div>
<div class="source-line"><span class="line-number ">1653</span><span class="line-counter cline-yes">&nbsp</span><code> * @param str a standard string of characters to encode.</code></div>
<div class="source-line"><span class="line-number ">1654</span><span class="line-counter cline-yes">&nbsp</span><code> *</code></div>
<div class="source-line"><span class="line-number ">1655</span><span class="line-counter cline-yes">&nbsp</span><code> * @return the binary encoded string.</code></div>
<div class="source-line"><span class="line-number ">1656</span><span class="line-counter cline-yes">&nbsp</span><code> */</code></div>
<div class="source-line"><span class="line-number ">1657</span><span class="line-counter cline-yes">&nbsp</span><code>util.encodeUtf8 = function(str) {</code></div>
<div class="source-line"><span class="line-number ">1658</span><span class="line-counter cline-yes">&nbsp</span><code>  return unescape(encodeURIComponent(str));</code></div>
<div class="source-line"><span class="line-number ">1659</span><span class="line-counter cline-yes">&nbsp</span><code>};</code></div>
<div class="source-line"><span class="line-number ">1660</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<div class="source-line"><span class="line-number ">1661</span><span class="line-counter cline-yes">&nbsp</span><code>/**</code></div>
<div class="source-line"><span class="line-number ">1662</span><span class="line-counter cline-yes">&nbsp</span><code> * Decodes a binary encoded string that contains bytes that</code></div>
<div class="source-line"><span class="line-number ">1663</span><span class="line-counter cline-yes">&nbsp</span><code> * represent a UTF-8 encoded string of characters -- into a</code></div>
<div class="source-line"><span class="line-number ">1664</span><span class="line-counter cline-yes">&nbsp</span><code> * string of characters (a standard JavaScript string).</code></div>
<div class="source-line"><span class="line-number ">1665</span><span class="line-counter cline-yes">&nbsp</span><code> *</code></div>
<div class="source-line"><span class="line-number ">1666</span><span class="line-counter cline-yes">&nbsp</span><code> * @param str the binary encoded string to decode.</code></div>
<div class="source-line"><span class="line-number ">1667</span><span class="line-counter cline-yes">&nbsp</span><code> *</code></div>
<div class="source-line"><span class="line-number ">1668</span><span class="line-counter cline-yes">&nbsp</span><code> * @return the resulting standard string of characters.</code></div>
<div class="source-line"><span class="line-number ">1669</span><span class="line-counter cline-yes">&nbsp</span><code> */</code></div>
<div class="source-line"><span class="line-number ">1670</span><span class="line-counter cline-no">！</span><code><span>util.decodeUtf8 = </span><span class="cstat-no" title="statement not covered">function(str) {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1671</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  return decodeURIComponent(escape(str));</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1672</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">}</span><span>;</span></code></div>
<div class="source-line"><span class="line-number ">1673</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<div class="source-line"><span class="line-number ">1674</span><span class="line-counter cline-yes">&nbsp</span><code>// binary encoding/decoding tools</code></div>
<div class="source-line"><span class="line-number ">1675</span><span class="line-counter cline-yes">&nbsp</span><code>// FIXME: Experimental. Do not use yet.</code></div>
<div class="source-line"><span class="line-number ">1676</span><span class="line-counter cline-yes">&nbsp</span><code>util.binary = {</code></div>
<div class="source-line"><span class="line-number ">1677</span><span class="line-counter cline-yes">&nbsp</span><code>  raw: {},</code></div>
<div class="source-line"><span class="line-number ">1678</span><span class="line-counter cline-yes">&nbsp</span><code>  hex: {},</code></div>
<div class="source-line"><span class="line-number ">1679</span><span class="line-counter cline-yes">&nbsp</span><code>  base64: {},</code></div>
<div class="source-line"><span class="line-number ">1680</span><span class="line-counter cline-yes">&nbsp</span><code>  base58: {},</code></div>
<div class="source-line"><span class="line-number ">1681</span><span class="line-counter cline-yes">&nbsp</span><code>  baseN : {</code></div>
<div class="source-line"><span class="line-number ">1682</span><span class="line-counter cline-yes">&nbsp</span><code>    encode: baseN.encode,</code></div>
<div class="source-line"><span class="line-number ">1683</span><span class="line-counter cline-yes">&nbsp</span><code>    decode: baseN.decode</code></div>
<div class="source-line"><span class="line-number ">1684</span><span class="line-counter cline-yes">&nbsp</span><code>  }</code></div>
<div class="source-line"><span class="line-number ">1685</span><span class="line-counter cline-yes">&nbsp</span><code>};</code></div>
<div class="source-line"><span class="line-number ">1686</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<div class="source-line"><span class="line-number ">1687</span><span class="line-counter cline-yes">&nbsp</span><code>/**</code></div>
<div class="source-line"><span class="line-number ">1688</span><span class="line-counter cline-yes">&nbsp</span><code> * Encodes a Uint8Array as a binary-encoded string. This encoding uses</code></div>
<div class="source-line"><span class="line-number ">1689</span><span class="line-counter cline-yes">&nbsp</span><code> * a value between 0 and 255 for each character.</code></div>
<div class="source-line"><span class="line-number ">1690</span><span class="line-counter cline-yes">&nbsp</span><code> *</code></div>
<div class="source-line"><span class="line-number ">1691</span><span class="line-counter cline-yes">&nbsp</span><code> * @param bytes the Uint8Array to encode.</code></div>
<div class="source-line"><span class="line-number ">1692</span><span class="line-counter cline-yes">&nbsp</span><code> *</code></div>
<div class="source-line"><span class="line-number ">1693</span><span class="line-counter cline-yes">&nbsp</span><code> * @return the binary-encoded string.</code></div>
<div class="source-line"><span class="line-number ">1694</span><span class="line-counter cline-yes">&nbsp</span><code> */</code></div>
<div class="source-line"><span class="line-number ">1695</span><span class="line-counter cline-no">！</span><code><span>util.binary.raw.encode = </span><span class="cstat-no" title="statement not covered">function(bytes) {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1696</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  return String.fromCharCode.apply(null, bytes);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1697</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">}</span><span>;</span></code></div>
<div class="source-line"><span class="line-number ">1698</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<div class="source-line"><span class="line-number ">1699</span><span class="line-counter cline-yes">&nbsp</span><code>/**</code></div>
<div class="source-line"><span class="line-number ">1700</span><span class="line-counter cline-yes">&nbsp</span><code> * Decodes a binary-encoded string to a Uint8Array. This encoding uses</code></div>
<div class="source-line"><span class="line-number ">1701</span><span class="line-counter cline-yes">&nbsp</span><code> * a value between 0 and 255 for each character.</code></div>
<div class="source-line"><span class="line-number ">1702</span><span class="line-counter cline-yes">&nbsp</span><code> *</code></div>
<div class="source-line"><span class="line-number ">1703</span><span class="line-counter cline-yes">&nbsp</span><code> * @param str the binary-encoded string to decode.</code></div>
<div class="source-line"><span class="line-number ">1704</span><span class="line-counter cline-yes">&nbsp</span><code> * @param [output] an optional Uint8Array to write the output to; if it</code></div>
<div class="source-line"><span class="line-number ">1705</span><span class="line-counter cline-yes">&nbsp</span><code> *          is too small, an exception will be thrown.</code></div>
<div class="source-line"><span class="line-number ">1706</span><span class="line-counter cline-yes">&nbsp</span><code> * @param [offset] the start offset for writing to the output (default: 0).</code></div>
<div class="source-line"><span class="line-number ">1707</span><span class="line-counter cline-yes">&nbsp</span><code> *</code></div>
<div class="source-line"><span class="line-number ">1708</span><span class="line-counter cline-yes">&nbsp</span><code> * @return the Uint8Array or the number of bytes written if output was given.</code></div>
<div class="source-line"><span class="line-number ">1709</span><span class="line-counter cline-yes">&nbsp</span><code> */</code></div>
<div class="source-line"><span class="line-number ">1710</span><span class="line-counter cline-no">！</span><code><span>util.binary.raw.decode = </span><span class="cstat-no" title="statement not covered">function(str, output, offset) {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1711</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  var out = output;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1712</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  if(!out) {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1713</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    out = new Uint8Array(str.length);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1714</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  }</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1715</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  offset = offset || 0;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1716</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  var j = offset;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1717</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  for(var i = 0; i &lt; str.length; ++i) {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1718</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    out[j++] = str.charCodeAt(i);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1719</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  }</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1720</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  return output ? (j - offset) : out;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1721</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">}</span><span>;</span></code></div>
<div class="source-line"><span class="line-number ">1722</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<div class="source-line"><span class="line-number ">1723</span><span class="line-counter cline-yes">&nbsp</span><code>/**</code></div>
<div class="source-line"><span class="line-number ">1724</span><span class="line-counter cline-yes">&nbsp</span><code> * Encodes a &#39;binary&#39; string, ArrayBuffer, DataView, TypedArray, or</code></div>
<div class="source-line"><span class="line-number ">1725</span><span class="line-counter cline-yes">&nbsp</span><code> * ByteBuffer as a string of hexadecimal characters.</code></div>
<div class="source-line"><span class="line-number ">1726</span><span class="line-counter cline-yes">&nbsp</span><code> *</code></div>
<div class="source-line"><span class="line-number ">1727</span><span class="line-counter cline-yes">&nbsp</span><code> * @param bytes the bytes to convert.</code></div>
<div class="source-line"><span class="line-number ">1728</span><span class="line-counter cline-yes">&nbsp</span><code> *</code></div>
<div class="source-line"><span class="line-number ">1729</span><span class="line-counter cline-yes">&nbsp</span><code> * @return the string of hexadecimal characters.</code></div>
<div class="source-line"><span class="line-number ">1730</span><span class="line-counter cline-yes">&nbsp</span><code> */</code></div>
<div class="source-line"><span class="line-number ">1731</span><span class="line-counter cline-yes">&nbsp</span><code>util.binary.hex.encode = util.bytesToHex;</code></div>
<div class="source-line"><span class="line-number ">1732</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<div class="source-line"><span class="line-number ">1733</span><span class="line-counter cline-yes">&nbsp</span><code>/**</code></div>
<div class="source-line"><span class="line-number ">1734</span><span class="line-counter cline-yes">&nbsp</span><code> * Decodes a hex-encoded string to a Uint8Array.</code></div>
<div class="source-line"><span class="line-number ">1735</span><span class="line-counter cline-yes">&nbsp</span><code> *</code></div>
<div class="source-line"><span class="line-number ">1736</span><span class="line-counter cline-yes">&nbsp</span><code> * @param hex the hexadecimal string to convert.</code></div>
<div class="source-line"><span class="line-number ">1737</span><span class="line-counter cline-yes">&nbsp</span><code> * @param [output] an optional Uint8Array to write the output to; if it</code></div>
<div class="source-line"><span class="line-number ">1738</span><span class="line-counter cline-yes">&nbsp</span><code> *          is too small, an exception will be thrown.</code></div>
<div class="source-line"><span class="line-number ">1739</span><span class="line-counter cline-yes">&nbsp</span><code> * @param [offset] the start offset for writing to the output (default: 0).</code></div>
<div class="source-line"><span class="line-number ">1740</span><span class="line-counter cline-yes">&nbsp</span><code> *</code></div>
<div class="source-line"><span class="line-number ">1741</span><span class="line-counter cline-yes">&nbsp</span><code> * @return the Uint8Array or the number of bytes written if output was given.</code></div>
<div class="source-line"><span class="line-number ">1742</span><span class="line-counter cline-yes">&nbsp</span><code> */</code></div>
<div class="source-line"><span class="line-number ">1743</span><span class="line-counter cline-no">！</span><code><span>util.binary.hex.decode = </span><span class="cstat-no" title="statement not covered">function(hex, output, offset) {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1744</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  var out = output;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1745</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  if(!out) {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1746</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    out = new Uint8Array(Math.ceil(hex.length / 2));</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1747</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  }</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1748</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  offset = offset || 0;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1749</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  var i = 0, j = offset;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1750</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  if(hex.length &amp; 1) {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1751</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    // odd number of characters, convert first character alone</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1752</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    i = 1;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1753</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    out[j++] = parseInt(hex[0], 16);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1754</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  }</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1755</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  // convert 2 characters (1 byte) at a time</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1756</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  for(; i &lt; hex.length; i += 2) {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1757</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    out[j++] = parseInt(hex.substr(i, 2), 16);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1758</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  }</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1759</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  return output ? (j - offset) : out;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1760</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">}</span><span>;</span></code></div>
<div class="source-line"><span class="line-number ">1761</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<div class="source-line"><span class="line-number ">1762</span><span class="line-counter cline-yes">&nbsp</span><code>/**</code></div>
<div class="source-line"><span class="line-number ">1763</span><span class="line-counter cline-yes">&nbsp</span><code> * Base64-encodes a Uint8Array.</code></div>
<div class="source-line"><span class="line-number ">1764</span><span class="line-counter cline-yes">&nbsp</span><code> *</code></div>
<div class="source-line"><span class="line-number ">1765</span><span class="line-counter cline-yes">&nbsp</span><code> * @param input the Uint8Array to encode.</code></div>
<div class="source-line"><span class="line-number ">1766</span><span class="line-counter cline-yes">&nbsp</span><code> * @param maxline the maximum number of encoded characters per line to use,</code></div>
<div class="source-line"><span class="line-number ">1767</span><span class="line-counter cline-yes">&nbsp</span><code> *          defaults to none.</code></div>
<div class="source-line"><span class="line-number ">1768</span><span class="line-counter cline-yes">&nbsp</span><code> *</code></div>
<div class="source-line"><span class="line-number ">1769</span><span class="line-counter cline-yes">&nbsp</span><code> * @return the base64-encoded output string.</code></div>
<div class="source-line"><span class="line-number ">1770</span><span class="line-counter cline-yes">&nbsp</span><code> */</code></div>
<div class="source-line"><span class="line-number ">1771</span><span class="line-counter cline-no">！</span><code><span>util.binary.base64.encode = </span><span class="cstat-no" title="statement not covered">function(input, maxline) {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1772</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  var line = &#39;&#39;;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1773</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  var output = &#39;&#39;;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1774</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  var chr1, chr2, chr3;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1775</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  var i = 0;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1776</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  while(i &lt; input.byteLength) {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1777</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    chr1 = input[i++];</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1778</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    chr2 = input[i++];</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1779</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    chr3 = input[i++];</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1780</span><span class="line-counter cline-no">！</span><code><span class="cstat-no" title="statement not covered"><br/></span><span></span></code></div>
<div class="source-line"><span class="line-number ">1781</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    // encode 4 character group</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1782</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    line += _base64.charAt(chr1 &gt;&gt; 2);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1783</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    line += _base64.charAt(((chr1 &amp; 3) &lt;&lt; 4) | (chr2 &gt;&gt; 4));</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1784</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    if(isNaN(chr2)) {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1785</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">      line += &#39;==&#39;;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1786</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    } else {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1787</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">      line += _base64.charAt(((chr2 &amp; 15) &lt;&lt; 2) | (chr3 &gt;&gt; 6));</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1788</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">      line += isNaN(chr3) ? &#39;=&#39; : _base64.charAt(chr3 &amp; 63);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1789</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    }</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1790</span><span class="line-counter cline-no">！</span><code><span class="cstat-no" title="statement not covered"><br/></span><span></span></code></div>
<div class="source-line"><span class="line-number ">1791</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    if(maxline &amp;&amp; line.length &gt; maxline) {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1792</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">      output += line.substr(0, maxline) + &#39;\r\n&#39;;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1793</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">      line = line.substr(maxline);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1794</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    }</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1795</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  }</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1796</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  output += line;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1797</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  return output;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1798</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">}</span><span>;</span></code></div>
<div class="source-line"><span class="line-number ">1799</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<div class="source-line"><span class="line-number ">1800</span><span class="line-counter cline-yes">&nbsp</span><code>/**</code></div>
<div class="source-line"><span class="line-number ">1801</span><span class="line-counter cline-yes">&nbsp</span><code> * Decodes a base64-encoded string to a Uint8Array.</code></div>
<div class="source-line"><span class="line-number ">1802</span><span class="line-counter cline-yes">&nbsp</span><code> *</code></div>
<div class="source-line"><span class="line-number ">1803</span><span class="line-counter cline-yes">&nbsp</span><code> * @param input the base64-encoded input string.</code></div>
<div class="source-line"><span class="line-number ">1804</span><span class="line-counter cline-yes">&nbsp</span><code> * @param [output] an optional Uint8Array to write the output to; if it</code></div>
<div class="source-line"><span class="line-number ">1805</span><span class="line-counter cline-yes">&nbsp</span><code> *          is too small, an exception will be thrown.</code></div>
<div class="source-line"><span class="line-number ">1806</span><span class="line-counter cline-yes">&nbsp</span><code> * @param [offset] the start offset for writing to the output (default: 0).</code></div>
<div class="source-line"><span class="line-number ">1807</span><span class="line-counter cline-yes">&nbsp</span><code> *</code></div>
<div class="source-line"><span class="line-number ">1808</span><span class="line-counter cline-yes">&nbsp</span><code> * @return the Uint8Array or the number of bytes written if output was given.</code></div>
<div class="source-line"><span class="line-number ">1809</span><span class="line-counter cline-yes">&nbsp</span><code> */</code></div>
<div class="source-line"><span class="line-number ">1810</span><span class="line-counter cline-no">！</span><code><span>util.binary.base64.decode = </span><span class="cstat-no" title="statement not covered">function(input, output, offset) {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1811</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  var out = output;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1812</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  if(!out) {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1813</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    out = new Uint8Array(Math.ceil(input.length / 4) * 3);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1814</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  }</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1815</span><span class="line-counter cline-no">！</span><code><span class="cstat-no" title="statement not covered"><br/></span><span></span></code></div>
<div class="source-line"><span class="line-number ">1816</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  // remove all non-base64 characters</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1817</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  input = input.replace(/[^A-Za-z0-9\+\/\=]/g, &#39;&#39;);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1818</span><span class="line-counter cline-no">！</span><code><span class="cstat-no" title="statement not covered"><br/></span><span></span></code></div>
<div class="source-line"><span class="line-number ">1819</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  offset = offset || 0;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1820</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  var enc1, enc2, enc3, enc4;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1821</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  var i = 0, j = offset;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1822</span><span class="line-counter cline-no">！</span><code><span class="cstat-no" title="statement not covered"><br/></span><span></span></code></div>
<div class="source-line"><span class="line-number ">1823</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  while(i &lt; input.length) {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1824</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    enc1 = _base64Idx[input.charCodeAt(i++) - 43];</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1825</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    enc2 = _base64Idx[input.charCodeAt(i++) - 43];</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1826</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    enc3 = _base64Idx[input.charCodeAt(i++) - 43];</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1827</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    enc4 = _base64Idx[input.charCodeAt(i++) - 43];</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1828</span><span class="line-counter cline-no">！</span><code><span class="cstat-no" title="statement not covered"><br/></span><span></span></code></div>
<div class="source-line"><span class="line-number ">1829</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    out[j++] = (enc1 &lt;&lt; 2) | (enc2 &gt;&gt; 4);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1830</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    if(enc3 !== 64) {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1831</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">      // decoded at least 2 bytes</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1832</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">      out[j++] = ((enc2 &amp; 15) &lt;&lt; 4) | (enc3 &gt;&gt; 2);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1833</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">      if(enc4 !== 64) {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1834</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">        // decoded 3 bytes</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1835</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">        out[j++] = ((enc3 &amp; 3) &lt;&lt; 6) | enc4;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1836</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">      }</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1837</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    }</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1838</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  }</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1839</span><span class="line-counter cline-no">！</span><code><span class="cstat-no" title="statement not covered"><br/></span><span></span></code></div>
<div class="source-line"><span class="line-number ">1840</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  // make sure result is the exact decoded length</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1841</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  return output ? (j - offset) : out.subarray(0, j);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1842</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">}</span><span>;</span></code></div>
<div class="source-line"><span class="line-number ">1843</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<div class="source-line"><span class="line-number ">1844</span><span class="line-counter cline-yes">&nbsp</span><code>// add support for base58 encoding/decoding with Bitcoin alphabet</code></div>
<div class="source-line"><span class="line-number ">1845</span><span class="line-counter cline-no">！</span><code><span>util.binary.base58.encode = </span><span class="cstat-no" title="statement not covered">function(input, maxline) {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1846</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  return util.binary.baseN.encode(input, _base58, maxline);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1847</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">}</span><span>;</span></code></div>
<div class="source-line"><span class="line-number ">1848</span><span class="line-counter cline-no">！</span><code><span>util.binary.base58.decode = </span><span class="cstat-no" title="statement not covered">function(input, maxline) {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1849</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  return util.binary.baseN.decode(input, _base58, maxline);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1850</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">}</span><span>;</span></code></div>
<div class="source-line"><span class="line-number ">1851</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<div class="source-line"><span class="line-number ">1852</span><span class="line-counter cline-yes">&nbsp</span><code>// text encoding/decoding tools</code></div>
<div class="source-line"><span class="line-number ">1853</span><span class="line-counter cline-yes">&nbsp</span><code>// FIXME: Experimental. Do not use yet.</code></div>
<div class="source-line"><span class="line-number ">1854</span><span class="line-counter cline-yes">&nbsp</span><code>util.text = {</code></div>
<div class="source-line"><span class="line-number ">1855</span><span class="line-counter cline-yes">&nbsp</span><code>  utf8: {},</code></div>
<div class="source-line"><span class="line-number ">1856</span><span class="line-counter cline-yes">&nbsp</span><code>  utf16: {}</code></div>
<div class="source-line"><span class="line-number ">1857</span><span class="line-counter cline-yes">&nbsp</span><code>};</code></div>
<div class="source-line"><span class="line-number ">1858</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<div class="source-line"><span class="line-number ">1859</span><span class="line-counter cline-yes">&nbsp</span><code>/**</code></div>
<div class="source-line"><span class="line-number ">1860</span><span class="line-counter cline-yes">&nbsp</span><code> * Encodes the given string as UTF-8 in a Uint8Array.</code></div>
<div class="source-line"><span class="line-number ">1861</span><span class="line-counter cline-yes">&nbsp</span><code> *</code></div>
<div class="source-line"><span class="line-number ">1862</span><span class="line-counter cline-yes">&nbsp</span><code> * @param str the string to encode.</code></div>
<div class="source-line"><span class="line-number ">1863</span><span class="line-counter cline-yes">&nbsp</span><code> * @param [output] an optional Uint8Array to write the output to; if it</code></div>
<div class="source-line"><span class="line-number ">1864</span><span class="line-counter cline-yes">&nbsp</span><code> *          is too small, an exception will be thrown.</code></div>
<div class="source-line"><span class="line-number ">1865</span><span class="line-counter cline-yes">&nbsp</span><code> * @param [offset] the start offset for writing to the output (default: 0).</code></div>
<div class="source-line"><span class="line-number ">1866</span><span class="line-counter cline-yes">&nbsp</span><code> *</code></div>
<div class="source-line"><span class="line-number ">1867</span><span class="line-counter cline-yes">&nbsp</span><code> * @return the Uint8Array or the number of bytes written if output was given.</code></div>
<div class="source-line"><span class="line-number ">1868</span><span class="line-counter cline-yes">&nbsp</span><code> */</code></div>
<div class="source-line"><span class="line-number ">1869</span><span class="line-counter cline-no">！</span><code><span>util.text.utf8.encode = </span><span class="cstat-no" title="statement not covered">function(str, output, offset) {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1870</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  str = util.encodeUtf8(str);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1871</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  var out = output;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1872</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  if(!out) {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1873</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    out = new Uint8Array(str.length);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1874</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  }</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1875</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  offset = offset || 0;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1876</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  var j = offset;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1877</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  for(var i = 0; i &lt; str.length; ++i) {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1878</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    out[j++] = str.charCodeAt(i);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1879</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  }</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1880</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  return output ? (j - offset) : out;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1881</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">}</span><span>;</span></code></div>
<div class="source-line"><span class="line-number ">1882</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<div class="source-line"><span class="line-number ">1883</span><span class="line-counter cline-yes">&nbsp</span><code>/**</code></div>
<div class="source-line"><span class="line-number ">1884</span><span class="line-counter cline-yes">&nbsp</span><code> * Decodes the UTF-8 contents from a Uint8Array.</code></div>
<div class="source-line"><span class="line-number ">1885</span><span class="line-counter cline-yes">&nbsp</span><code> *</code></div>
<div class="source-line"><span class="line-number ">1886</span><span class="line-counter cline-yes">&nbsp</span><code> * @param bytes the Uint8Array to decode.</code></div>
<div class="source-line"><span class="line-number ">1887</span><span class="line-counter cline-yes">&nbsp</span><code> *</code></div>
<div class="source-line"><span class="line-number ">1888</span><span class="line-counter cline-yes">&nbsp</span><code> * @return the resulting string.</code></div>
<div class="source-line"><span class="line-number ">1889</span><span class="line-counter cline-yes">&nbsp</span><code> */</code></div>
<div class="source-line"><span class="line-number ">1890</span><span class="line-counter cline-no">！</span><code><span>util.text.utf8.decode = </span><span class="cstat-no" title="statement not covered">function(bytes) {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1891</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  return util.decodeUtf8(String.fromCharCode.apply(null, bytes));</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1892</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">}</span><span>;</span></code></div>
<div class="source-line"><span class="line-number ">1893</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<div class="source-line"><span class="line-number ">1894</span><span class="line-counter cline-yes">&nbsp</span><code>/**</code></div>
<div class="source-line"><span class="line-number ">1895</span><span class="line-counter cline-yes">&nbsp</span><code> * Encodes the given string as UTF-16 in a Uint8Array.</code></div>
<div class="source-line"><span class="line-number ">1896</span><span class="line-counter cline-yes">&nbsp</span><code> *</code></div>
<div class="source-line"><span class="line-number ">1897</span><span class="line-counter cline-yes">&nbsp</span><code> * @param str the string to encode.</code></div>
<div class="source-line"><span class="line-number ">1898</span><span class="line-counter cline-yes">&nbsp</span><code> * @param [output] an optional Uint8Array to write the output to; if it</code></div>
<div class="source-line"><span class="line-number ">1899</span><span class="line-counter cline-yes">&nbsp</span><code> *          is too small, an exception will be thrown.</code></div>
<div class="source-line"><span class="line-number ">1900</span><span class="line-counter cline-yes">&nbsp</span><code> * @param [offset] the start offset for writing to the output (default: 0).</code></div>
<div class="source-line"><span class="line-number ">1901</span><span class="line-counter cline-yes">&nbsp</span><code> *</code></div>
<div class="source-line"><span class="line-number ">1902</span><span class="line-counter cline-yes">&nbsp</span><code> * @return the Uint8Array or the number of bytes written if output was given.</code></div>
<div class="source-line"><span class="line-number ">1903</span><span class="line-counter cline-yes">&nbsp</span><code> */</code></div>
<div class="source-line"><span class="line-number ">1904</span><span class="line-counter cline-no">！</span><code><span>util.text.utf16.encode = </span><span class="cstat-no" title="statement not covered">function(str, output, offset) {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1905</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  var out = output;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1906</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  if(!out) {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1907</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    out = new Uint8Array(str.length * 2);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1908</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  }</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1909</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  var view = new Uint16Array(out.buffer);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1910</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  offset = offset || 0;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1911</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  var j = offset;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1912</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  var k = offset;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1913</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  for(var i = 0; i &lt; str.length; ++i) {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1914</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    view[k++] = str.charCodeAt(i);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1915</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    j += 2;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1916</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  }</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1917</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  return output ? (j - offset) : out;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1918</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">}</span><span>;</span></code></div>
<div class="source-line"><span class="line-number ">1919</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<div class="source-line"><span class="line-number ">1920</span><span class="line-counter cline-yes">&nbsp</span><code>/**</code></div>
<div class="source-line"><span class="line-number ">1921</span><span class="line-counter cline-yes">&nbsp</span><code> * Decodes the UTF-16 contents from a Uint8Array.</code></div>
<div class="source-line"><span class="line-number ">1922</span><span class="line-counter cline-yes">&nbsp</span><code> *</code></div>
<div class="source-line"><span class="line-number ">1923</span><span class="line-counter cline-yes">&nbsp</span><code> * @param bytes the Uint8Array to decode.</code></div>
<div class="source-line"><span class="line-number ">1924</span><span class="line-counter cline-yes">&nbsp</span><code> *</code></div>
<div class="source-line"><span class="line-number ">1925</span><span class="line-counter cline-yes">&nbsp</span><code> * @return the resulting string.</code></div>
<div class="source-line"><span class="line-number ">1926</span><span class="line-counter cline-yes">&nbsp</span><code> */</code></div>
<div class="source-line"><span class="line-number ">1927</span><span class="line-counter cline-no">！</span><code><span>util.text.utf16.decode = </span><span class="cstat-no" title="statement not covered">function(bytes) {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1928</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  return String.fromCharCode.apply(null, new Uint16Array(bytes.buffer));</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1929</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">}</span><span>;</span></code></div>
<div class="source-line"><span class="line-number ">1930</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<div class="source-line"><span class="line-number ">1931</span><span class="line-counter cline-yes">&nbsp</span><code>/**</code></div>
<div class="source-line"><span class="line-number ">1932</span><span class="line-counter cline-yes">&nbsp</span><code> * Deflates the given data using a flash interface.</code></div>
<div class="source-line"><span class="line-number ">1933</span><span class="line-counter cline-yes">&nbsp</span><code> *</code></div>
<div class="source-line"><span class="line-number ">1934</span><span class="line-counter cline-yes">&nbsp</span><code> * @param api the flash interface.</code></div>
<div class="source-line"><span class="line-number ">1935</span><span class="line-counter cline-yes">&nbsp</span><code> * @param bytes the data.</code></div>
<div class="source-line"><span class="line-number ">1936</span><span class="line-counter cline-yes">&nbsp</span><code> * @param raw true to return only raw deflate data, false to include zlib</code></div>
<div class="source-line"><span class="line-number ">1937</span><span class="line-counter cline-yes">&nbsp</span><code> *          header and trailer.</code></div>
<div class="source-line"><span class="line-number ">1938</span><span class="line-counter cline-yes">&nbsp</span><code> *</code></div>
<div class="source-line"><span class="line-number ">1939</span><span class="line-counter cline-yes">&nbsp</span><code> * @return the deflated data as a string.</code></div>
<div class="source-line"><span class="line-number ">1940</span><span class="line-counter cline-yes">&nbsp</span><code> */</code></div>
<div class="source-line"><span class="line-number ">1941</span><span class="line-counter cline-no">！</span><code><span>util.deflate = </span><span class="cstat-no" title="statement not covered">function(api, bytes, raw) {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1942</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  bytes = util.decode64(api.deflate(util.encode64(bytes)).rval);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1943</span><span class="line-counter cline-no">！</span><code><span class="cstat-no" title="statement not covered"><br/></span><span></span></code></div>
<div class="source-line"><span class="line-number ">1944</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  // strip zlib header and trailer if necessary</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1945</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  if(raw) {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1946</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    // zlib header is 2 bytes (CMF,FLG) where FLG indicates that</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1947</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    // there is a 4-byte DICT (alder-32) block before the data if</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1948</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    // its 5th bit is set</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1949</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    var start = 2;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1950</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    var flg = bytes.charCodeAt(1);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1951</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    if(flg &amp; 0x20) {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1952</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">      start = 6;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1953</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    }</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1954</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    // zlib trailer is 4 bytes of adler-32</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1955</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    bytes = bytes.substring(start, bytes.length - 4);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1956</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  }</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1957</span><span class="line-counter cline-no">！</span><code><span class="cstat-no" title="statement not covered"><br/></span><span></span></code></div>
<div class="source-line"><span class="line-number ">1958</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  return bytes;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1959</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">}</span><span>;</span></code></div>
<div class="source-line"><span class="line-number ">1960</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<div class="source-line"><span class="line-number ">1961</span><span class="line-counter cline-yes">&nbsp</span><code>/**</code></div>
<div class="source-line"><span class="line-number ">1962</span><span class="line-counter cline-yes">&nbsp</span><code> * Inflates the given data using a flash interface.</code></div>
<div class="source-line"><span class="line-number ">1963</span><span class="line-counter cline-yes">&nbsp</span><code> *</code></div>
<div class="source-line"><span class="line-number ">1964</span><span class="line-counter cline-yes">&nbsp</span><code> * @param api the flash interface.</code></div>
<div class="source-line"><span class="line-number ">1965</span><span class="line-counter cline-yes">&nbsp</span><code> * @param bytes the data.</code></div>
<div class="source-line"><span class="line-number ">1966</span><span class="line-counter cline-yes">&nbsp</span><code> * @param raw true if the incoming data has no zlib header or trailer and is</code></div>
<div class="source-line"><span class="line-number ">1967</span><span class="line-counter cline-yes">&nbsp</span><code> *          raw DEFLATE data.</code></div>
<div class="source-line"><span class="line-number ">1968</span><span class="line-counter cline-yes">&nbsp</span><code> *</code></div>
<div class="source-line"><span class="line-number ">1969</span><span class="line-counter cline-yes">&nbsp</span><code> * @return the inflated data as a string, null on error.</code></div>
<div class="source-line"><span class="line-number ">1970</span><span class="line-counter cline-yes">&nbsp</span><code> */</code></div>
<div class="source-line"><span class="line-number ">1971</span><span class="line-counter cline-no">！</span><code><span>util.inflate = </span><span class="cstat-no" title="statement not covered">function(api, bytes, raw) {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1972</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  // TODO: add zlib header and trailer if necessary/possible</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1973</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  var rval = api.inflate(util.encode64(bytes)).rval;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1974</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  return (rval === null) ? null : util.decode64(rval);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1975</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">}</span><span>;</span></code></div>
<div class="source-line"><span class="line-number ">1976</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<div class="source-line"><span class="line-number ">1977</span><span class="line-counter cline-yes">&nbsp</span><code>/**</code></div>
<div class="source-line"><span class="line-number ">1978</span><span class="line-counter cline-yes">&nbsp</span><code> * Sets a storage object.</code></div>
<div class="source-line"><span class="line-number ">1979</span><span class="line-counter cline-yes">&nbsp</span><code> *</code></div>
<div class="source-line"><span class="line-number ">1980</span><span class="line-counter cline-yes">&nbsp</span><code> * @param api the storage interface.</code></div>
<div class="source-line"><span class="line-number ">1981</span><span class="line-counter cline-yes">&nbsp</span><code> * @param id the storage ID to use.</code></div>
<div class="source-line"><span class="line-number ">1982</span><span class="line-counter cline-yes">&nbsp</span><code> * @param obj the storage object, null to remove.</code></div>
<div class="source-line"><span class="line-number ">1983</span><span class="line-counter cline-yes">&nbsp</span><code> */</code></div>
<div class="source-line"><span class="line-number ">1984</span><span class="line-counter cline-no">！</span><code><span>var _setStorageObject = </span><span class="cstat-no" title="statement not covered">function(api, id, obj) {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1985</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  if(!api) {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1986</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    throw new Error(&#39;WebStorage not available.&#39;);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1987</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  }</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1988</span><span class="line-counter cline-no">！</span><code><span class="cstat-no" title="statement not covered"><br/></span><span></span></code></div>
<div class="source-line"><span class="line-number ">1989</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  var rval;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1990</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  if(obj === null) {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1991</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    rval = api.removeItem(id);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1992</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  } else {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1993</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    // json-encode and base64-encode object</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1994</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    obj = util.encode64(JSON.stringify(obj));</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1995</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    rval = api.setItem(id, obj);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1996</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  }</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1997</span><span class="line-counter cline-no">！</span><code><span class="cstat-no" title="statement not covered"><br/></span><span></span></code></div>
<div class="source-line"><span class="line-number ">1998</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  // handle potential flash error</span><span></span></code></div>
<div class="source-line"><span class="line-number ">1999</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  if(typeof(rval) !== &#39;undefined&#39; &amp;&amp; rval.rval !== true) {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2000</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    var error = new Error(rval.error.message);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2001</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    error.id = rval.error.id;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2002</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    error.name = rval.error.name;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2003</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    throw error;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2004</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  }</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2005</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">}</span><span>;</span></code></div>
<div class="source-line"><span class="line-number ">2006</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<div class="source-line"><span class="line-number ">2007</span><span class="line-counter cline-yes">&nbsp</span><code>/**</code></div>
<div class="source-line"><span class="line-number ">2008</span><span class="line-counter cline-yes">&nbsp</span><code> * Gets a storage object.</code></div>
<div class="source-line"><span class="line-number ">2009</span><span class="line-counter cline-yes">&nbsp</span><code> *</code></div>
<div class="source-line"><span class="line-number ">2010</span><span class="line-counter cline-yes">&nbsp</span><code> * @param api the storage interface.</code></div>
<div class="source-line"><span class="line-number ">2011</span><span class="line-counter cline-yes">&nbsp</span><code> * @param id the storage ID to use.</code></div>
<div class="source-line"><span class="line-number ">2012</span><span class="line-counter cline-yes">&nbsp</span><code> *</code></div>
<div class="source-line"><span class="line-number ">2013</span><span class="line-counter cline-yes">&nbsp</span><code> * @return the storage object entry or null if none exists.</code></div>
<div class="source-line"><span class="line-number ">2014</span><span class="line-counter cline-yes">&nbsp</span><code> */</code></div>
<div class="source-line"><span class="line-number ">2015</span><span class="line-counter cline-no">！</span><code><span>var _getStorageObject = </span><span class="cstat-no" title="statement not covered">function(api, id) {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2016</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  if(!api) {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2017</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    throw new Error(&#39;WebStorage not available.&#39;);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2018</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  }</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2019</span><span class="line-counter cline-no">！</span><code><span class="cstat-no" title="statement not covered"><br/></span><span></span></code></div>
<div class="source-line"><span class="line-number ">2020</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  // get the existing entry</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2021</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  var rval = api.getItem(id);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2022</span><span class="line-counter cline-no">！</span><code><span class="cstat-no" title="statement not covered"><br/></span><span></span></code></div>
<div class="source-line"><span class="line-number ">2023</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  /* Note: We check api.init because we can&#39;t do (api == localStorage)</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2024</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    on IE because of &quot;Class doesn&#39;t support Automation&quot; exception. Only</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2025</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    the flash api has an init method so this works too, but we need a</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2026</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    better solution in the future. */</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2027</span><span class="line-counter cline-no">！</span><code><span class="cstat-no" title="statement not covered"><br/></span><span></span></code></div>
<div class="source-line"><span class="line-number ">2028</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  // flash returns item wrapped in an object, handle special case</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2029</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  if(api.init) {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2030</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    if(rval.rval === null) {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2031</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">      if(rval.error) {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2032</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">        var error = new Error(rval.error.message);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2033</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">        error.id = rval.error.id;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2034</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">        error.name = rval.error.name;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2035</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">        throw error;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2036</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">      }</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2037</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">      // no error, but also no item</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2038</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">      rval = null;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2039</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    } else {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2040</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">      rval = rval.rval;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2041</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    }</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2042</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  }</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2043</span><span class="line-counter cline-no">！</span><code><span class="cstat-no" title="statement not covered"><br/></span><span></span></code></div>
<div class="source-line"><span class="line-number ">2044</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  // handle decoding</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2045</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  if(rval !== null) {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2046</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    // base64-decode and json-decode data</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2047</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    rval = JSON.parse(util.decode64(rval));</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2048</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  }</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2049</span><span class="line-counter cline-no">！</span><code><span class="cstat-no" title="statement not covered"><br/></span><span></span></code></div>
<div class="source-line"><span class="line-number ">2050</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  return rval;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2051</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">}</span><span>;</span></code></div>
<div class="source-line"><span class="line-number ">2052</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<div class="source-line"><span class="line-number ">2053</span><span class="line-counter cline-yes">&nbsp</span><code>/**</code></div>
<div class="source-line"><span class="line-number ">2054</span><span class="line-counter cline-yes">&nbsp</span><code> * Stores an item in local storage.</code></div>
<div class="source-line"><span class="line-number ">2055</span><span class="line-counter cline-yes">&nbsp</span><code> *</code></div>
<div class="source-line"><span class="line-number ">2056</span><span class="line-counter cline-yes">&nbsp</span><code> * @param api the storage interface.</code></div>
<div class="source-line"><span class="line-number ">2057</span><span class="line-counter cline-yes">&nbsp</span><code> * @param id the storage ID to use.</code></div>
<div class="source-line"><span class="line-number ">2058</span><span class="line-counter cline-yes">&nbsp</span><code> * @param key the key for the item.</code></div>
<div class="source-line"><span class="line-number ">2059</span><span class="line-counter cline-yes">&nbsp</span><code> * @param data the data for the item (any javascript object/primitive).</code></div>
<div class="source-line"><span class="line-number ">2060</span><span class="line-counter cline-yes">&nbsp</span><code> */</code></div>
<div class="source-line"><span class="line-number ">2061</span><span class="line-counter cline-no">！</span><code><span>var _setItem = </span><span class="cstat-no" title="statement not covered">function(api, id, key, data) {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2062</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  // get storage object</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2063</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  var obj = _getStorageObject(api, id);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2064</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  if(obj === null) {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2065</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    // create a new storage object</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2066</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    obj = {};</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2067</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  }</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2068</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  // update key</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2069</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  obj[key] = data;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2070</span><span class="line-counter cline-no">！</span><code><span class="cstat-no" title="statement not covered"><br/></span><span></span></code></div>
<div class="source-line"><span class="line-number ">2071</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  // set storage object</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2072</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  _setStorageObject(api, id, obj);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2073</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">}</span><span>;</span></code></div>
<div class="source-line"><span class="line-number ">2074</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<div class="source-line"><span class="line-number ">2075</span><span class="line-counter cline-yes">&nbsp</span><code>/**</code></div>
<div class="source-line"><span class="line-number ">2076</span><span class="line-counter cline-yes">&nbsp</span><code> * Gets an item from local storage.</code></div>
<div class="source-line"><span class="line-number ">2077</span><span class="line-counter cline-yes">&nbsp</span><code> *</code></div>
<div class="source-line"><span class="line-number ">2078</span><span class="line-counter cline-yes">&nbsp</span><code> * @param api the storage interface.</code></div>
<div class="source-line"><span class="line-number ">2079</span><span class="line-counter cline-yes">&nbsp</span><code> * @param id the storage ID to use.</code></div>
<div class="source-line"><span class="line-number ">2080</span><span class="line-counter cline-yes">&nbsp</span><code> * @param key the key for the item.</code></div>
<div class="source-line"><span class="line-number ">2081</span><span class="line-counter cline-yes">&nbsp</span><code> *</code></div>
<div class="source-line"><span class="line-number ">2082</span><span class="line-counter cline-yes">&nbsp</span><code> * @return the item.</code></div>
<div class="source-line"><span class="line-number ">2083</span><span class="line-counter cline-yes">&nbsp</span><code> */</code></div>
<div class="source-line"><span class="line-number ">2084</span><span class="line-counter cline-no">！</span><code><span>var _getItem = </span><span class="cstat-no" title="statement not covered">function(api, id, key) {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2085</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  // get storage object</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2086</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  var rval = _getStorageObject(api, id);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2087</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  if(rval !== null) {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2088</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    // return data at key</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2089</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    rval = (key in rval) ? rval[key] : null;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2090</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  }</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2091</span><span class="line-counter cline-no">！</span><code><span class="cstat-no" title="statement not covered"><br/></span><span></span></code></div>
<div class="source-line"><span class="line-number ">2092</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  return rval;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2093</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">}</span><span>;</span></code></div>
<div class="source-line"><span class="line-number ">2094</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<div class="source-line"><span class="line-number ">2095</span><span class="line-counter cline-yes">&nbsp</span><code>/**</code></div>
<div class="source-line"><span class="line-number ">2096</span><span class="line-counter cline-yes">&nbsp</span><code> * Removes an item from local storage.</code></div>
<div class="source-line"><span class="line-number ">2097</span><span class="line-counter cline-yes">&nbsp</span><code> *</code></div>
<div class="source-line"><span class="line-number ">2098</span><span class="line-counter cline-yes">&nbsp</span><code> * @param api the storage interface.</code></div>
<div class="source-line"><span class="line-number ">2099</span><span class="line-counter cline-yes">&nbsp</span><code> * @param id the storage ID to use.</code></div>
<div class="source-line"><span class="line-number ">2100</span><span class="line-counter cline-yes">&nbsp</span><code> * @param key the key for the item.</code></div>
<div class="source-line"><span class="line-number ">2101</span><span class="line-counter cline-yes">&nbsp</span><code> */</code></div>
<div class="source-line"><span class="line-number ">2102</span><span class="line-counter cline-no">！</span><code><span>var _removeItem = </span><span class="cstat-no" title="statement not covered">function(api, id, key) {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2103</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  // get storage object</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2104</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  var obj = _getStorageObject(api, id);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2105</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  if(obj !== null &amp;&amp; key in obj) {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2106</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    // remove key</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2107</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    delete obj[key];</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2108</span><span class="line-counter cline-no">！</span><code><span class="cstat-no" title="statement not covered"><br/></span><span></span></code></div>
<div class="source-line"><span class="line-number ">2109</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    // see if entry has no keys remaining</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2110</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    var empty = true;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2111</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    for(var prop in obj) {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2112</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">      empty = false;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2113</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">      break;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2114</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    }</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2115</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    if(empty) {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2116</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">      // remove entry entirely if no keys are left</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2117</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">      obj = null;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2118</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    }</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2119</span><span class="line-counter cline-no">！</span><code><span class="cstat-no" title="statement not covered"><br/></span><span></span></code></div>
<div class="source-line"><span class="line-number ">2120</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    // set storage object</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2121</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    _setStorageObject(api, id, obj);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2122</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  }</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2123</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">}</span><span>;</span></code></div>
<div class="source-line"><span class="line-number ">2124</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<div class="source-line"><span class="line-number ">2125</span><span class="line-counter cline-yes">&nbsp</span><code>/**</code></div>
<div class="source-line"><span class="line-number ">2126</span><span class="line-counter cline-yes">&nbsp</span><code> * Clears the local disk storage identified by the given ID.</code></div>
<div class="source-line"><span class="line-number ">2127</span><span class="line-counter cline-yes">&nbsp</span><code> *</code></div>
<div class="source-line"><span class="line-number ">2128</span><span class="line-counter cline-yes">&nbsp</span><code> * @param api the storage interface.</code></div>
<div class="source-line"><span class="line-number ">2129</span><span class="line-counter cline-yes">&nbsp</span><code> * @param id the storage ID to use.</code></div>
<div class="source-line"><span class="line-number ">2130</span><span class="line-counter cline-yes">&nbsp</span><code> */</code></div>
<div class="source-line"><span class="line-number ">2131</span><span class="line-counter cline-no">！</span><code><span>var _clearItems = </span><span class="cstat-no" title="statement not covered">function(api, id) {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2132</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  _setStorageObject(api, id, null);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2133</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">}</span><span>;</span></code></div>
<div class="source-line"><span class="line-number ">2134</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<div class="source-line"><span class="line-number ">2135</span><span class="line-counter cline-yes">&nbsp</span><code>/**</code></div>
<div class="source-line"><span class="line-number ">2136</span><span class="line-counter cline-yes">&nbsp</span><code> * Calls a storage function.</code></div>
<div class="source-line"><span class="line-number ">2137</span><span class="line-counter cline-yes">&nbsp</span><code> *</code></div>
<div class="source-line"><span class="line-number ">2138</span><span class="line-counter cline-yes">&nbsp</span><code> * @param func the function to call.</code></div>
<div class="source-line"><span class="line-number ">2139</span><span class="line-counter cline-yes">&nbsp</span><code> * @param args the arguments for the function.</code></div>
<div class="source-line"><span class="line-number ">2140</span><span class="line-counter cline-yes">&nbsp</span><code> * @param location the location argument.</code></div>
<div class="source-line"><span class="line-number ">2141</span><span class="line-counter cline-yes">&nbsp</span><code> *</code></div>
<div class="source-line"><span class="line-number ">2142</span><span class="line-counter cline-yes">&nbsp</span><code> * @return the return value from the function.</code></div>
<div class="source-line"><span class="line-number ">2143</span><span class="line-counter cline-yes">&nbsp</span><code> */</code></div>
<div class="source-line"><span class="line-number ">2144</span><span class="line-counter cline-no">！</span><code><span>var _callStorageFunction = </span><span class="cstat-no" title="statement not covered">function(func, args, location) {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2145</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  var rval = null;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2146</span><span class="line-counter cline-no">！</span><code><span class="cstat-no" title="statement not covered"><br/></span><span></span></code></div>
<div class="source-line"><span class="line-number ">2147</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  // default storage types</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2148</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  if(typeof(location) === &#39;undefined&#39;) {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2149</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    location = [&#39;web&#39;, &#39;flash&#39;];</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2150</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  }</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2151</span><span class="line-counter cline-no">！</span><code><span class="cstat-no" title="statement not covered"><br/></span><span></span></code></div>
<div class="source-line"><span class="line-number ">2152</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  // apply storage types in order of preference</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2153</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  var type;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2154</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  var done = false;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2155</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  var exception = null;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2156</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  for(var idx in location) {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2157</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    type = location[idx];</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2158</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    try {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2159</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">      if(type === &#39;flash&#39; || type === &#39;both&#39;) {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2160</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">        if(args[0] === null) {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2161</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">          throw new Error(&#39;Flash local storage not available.&#39;);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2162</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">        }</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2163</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">        rval = func.apply(this, args);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2164</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">        done = (type === &#39;flash&#39;);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2165</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">      }</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2166</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">      if(type === &#39;web&#39; || type === &#39;both&#39;) {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2167</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">        args[0] = localStorage;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2168</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">        rval = func.apply(this, args);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2169</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">        done = true;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2170</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">      }</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2171</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    } catch(ex) {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2172</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">      exception = ex;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2173</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    }</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2174</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    if(done) {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2175</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">      break;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2176</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    }</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2177</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  }</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2178</span><span class="line-counter cline-no">！</span><code><span class="cstat-no" title="statement not covered"><br/></span><span></span></code></div>
<div class="source-line"><span class="line-number ">2179</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  if(!done) {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2180</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    throw exception;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2181</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  }</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2182</span><span class="line-counter cline-no">！</span><code><span class="cstat-no" title="statement not covered"><br/></span><span></span></code></div>
<div class="source-line"><span class="line-number ">2183</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  return rval;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2184</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">}</span><span>;</span></code></div>
<div class="source-line"><span class="line-number ">2185</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<div class="source-line"><span class="line-number ">2186</span><span class="line-counter cline-yes">&nbsp</span><code>/**</code></div>
<div class="source-line"><span class="line-number ">2187</span><span class="line-counter cline-yes">&nbsp</span><code> * Stores an item on local disk.</code></div>
<div class="source-line"><span class="line-number ">2188</span><span class="line-counter cline-yes">&nbsp</span><code> *</code></div>
<div class="source-line"><span class="line-number ">2189</span><span class="line-counter cline-yes">&nbsp</span><code> * The available types of local storage include &#39;flash&#39;, &#39;web&#39;, and &#39;both&#39;.</code></div>
<div class="source-line"><span class="line-number ">2190</span><span class="line-counter cline-yes">&nbsp</span><code> *</code></div>
<div class="source-line"><span class="line-number ">2191</span><span class="line-counter cline-yes">&nbsp</span><code> * The type &#39;flash&#39; refers to flash local storage (SharedObject). In order</code></div>
<div class="source-line"><span class="line-number ">2192</span><span class="line-counter cline-yes">&nbsp</span><code> * to use flash local storage, the &#39;api&#39; parameter must be valid. The type</code></div>
<div class="source-line"><span class="line-number ">2193</span><span class="line-counter cline-yes">&nbsp</span><code> * &#39;web&#39; refers to WebStorage, if supported by the browser. The type &#39;both&#39;</code></div>
<div class="source-line"><span class="line-number ">2194</span><span class="line-counter cline-yes">&nbsp</span><code> * refers to storing using both &#39;flash&#39; and &#39;web&#39;, not just one or the</code></div>
<div class="source-line"><span class="line-number ">2195</span><span class="line-counter cline-yes">&nbsp</span><code> * other.</code></div>
<div class="source-line"><span class="line-number ">2196</span><span class="line-counter cline-yes">&nbsp</span><code> *</code></div>
<div class="source-line"><span class="line-number ">2197</span><span class="line-counter cline-yes">&nbsp</span><code> * The location array should list the storage types to use in order of</code></div>
<div class="source-line"><span class="line-number ">2198</span><span class="line-counter cline-yes">&nbsp</span><code> * preference:</code></div>
<div class="source-line"><span class="line-number ">2199</span><span class="line-counter cline-yes">&nbsp</span><code> *</code></div>
<div class="source-line"><span class="line-number ">2200</span><span class="line-counter cline-yes">&nbsp</span><code> * [&#39;flash&#39;]: flash only storage</code></div>
<div class="source-line"><span class="line-number ">2201</span><span class="line-counter cline-yes">&nbsp</span><code> * [&#39;web&#39;]: web only storage</code></div>
<div class="source-line"><span class="line-number ">2202</span><span class="line-counter cline-yes">&nbsp</span><code> * [&#39;both&#39;]: try to store in both</code></div>
<div class="source-line"><span class="line-number ">2203</span><span class="line-counter cline-yes">&nbsp</span><code> * [&#39;flash&#39;,&#39;web&#39;]: store in flash first, but if not available, &#39;web&#39;</code></div>
<div class="source-line"><span class="line-number ">2204</span><span class="line-counter cline-yes">&nbsp</span><code> * [&#39;web&#39;,&#39;flash&#39;]: store in web first, but if not available, &#39;flash&#39;</code></div>
<div class="source-line"><span class="line-number ">2205</span><span class="line-counter cline-yes">&nbsp</span><code> *</code></div>
<div class="source-line"><span class="line-number ">2206</span><span class="line-counter cline-yes">&nbsp</span><code> * The location array defaults to: [&#39;web&#39;, &#39;flash&#39;]</code></div>
<div class="source-line"><span class="line-number ">2207</span><span class="line-counter cline-yes">&nbsp</span><code> *</code></div>
<div class="source-line"><span class="line-number ">2208</span><span class="line-counter cline-yes">&nbsp</span><code> * @param api the flash interface, null to use only WebStorage.</code></div>
<div class="source-line"><span class="line-number ">2209</span><span class="line-counter cline-yes">&nbsp</span><code> * @param id the storage ID to use.</code></div>
<div class="source-line"><span class="line-number ">2210</span><span class="line-counter cline-yes">&nbsp</span><code> * @param key the key for the item.</code></div>
<div class="source-line"><span class="line-number ">2211</span><span class="line-counter cline-yes">&nbsp</span><code> * @param data the data for the item (any javascript object/primitive).</code></div>
<div class="source-line"><span class="line-number ">2212</span><span class="line-counter cline-yes">&nbsp</span><code> * @param location an array with the preferred types of storage to use.</code></div>
<div class="source-line"><span class="line-number ">2213</span><span class="line-counter cline-yes">&nbsp</span><code> */</code></div>
<div class="source-line"><span class="line-number ">2214</span><span class="line-counter cline-no">！</span><code><span>util.setItem = </span><span class="cstat-no" title="statement not covered">function(api, id, key, data, location) {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2215</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  _callStorageFunction(_setItem, arguments, location);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2216</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">}</span><span>;</span></code></div>
<div class="source-line"><span class="line-number ">2217</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<div class="source-line"><span class="line-number ">2218</span><span class="line-counter cline-yes">&nbsp</span><code>/**</code></div>
<div class="source-line"><span class="line-number ">2219</span><span class="line-counter cline-yes">&nbsp</span><code> * Gets an item on local disk.</code></div>
<div class="source-line"><span class="line-number ">2220</span><span class="line-counter cline-yes">&nbsp</span><code> *</code></div>
<div class="source-line"><span class="line-number ">2221</span><span class="line-counter cline-yes">&nbsp</span><code> * Set setItem() for details on storage types.</code></div>
<div class="source-line"><span class="line-number ">2222</span><span class="line-counter cline-yes">&nbsp</span><code> *</code></div>
<div class="source-line"><span class="line-number ">2223</span><span class="line-counter cline-yes">&nbsp</span><code> * @param api the flash interface, null to use only WebStorage.</code></div>
<div class="source-line"><span class="line-number ">2224</span><span class="line-counter cline-yes">&nbsp</span><code> * @param id the storage ID to use.</code></div>
<div class="source-line"><span class="line-number ">2225</span><span class="line-counter cline-yes">&nbsp</span><code> * @param key the key for the item.</code></div>
<div class="source-line"><span class="line-number ">2226</span><span class="line-counter cline-yes">&nbsp</span><code> * @param location an array with the preferred types of storage to use.</code></div>
<div class="source-line"><span class="line-number ">2227</span><span class="line-counter cline-yes">&nbsp</span><code> *</code></div>
<div class="source-line"><span class="line-number ">2228</span><span class="line-counter cline-yes">&nbsp</span><code> * @return the item.</code></div>
<div class="source-line"><span class="line-number ">2229</span><span class="line-counter cline-yes">&nbsp</span><code> */</code></div>
<div class="source-line"><span class="line-number ">2230</span><span class="line-counter cline-no">！</span><code><span>util.getItem = </span><span class="cstat-no" title="statement not covered">function(api, id, key, location) {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2231</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  return _callStorageFunction(_getItem, arguments, location);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2232</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">}</span><span>;</span></code></div>
<div class="source-line"><span class="line-number ">2233</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<div class="source-line"><span class="line-number ">2234</span><span class="line-counter cline-yes">&nbsp</span><code>/**</code></div>
<div class="source-line"><span class="line-number ">2235</span><span class="line-counter cline-yes">&nbsp</span><code> * Removes an item on local disk.</code></div>
<div class="source-line"><span class="line-number ">2236</span><span class="line-counter cline-yes">&nbsp</span><code> *</code></div>
<div class="source-line"><span class="line-number ">2237</span><span class="line-counter cline-yes">&nbsp</span><code> * Set setItem() for details on storage types.</code></div>
<div class="source-line"><span class="line-number ">2238</span><span class="line-counter cline-yes">&nbsp</span><code> *</code></div>
<div class="source-line"><span class="line-number ">2239</span><span class="line-counter cline-yes">&nbsp</span><code> * @param api the flash interface.</code></div>
<div class="source-line"><span class="line-number ">2240</span><span class="line-counter cline-yes">&nbsp</span><code> * @param id the storage ID to use.</code></div>
<div class="source-line"><span class="line-number ">2241</span><span class="line-counter cline-yes">&nbsp</span><code> * @param key the key for the item.</code></div>
<div class="source-line"><span class="line-number ">2242</span><span class="line-counter cline-yes">&nbsp</span><code> * @param location an array with the preferred types of storage to use.</code></div>
<div class="source-line"><span class="line-number ">2243</span><span class="line-counter cline-yes">&nbsp</span><code> */</code></div>
<div class="source-line"><span class="line-number ">2244</span><span class="line-counter cline-no">！</span><code><span>util.removeItem = </span><span class="cstat-no" title="statement not covered">function(api, id, key, location) {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2245</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  _callStorageFunction(_removeItem, arguments, location);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2246</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">}</span><span>;</span></code></div>
<div class="source-line"><span class="line-number ">2247</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<div class="source-line"><span class="line-number ">2248</span><span class="line-counter cline-yes">&nbsp</span><code>/**</code></div>
<div class="source-line"><span class="line-number ">2249</span><span class="line-counter cline-yes">&nbsp</span><code> * Clears the local disk storage identified by the given ID.</code></div>
<div class="source-line"><span class="line-number ">2250</span><span class="line-counter cline-yes">&nbsp</span><code> *</code></div>
<div class="source-line"><span class="line-number ">2251</span><span class="line-counter cline-yes">&nbsp</span><code> * Set setItem() for details on storage types.</code></div>
<div class="source-line"><span class="line-number ">2252</span><span class="line-counter cline-yes">&nbsp</span><code> *</code></div>
<div class="source-line"><span class="line-number ">2253</span><span class="line-counter cline-yes">&nbsp</span><code> * @param api the flash interface if flash is available.</code></div>
<div class="source-line"><span class="line-number ">2254</span><span class="line-counter cline-yes">&nbsp</span><code> * @param id the storage ID to use.</code></div>
<div class="source-line"><span class="line-number ">2255</span><span class="line-counter cline-yes">&nbsp</span><code> * @param location an array with the preferred types of storage to use.</code></div>
<div class="source-line"><span class="line-number ">2256</span><span class="line-counter cline-yes">&nbsp</span><code> */</code></div>
<div class="source-line"><span class="line-number ">2257</span><span class="line-counter cline-no">！</span><code><span>util.clearItems = </span><span class="cstat-no" title="statement not covered">function(api, id, location) {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2258</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  _callStorageFunction(_clearItems, arguments, location);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2259</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">}</span><span>;</span></code></div>
<div class="source-line"><span class="line-number ">2260</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<div class="source-line"><span class="line-number ">2261</span><span class="line-counter cline-yes">&nbsp</span><code>/**</code></div>
<div class="source-line"><span class="line-number ">2262</span><span class="line-counter cline-yes">&nbsp</span><code> * Check if an object is empty.</code></div>
<div class="source-line"><span class="line-number ">2263</span><span class="line-counter cline-yes">&nbsp</span><code> *</code></div>
<div class="source-line"><span class="line-number ">2264</span><span class="line-counter cline-yes">&nbsp</span><code> * Taken from:</code></div>
<div class="source-line"><span class="line-number ">2265</span><span class="line-counter cline-yes">&nbsp</span><code> * http://stackoverflow.com/questions/679915/how-do-i-test-for-an-empty-javascript-object-from-json/679937#679937</code></div>
<div class="source-line"><span class="line-number ">2266</span><span class="line-counter cline-yes">&nbsp</span><code> *</code></div>
<div class="source-line"><span class="line-number ">2267</span><span class="line-counter cline-yes">&nbsp</span><code> * @param object the object to check.</code></div>
<div class="source-line"><span class="line-number ">2268</span><span class="line-counter cline-yes">&nbsp</span><code> */</code></div>
<div class="source-line"><span class="line-number ">2269</span><span class="line-counter cline-no">！</span><code><span>util.isEmpty = </span><span class="cstat-no" title="statement not covered">function(obj) {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2270</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  for(var prop in obj) {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2271</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    if(obj.hasOwnProperty(prop)) {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2272</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">      return false;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2273</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    }</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2274</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  }</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2275</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  return true;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2276</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">}</span><span>;</span></code></div>
<div class="source-line"><span class="line-number ">2277</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<div class="source-line"><span class="line-number ">2278</span><span class="line-counter cline-yes">&nbsp</span><code>/**</code></div>
<div class="source-line"><span class="line-number ">2279</span><span class="line-counter cline-yes">&nbsp</span><code> * Format with simple printf-style interpolation.</code></div>
<div class="source-line"><span class="line-number ">2280</span><span class="line-counter cline-yes">&nbsp</span><code> *</code></div>
<div class="source-line"><span class="line-number ">2281</span><span class="line-counter cline-yes">&nbsp</span><code> * %%: literal &#39;%&#39;</code></div>
<div class="source-line"><span class="line-number ">2282</span><span class="line-counter cline-yes">&nbsp</span><code> * %s,%o: convert next argument into a string.</code></div>
<div class="source-line"><span class="line-number ">2283</span><span class="line-counter cline-yes">&nbsp</span><code> *</code></div>
<div class="source-line"><span class="line-number ">2284</span><span class="line-counter cline-yes">&nbsp</span><code> * @param format the string to format.</code></div>
<div class="source-line"><span class="line-number ">2285</span><span class="line-counter cline-yes">&nbsp</span><code> * @param ... arguments to interpolate into the format string.</code></div>
<div class="source-line"><span class="line-number ">2286</span><span class="line-counter cline-yes">&nbsp</span><code> */</code></div>
<div class="source-line"><span class="line-number ">2287</span><span class="line-counter cline-no">！</span><code><span>util.format = </span><span class="cstat-no" title="statement not covered">function(format) {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2288</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  var re = /%./g;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2289</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  // current match</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2290</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  var match;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2291</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  // current part</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2292</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  var part;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2293</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  // current arg index</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2294</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  var argi = 0;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2295</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  // collected parts to recombine later</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2296</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  var parts = [];</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2297</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  // last index found</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2298</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  var last = 0;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2299</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  // loop while matches remain</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2300</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  while((match = re.exec(format))) {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2301</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    part = format.substring(last, re.lastIndex - 2);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2302</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    // don&#39;t add empty strings (ie, parts between %s%s)</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2303</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    if(part.length &gt; 0) {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2304</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">      parts.push(part);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2305</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    }</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2306</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    last = re.lastIndex;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2307</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    // switch on % code</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2308</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    var code = match[0][1];</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2309</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    switch(code) {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2310</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    case &#39;s&#39;:</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2311</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    case &#39;o&#39;:</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2312</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">      // check if enough arguments were given</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2313</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">      if(argi &lt; arguments.length) {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2314</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">        parts.push(arguments[argi++ + 1]);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2315</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">      } else {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2316</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">        parts.push(&#39;&lt;?&gt;&#39;);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2317</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">      }</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2318</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">      break;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2319</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    // FIXME: do proper formating for numbers, etc</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2320</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    //case &#39;f&#39;:</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2321</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    //case &#39;d&#39;:</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2322</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    case &#39;%&#39;:</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2323</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">      parts.push(&#39;%&#39;);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2324</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">      break;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2325</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    default:</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2326</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">      parts.push(&#39;&lt;%&#39; + code + &#39;?&gt;&#39;);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2327</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    }</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2328</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  }</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2329</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  // add trailing part of format string</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2330</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  parts.push(format.substring(last));</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2331</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  return parts.join(&#39;&#39;);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2332</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">}</span><span>;</span></code></div>
<div class="source-line"><span class="line-number ">2333</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<div class="source-line"><span class="line-number ">2334</span><span class="line-counter cline-yes">&nbsp</span><code>/**</code></div>
<div class="source-line"><span class="line-number ">2335</span><span class="line-counter cline-yes">&nbsp</span><code> * Formats a number.</code></div>
<div class="source-line"><span class="line-number ">2336</span><span class="line-counter cline-yes">&nbsp</span><code> *</code></div>
<div class="source-line"><span class="line-number ">2337</span><span class="line-counter cline-yes">&nbsp</span><code> * http://snipplr.com/view/5945/javascript-numberformat--ported-from-php/</code></div>
<div class="source-line"><span class="line-number ">2338</span><span class="line-counter cline-yes">&nbsp</span><code> */</code></div>
<div class="source-line"><span class="line-number ">2339</span><span class="line-counter cline-no">！</span><code><span>util.formatNumber = </span><span class="cstat-no" title="statement not covered">function(number, decimals, dec_point, thousands_sep) {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2340</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  // http://kevin.vanzonneveld.net</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2341</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  // +   original by: Jonas Raoni Soares Silva (http://www.jsfromhell.com)</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2342</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  // +   improved by: Kevin van Zonneveld (http://kevin.vanzonneveld.net)</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2343</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  // +     bugfix by: Michael White (http://crestidg.com)</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2344</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  // +     bugfix by: Benjamin Lupton</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2345</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  // +     bugfix by: Allan Jensen (http://www.winternet.no)</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2346</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  // +    revised by: Jonas Raoni Soares Silva (http://www.jsfromhell.com)</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2347</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  // *     example 1: number_format(1234.5678, 2, &#39;.&#39;, &#39;&#39;);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2348</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  // *     returns 1: 1234.57</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2349</span><span class="line-counter cline-no">！</span><code><span class="cstat-no" title="statement not covered"><br/></span><span></span></code></div>
<div class="source-line"><span class="line-number ">2350</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  var n = number, c = isNaN(decimals = Math.abs(decimals)) ? 2 : decimals;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2351</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  var d = dec_point === undefined ? &#39;,&#39; : dec_point;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2352</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  var t = thousands_sep === undefined ?</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2353</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">   &#39;.&#39; : thousands_sep, s = n &lt; 0 ? &#39;-&#39; : &#39;&#39;;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2354</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  var i = parseInt((n = Math.abs(+n || 0).toFixed(c)), 10) + &#39;&#39;;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2355</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  var j = (i.length &gt; 3) ? i.length % 3 : 0;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2356</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  return s + (j ? i.substr(0, j) + t : &#39;&#39;) +</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2357</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    i.substr(j).replace(/(\d{3})(?=\d)/g, &#39;$1&#39; + t) +</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2358</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    (c ? d + Math.abs(n - i).toFixed(c).slice(2) : &#39;&#39;);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2359</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">}</span><span>;</span></code></div>
<div class="source-line"><span class="line-number ">2360</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<div class="source-line"><span class="line-number ">2361</span><span class="line-counter cline-yes">&nbsp</span><code>/**</code></div>
<div class="source-line"><span class="line-number ">2362</span><span class="line-counter cline-yes">&nbsp</span><code> * Formats a byte size.</code></div>
<div class="source-line"><span class="line-number ">2363</span><span class="line-counter cline-yes">&nbsp</span><code> *</code></div>
<div class="source-line"><span class="line-number ">2364</span><span class="line-counter cline-yes">&nbsp</span><code> * http://snipplr.com/view/5949/format-humanize-file-byte-size-presentation-in-javascript/</code></div>
<div class="source-line"><span class="line-number ">2365</span><span class="line-counter cline-yes">&nbsp</span><code> */</code></div>
<div class="source-line"><span class="line-number ">2366</span><span class="line-counter cline-no">！</span><code><span>util.formatSize = </span><span class="cstat-no" title="statement not covered">function(size) {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2367</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  if(size &gt;= 1073741824) {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2368</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    size = util.formatNumber(size / 1073741824, 2, &#39;.&#39;, &#39;&#39;) + &#39; GiB&#39;;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2369</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  } else if(size &gt;= 1048576) {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2370</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    size = util.formatNumber(size / 1048576, 2, &#39;.&#39;, &#39;&#39;) + &#39; MiB&#39;;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2371</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  } else if(size &gt;= 1024) {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2372</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    size = util.formatNumber(size / 1024, 0) + &#39; KiB&#39;;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2373</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  } else {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2374</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    size = util.formatNumber(size, 0) + &#39; bytes&#39;;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2375</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  }</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2376</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  return size;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2377</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">}</span><span>;</span></code></div>
<div class="source-line"><span class="line-number ">2378</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<div class="source-line"><span class="line-number ">2379</span><span class="line-counter cline-yes">&nbsp</span><code>/**</code></div>
<div class="source-line"><span class="line-number ">2380</span><span class="line-counter cline-yes">&nbsp</span><code> * Converts an IPv4 or IPv6 string representation into bytes (in network order).</code></div>
<div class="source-line"><span class="line-number ">2381</span><span class="line-counter cline-yes">&nbsp</span><code> *</code></div>
<div class="source-line"><span class="line-number ">2382</span><span class="line-counter cline-yes">&nbsp</span><code> * @param ip the IPv4 or IPv6 address to convert.</code></div>
<div class="source-line"><span class="line-number ">2383</span><span class="line-counter cline-yes">&nbsp</span><code> *</code></div>
<div class="source-line"><span class="line-number ">2384</span><span class="line-counter cline-yes">&nbsp</span><code> * @return the 4-byte IPv6 or 16-byte IPv6 address or null if the address can&#39;t</code></div>
<div class="source-line"><span class="line-number ">2385</span><span class="line-counter cline-yes">&nbsp</span><code> *         be parsed.</code></div>
<div class="source-line"><span class="line-number ">2386</span><span class="line-counter cline-yes">&nbsp</span><code> */</code></div>
<div class="source-line"><span class="line-number ">2387</span><span class="line-counter cline-no">！</span><code><span>util.bytesFromIP = </span><span class="cstat-no" title="statement not covered">function(ip) {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2388</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  if(ip.indexOf(&#39;.&#39;) !== -1) {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2389</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    return util.bytesFromIPv4(ip);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2390</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  }</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2391</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  if(ip.indexOf(&#39;:&#39;) !== -1) {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2392</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    return util.bytesFromIPv6(ip);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2393</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  }</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2394</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  return null;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2395</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">}</span><span>;</span></code></div>
<div class="source-line"><span class="line-number ">2396</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<div class="source-line"><span class="line-number ">2397</span><span class="line-counter cline-yes">&nbsp</span><code>/**</code></div>
<div class="source-line"><span class="line-number ">2398</span><span class="line-counter cline-yes">&nbsp</span><code> * Converts an IPv4 string representation into bytes (in network order).</code></div>
<div class="source-line"><span class="line-number ">2399</span><span class="line-counter cline-yes">&nbsp</span><code> *</code></div>
<div class="source-line"><span class="line-number ">2400</span><span class="line-counter cline-yes">&nbsp</span><code> * @param ip the IPv4 address to convert.</code></div>
<div class="source-line"><span class="line-number ">2401</span><span class="line-counter cline-yes">&nbsp</span><code> *</code></div>
<div class="source-line"><span class="line-number ">2402</span><span class="line-counter cline-yes">&nbsp</span><code> * @return the 4-byte address or null if the address can&#39;t be parsed.</code></div>
<div class="source-line"><span class="line-number ">2403</span><span class="line-counter cline-yes">&nbsp</span><code> */</code></div>
<div class="source-line"><span class="line-number ">2404</span><span class="line-counter cline-no">！</span><code><span>util.bytesFromIPv4 = </span><span class="cstat-no" title="statement not covered">function(ip) {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2405</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  ip = ip.split(&#39;.&#39;);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2406</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  if(ip.length !== 4) {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2407</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    return null;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2408</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  }</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2409</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  var b = util.createBuffer();</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2410</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  for(var i = 0; i &lt; ip.length; ++i) {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2411</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    var num = parseInt(ip[i], 10);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2412</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    if(isNaN(num)) {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2413</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">      return null;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2414</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    }</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2415</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    b.putByte(num);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2416</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  }</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2417</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  return b.getBytes();</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2418</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">}</span><span>;</span></code></div>
<div class="source-line"><span class="line-number ">2419</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<div class="source-line"><span class="line-number ">2420</span><span class="line-counter cline-yes">&nbsp</span><code>/**</code></div>
<div class="source-line"><span class="line-number ">2421</span><span class="line-counter cline-yes">&nbsp</span><code> * Converts an IPv6 string representation into bytes (in network order).</code></div>
<div class="source-line"><span class="line-number ">2422</span><span class="line-counter cline-yes">&nbsp</span><code> *</code></div>
<div class="source-line"><span class="line-number ">2423</span><span class="line-counter cline-yes">&nbsp</span><code> * @param ip the IPv6 address to convert.</code></div>
<div class="source-line"><span class="line-number ">2424</span><span class="line-counter cline-yes">&nbsp</span><code> *</code></div>
<div class="source-line"><span class="line-number ">2425</span><span class="line-counter cline-yes">&nbsp</span><code> * @return the 16-byte address or null if the address can&#39;t be parsed.</code></div>
<div class="source-line"><span class="line-number ">2426</span><span class="line-counter cline-yes">&nbsp</span><code> */</code></div>
<div class="source-line"><span class="line-number ">2427</span><span class="line-counter cline-no">！</span><code><span>util.bytesFromIPv6 = </span><span class="cstat-no" title="statement not covered">function(ip) {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2428</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  var blanks = 0;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2429</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  ip = ip.split(&#39;:&#39;).filter(function(e) {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2430</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    if(e.length === 0) ++blanks;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2431</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    return true;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2432</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  });</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2433</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  var zeros = (8 - ip.length + blanks) * 2;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2434</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  var b = util.createBuffer();</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2435</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  for(var i = 0; i &lt; 8; ++i) {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2436</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    if(!ip[i] || ip[i].length === 0) {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2437</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">      b.fillWithByte(0, zeros);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2438</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">      zeros = 0;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2439</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">      continue;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2440</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    }</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2441</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    var bytes = util.hexToBytes(ip[i]);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2442</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    if(bytes.length &lt; 2) {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2443</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">      b.putByte(0);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2444</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    }</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2445</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    b.putBytes(bytes);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2446</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  }</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2447</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  return b.getBytes();</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2448</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">}</span><span>;</span></code></div>
<div class="source-line"><span class="line-number ">2449</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<div class="source-line"><span class="line-number ">2450</span><span class="line-counter cline-yes">&nbsp</span><code>/**</code></div>
<div class="source-line"><span class="line-number ">2451</span><span class="line-counter cline-yes">&nbsp</span><code> * Converts 4-bytes into an IPv4 string representation or 16-bytes into</code></div>
<div class="source-line"><span class="line-number ">2452</span><span class="line-counter cline-yes">&nbsp</span><code> * an IPv6 string representation. The bytes must be in network order.</code></div>
<div class="source-line"><span class="line-number ">2453</span><span class="line-counter cline-yes">&nbsp</span><code> *</code></div>
<div class="source-line"><span class="line-number ">2454</span><span class="line-counter cline-yes">&nbsp</span><code> * @param bytes the bytes to convert.</code></div>
<div class="source-line"><span class="line-number ">2455</span><span class="line-counter cline-yes">&nbsp</span><code> *</code></div>
<div class="source-line"><span class="line-number ">2456</span><span class="line-counter cline-yes">&nbsp</span><code> * @return the IPv4 or IPv6 string representation if 4 or 16 bytes,</code></div>
<div class="source-line"><span class="line-number ">2457</span><span class="line-counter cline-yes">&nbsp</span><code> *         respectively, are given, otherwise null.</code></div>
<div class="source-line"><span class="line-number ">2458</span><span class="line-counter cline-yes">&nbsp</span><code> */</code></div>
<div class="source-line"><span class="line-number ">2459</span><span class="line-counter cline-no">！</span><code><span>util.bytesToIP = </span><span class="cstat-no" title="statement not covered">function(bytes) {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2460</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  if(bytes.length === 4) {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2461</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    return util.bytesToIPv4(bytes);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2462</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  }</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2463</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  if(bytes.length === 16) {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2464</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    return util.bytesToIPv6(bytes);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2465</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  }</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2466</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  return null;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2467</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">}</span><span>;</span></code></div>
<div class="source-line"><span class="line-number ">2468</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<div class="source-line"><span class="line-number ">2469</span><span class="line-counter cline-yes">&nbsp</span><code>/**</code></div>
<div class="source-line"><span class="line-number ">2470</span><span class="line-counter cline-yes">&nbsp</span><code> * Converts 4-bytes into an IPv4 string representation. The bytes must be</code></div>
<div class="source-line"><span class="line-number ">2471</span><span class="line-counter cline-yes">&nbsp</span><code> * in network order.</code></div>
<div class="source-line"><span class="line-number ">2472</span><span class="line-counter cline-yes">&nbsp</span><code> *</code></div>
<div class="source-line"><span class="line-number ">2473</span><span class="line-counter cline-yes">&nbsp</span><code> * @param bytes the bytes to convert.</code></div>
<div class="source-line"><span class="line-number ">2474</span><span class="line-counter cline-yes">&nbsp</span><code> *</code></div>
<div class="source-line"><span class="line-number ">2475</span><span class="line-counter cline-yes">&nbsp</span><code> * @return the IPv4 string representation or null for an invalid # of bytes.</code></div>
<div class="source-line"><span class="line-number ">2476</span><span class="line-counter cline-yes">&nbsp</span><code> */</code></div>
<div class="source-line"><span class="line-number ">2477</span><span class="line-counter cline-no">！</span><code><span>util.bytesToIPv4 = </span><span class="cstat-no" title="statement not covered">function(bytes) {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2478</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  if(bytes.length !== 4) {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2479</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    return null;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2480</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  }</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2481</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  var ip = [];</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2482</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  for(var i = 0; i &lt; bytes.length; ++i) {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2483</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    ip.push(bytes.charCodeAt(i));</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2484</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  }</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2485</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  return ip.join(&#39;.&#39;);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2486</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">}</span><span>;</span></code></div>
<div class="source-line"><span class="line-number ">2487</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<div class="source-line"><span class="line-number ">2488</span><span class="line-counter cline-yes">&nbsp</span><code>/**</code></div>
<div class="source-line"><span class="line-number ">2489</span><span class="line-counter cline-yes">&nbsp</span><code> * Converts 16-bytes into an IPv16 string representation. The bytes must be</code></div>
<div class="source-line"><span class="line-number ">2490</span><span class="line-counter cline-yes">&nbsp</span><code> * in network order.</code></div>
<div class="source-line"><span class="line-number ">2491</span><span class="line-counter cline-yes">&nbsp</span><code> *</code></div>
<div class="source-line"><span class="line-number ">2492</span><span class="line-counter cline-yes">&nbsp</span><code> * @param bytes the bytes to convert.</code></div>
<div class="source-line"><span class="line-number ">2493</span><span class="line-counter cline-yes">&nbsp</span><code> *</code></div>
<div class="source-line"><span class="line-number ">2494</span><span class="line-counter cline-yes">&nbsp</span><code> * @return the IPv16 string representation or null for an invalid # of bytes.</code></div>
<div class="source-line"><span class="line-number ">2495</span><span class="line-counter cline-yes">&nbsp</span><code> */</code></div>
<div class="source-line"><span class="line-number ">2496</span><span class="line-counter cline-no">！</span><code><span>util.bytesToIPv6 = </span><span class="cstat-no" title="statement not covered">function(bytes) {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2497</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  if(bytes.length !== 16) {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2498</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    return null;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2499</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  }</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2500</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  var ip = [];</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2501</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  var zeroGroups = [];</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2502</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  var zeroMaxGroup = 0;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2503</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  for(var i = 0; i &lt; bytes.length; i += 2) {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2504</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    var hex = util.bytesToHex(bytes[i] + bytes[i + 1]);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2505</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    // canonicalize zero representation</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2506</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    while(hex[0] === &#39;0&#39; &amp;&amp; hex !== &#39;0&#39;) {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2507</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">      hex = hex.substr(1);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2508</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    }</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2509</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    if(hex === &#39;0&#39;) {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2510</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">      var last = zeroGroups[zeroGroups.length - 1];</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2511</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">      var idx = ip.length;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2512</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">      if(!last || idx !== last.end + 1) {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2513</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">        zeroGroups.push({start: idx, end: idx});</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2514</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">      } else {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2515</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">        last.end = idx;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2516</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">        if((last.end - last.start) &gt;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2517</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">          (zeroGroups[zeroMaxGroup].end - zeroGroups[zeroMaxGroup].start)) {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2518</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">          zeroMaxGroup = zeroGroups.length - 1;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2519</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">        }</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2520</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">      }</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2521</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    }</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2522</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    ip.push(hex);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2523</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  }</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2524</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  if(zeroGroups.length &gt; 0) {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2525</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    var group = zeroGroups[zeroMaxGroup];</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2526</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    // only shorten group of length &gt; 0</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2527</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    if(group.end - group.start &gt; 0) {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2528</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">      ip.splice(group.start, group.end - group.start + 1, &#39;&#39;);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2529</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">      if(group.start === 0) {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2530</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">        ip.unshift(&#39;&#39;);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2531</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">      }</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2532</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">      if(group.end === 7) {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2533</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">        ip.push(&#39;&#39;);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2534</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">      }</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2535</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    }</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2536</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  }</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2537</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  return ip.join(&#39;:&#39;);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2538</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">}</span><span>;</span></code></div>
<div class="source-line"><span class="line-number ">2539</span><span class="line-counter cline-yes">&nbsp</span><code></code></div>
<div class="source-line"><span class="line-number ">2540</span><span class="line-counter cline-yes">&nbsp</span><code>/**</code></div>
<div class="source-line"><span class="line-number ">2541</span><span class="line-counter cline-yes">&nbsp</span><code> * Estimates the number of processes that can be run concurrently. If</code></div>
<div class="source-line"><span class="line-number ">2542</span><span class="line-counter cline-yes">&nbsp</span><code> * creating Web Workers, keep in mind that the main JavaScript process needs</code></div>
<div class="source-line"><span class="line-number ">2543</span><span class="line-counter cline-yes">&nbsp</span><code> * its own core.</code></div>
<div class="source-line"><span class="line-number ">2544</span><span class="line-counter cline-yes">&nbsp</span><code> *</code></div>
<div class="source-line"><span class="line-number ">2545</span><span class="line-counter cline-yes">&nbsp</span><code> * @param options the options to use:</code></div>
<div class="source-line"><span class="line-number ">2546</span><span class="line-counter cline-yes">&nbsp</span><code> *          update true to force an update (not use the cached value).</code></div>
<div class="source-line"><span class="line-number ">2547</span><span class="line-counter cline-yes">&nbsp</span><code> * @param callback(err, max) called once the operation completes.</code></div>
<div class="source-line"><span class="line-number ">2548</span><span class="line-counter cline-yes">&nbsp</span><code> */</code></div>
<div class="source-line"><span class="line-number ">2549</span><span class="line-counter cline-no">！</span><code><span>util.estimateCores = </span><span class="cstat-no" title="statement not covered">function(options, callback) {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2550</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  if(typeof options === &#39;function&#39;) {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2551</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    callback = options;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2552</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    options = {};</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2553</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  }</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2554</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  options = options || {};</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2555</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  if(&#39;cores&#39; in util &amp;&amp; !options.update) {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2556</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    return callback(null, util.cores);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2557</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  }</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2558</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  if(typeof navigator !== &#39;undefined&#39; &amp;&amp;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2559</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    &#39;hardwareConcurrency&#39; in navigator &amp;&amp;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2560</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    navigator.hardwareConcurrency &gt; 0) {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2561</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    util.cores = navigator.hardwareConcurrency;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2562</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    return callback(null, util.cores);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2563</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  }</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2564</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  if(typeof Worker === &#39;undefined&#39;) {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2565</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    // workers not available</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2566</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    util.cores = 1;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2567</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    return callback(null, util.cores);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2568</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  }</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2569</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  if(typeof Blob === &#39;undefined&#39;) {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2570</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    // can&#39;t estimate, default to 2</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2571</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    util.cores = 2;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2572</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    return callback(null, util.cores);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2573</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  }</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2574</span><span class="line-counter cline-no">！</span><code><span class="cstat-no" title="statement not covered"><br/></span><span></span></code></div>
<div class="source-line"><span class="line-number ">2575</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  // create worker concurrency estimation code as blob</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2576</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  var blobUrl = URL.createObjectURL(new Blob([&#39;(&#39;,</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2577</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    function() {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2578</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">      self.addEventListener(&#39;message&#39;, function(e) {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2579</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">        // run worker for 4 ms</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2580</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">        var st = Date.now();</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2581</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">        var et = st + 4;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2582</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">        while(Date.now() &lt; et);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2583</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">        self.postMessage({st: st, et: et});</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2584</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">      });</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2585</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    }.toString(),</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2586</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  &#39;)()&#39;], {type: &#39;application/javascript&#39;}));</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2587</span><span class="line-counter cline-no">！</span><code><span class="cstat-no" title="statement not covered"><br/></span><span></span></code></div>
<div class="source-line"><span class="line-number ">2588</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  // take 5 samples using 16 workers</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2589</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  sample([], 5, 16);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2590</span><span class="line-counter cline-no">！</span><code><span class="cstat-no" title="statement not covered"><br/></span><span></span></code></div>
<div class="source-line"><span class="line-number ">2591</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  function sample(max, samples, numWorkers) {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2592</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    if(samples === 0) {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2593</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">      // get overlap average</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2594</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">      var avg = Math.floor(max.reduce(function(avg, x) {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2595</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">        return avg + x;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2596</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">      }, 0) / max.length);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2597</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">      util.cores = Math.max(1, avg);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2598</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">      URL.revokeObjectURL(blobUrl);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2599</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">      return callback(null, util.cores);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2600</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    }</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2601</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    map(numWorkers, function(err, results) {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2602</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">      max.push(reduce(numWorkers, results));</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2603</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">      sample(max, samples - 1, numWorkers);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2604</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    });</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2605</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  }</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2606</span><span class="line-counter cline-no">！</span><code><span class="cstat-no" title="statement not covered"><br/></span><span></span></code></div>
<div class="source-line"><span class="line-number ">2607</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  function map(numWorkers, callback) {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2608</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    var workers = [];</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2609</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    var results = [];</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2610</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    for(var i = 0; i &lt; numWorkers; ++i) {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2611</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">      var worker = new Worker(blobUrl);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2612</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">      worker.addEventListener(&#39;message&#39;, function(e) {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2613</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">        results.push(e.data);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2614</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">        if(results.length === numWorkers) {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2615</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">          for(var i = 0; i &lt; numWorkers; ++i) {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2616</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">            workers[i].terminate();</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2617</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">          }</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2618</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">          callback(null, results);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2619</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">        }</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2620</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">      });</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2621</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">      workers.push(worker);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2622</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    }</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2623</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    for(var i = 0; i &lt; numWorkers; ++i) {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2624</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">      workers[i].postMessage(i);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2625</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    }</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2626</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  }</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2627</span><span class="line-counter cline-no">！</span><code><span class="cstat-no" title="statement not covered"><br/></span><span></span></code></div>
<div class="source-line"><span class="line-number ">2628</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  function reduce(numWorkers, results) {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2629</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    // find overlapping time windows</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2630</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    var overlaps = [];</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2631</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    for(var n = 0; n &lt; numWorkers; ++n) {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2632</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">      var r1 = results[n];</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2633</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">      var overlap = overlaps[n] = [];</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2634</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">      for(var i = 0; i &lt; numWorkers; ++i) {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2635</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">        if(n === i) {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2636</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">          continue;</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2637</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">        }</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2638</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">        var r2 = results[i];</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2639</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">        if((r1.st &gt; r2.st &amp;&amp; r1.st &lt; r2.et) ||</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2640</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">          (r2.st &gt; r1.st &amp;&amp; r2.st &lt; r1.et)) {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2641</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">          overlap.push(i);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2642</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">        }</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2643</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">      }</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2644</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    }</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2645</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    // get maximum overlaps ... don&#39;t include overlapping worker itself</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2646</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    // as the main JS process was also being scheduled during the work and</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2647</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    // would have to be subtracted from the estimate anyway</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2648</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    return overlaps.reduce(function(max, overlap) {</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2649</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">      return Math.max(max, overlap.length);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2650</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">    }, 0);</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2651</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">  }</span><span></span></code></div>
<div class="source-line"><span class="line-number ">2652</span><span class="line-counter cline-no">！</span><code><span></span><span class="cstat-no" title="statement not covered">}</span><span>;</span></code></div>

    </div>
    <script>

        const ISSUE_TYPE_CLASSES_OR_NAME = {
			'severity-critical': 'issue-critical',
			'severity-major': 'issue-major',
			'severity-minor': 'issue-minor',
			'issue-type-memory-access': 'issue-memory-access',
			'issue-type-branch': 'issue-branch',
		};
            ISSUE_TYPE_CLASSES_OR_NAME['target-RSASIGN'] = 'target-RSASIGN';
            ISSUE_TYPE_CLASSES_OR_NAME['target-DECODE'] = 'target-DECODE';
            ISSUE_TYPE_CLASSES_OR_NAME['target-ECB'] = 'target-ECB';
            ISSUE_TYPE_CLASSES_OR_NAME['target-RSASIGN'] = 'target-RSASIGN';

		const checkboxes = document.querySelectorAll('input[type="checkbox"]');
        const buttons = document.querySelectorAll('input[type="button"]');

		function change() {
            var elem = document.getElementById('button1');
            const fold = ' Fold leak details ';
            const deploy = ' Deploy leak details ';
            if (elem.innerHTML === deploy) {
                elem.innerHTML = fold;
            } else if (elem.innerHTML === fold) {
                elem.innerHTML = deploy;
            } else {
                console.log(elem.innerHTML);
            }

            const issueSummaries = document.querySelectorAll('details.issue-inline-message' + ' summary');
            const issueSummariesOpen = document.querySelectorAll('details.issue-inline-message[open]' + ' summary');
            const issueSummariesArray = Array.from(issueSummaries);
            const issueSummariesOpenArray = Array.from(issueSummariesOpen);

            if (elem.innerHTML === fold) {
                let issueSummariesClose = [];
                for (let i = 0; i < issueSummariesArray.length; i++) {
                    const issue = issueSummariesArray[i];
                    if (!(issueSummariesOpenArray.includes(issue))) {
                        issueSummariesClose.push(issue);
                    }
                }
                for (let k = 0; k < issueSummariesClose.length; k++) {
		            issueSummariesClose[k].click();
		            for (let i = 0; i < 5 ; i++) {
		                checkboxes[i].checked = true;
            	    }
            	}
            } else if (elem.innerHTML === deploy) {
                for (let k = 0; k < issueSummariesOpen.length; k++) {
	                issueSummariesOpenArray[k].click()
	                for (let i = 0; i < 5 ; i++) { // 5 first checkboxes are Severity and Issue type one, others are for target-name
		                checkboxes[i].checked = false;
            	   }
                }
            } else {
                console.log("error");
            }
        }

        change();

        var lastClick = ["0"];
		for (let i = 0; i < checkboxes.length; i++) {
		    checkboxes[i].addEventListener('change', () => {
// 		        console.log(ISSUE_TYPE_CLASSES_OR_NAME[checkboxes[i].name]);
		        const issueSelector = '.' + ISSUE_TYPE_CLASSES_OR_NAME[checkboxes[i].name];
		        const issueSummaries = document.querySelectorAll('details' + issueSelector + ' > summary');
		        for (let i = 0; i < issueSummaries.length; i++) {
			        issueSummaries[i].click();
			    }
	        });
	   }
       
    </script>
  </body>
</html>